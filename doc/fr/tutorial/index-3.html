<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<TITLE>Tutoriels Applications KDE: Construction des Tutoriels Qt</TITLE>
<META HTTP-EQUIV="content-type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="keywords" CONTENT="">
<META NAME="description" CONTENT="">
</HEAD>
<BODY BGCOLOR="#ffffff" LINK="#aa0000" TEXT="#000000" > 
<FONT FACE="Helvetica">
<A HREF="http://www.kde.org/"><IMG SRC="logotp3.png" BORDER="0" ALT="The K Desktop Environment"></A>
<HR WIDTH="100%" SIZE=2 ALIGN="CENTER" NOSHADE>

 
<P ALIGN="RIGHT">

<A HREF="index-4.html">Page suivante</A>
 <A HREF="index-2.html">Page précédente</A>
 <A HREF="index.html#toc3">Table des matières</A>
</P>
<H3><A NAME="s3">3. Construction des Tutoriels Qt</A></H3>

<P>
<H3><A NAME="ss3.1">3.1 Étape 1 : Hello World!</A>
</H3>

<P>Comme l'explique le chapitre précédent, nous avons créé un projet appelé <CODE>MyWidget</CODE>> - si nous regardons à la première page
du tutoriel de la documentation de Qt, nous voyons que la première application utilise uniquement la fonction  <CODE>main()</CODE>>.
Il nous suffit donc de modifier la fonction <CODE>main()</CODE>> de notre projet généré pour franchir la première étape du tutoriel.
<P>Pour accéder à la fonction <CODE>main()</CODE>>, sélectionnez-la dans le dossier "Globals" du visualiseur de classes qui contient un
sous-dossier "Fonctions" où sont listées les fonctions qui n'appartiennent pas à une classe. Cela ouvre le fichier
<CODE>main.cpp</CODE>> dans la fenêtre des "Fichiers C/C++" et le curseur d'édition est directement positionné au début
de la première ligne de <CODE>main()</CODE>.
<P>
<H4>Quoi modifier en premier</H4>

<P>Nous pourrions commencer par modifier le code donné pour obtenir ce qui est listé dans le tutoriel mais il y a encore plus simple.
Sélectionnez le contenu de la fonction <CODE>main()</CODE>> avec la souris ou en maintenant la touche Shift enfoncée pendant la sélection des
lignes avec la touche flèche vers le bas. Sélectionnez ensuite "Couper" dans le menu "Edition" ou appuyez sur la touche Suppr. pour
supprimer le code sélectionné. Cela effacera la fonction main et nous pourrons commencer à zéro la construction de notre tutoriel.
<P>
<H4>Saisie du code source</H4>

<P>Pour insérer le code du tutoriel, vous pourriez le lire attentivement et essayer de vous souvenir de chaque ligne de code qu'il contient.
Ensuite, après avoir lu ligne par ligne la description du tutoriel, vous pourriez l'utiliser comme exemple pour écrire le tutoriel 
vous-même.
<P>Pour ceux qui veulent se simplifier la vie : sélectionnez dans le navigateur le contenu de la fonction <CODE>main()</CODE>> listée et cliquez
sur l'icône "Copier" dans la barre d'outils. Autrement, vous pouvez utiliser le menu contextuel ou l'entrée appropriée dans le menu "Edit".
Cela copiera la sélection dans le presse-papiers et, après être revenu dans la fenêtre du code source, vous pourrez l'insérer avec "Coller"
(en utilisant le menu contextuel, l'icône de la barre d'outils ou l'entrée adéquate du menu "Edition").
<P>Enfin, ajoutez hors de la fonction <CODE>main()</CODE>> les fichiers d'en-tête suivants :
<P>
<BLOCKQUOTE><CODE>
<PRE>
#include &lt;qapplication.h>
#include &lt;qpushbutton.h>
</PRE>
</CODE></BLOCKQUOTE>
<P>C'est tout ! Le code source de votre première application de tutoriel est terminé.
<P>
<H4>Construction de Hello World!</H4>

<P>Pour construire le premier tutoriel, sélectionnez "Construire" dans le menu "Build" ou cliquez sur l'icône correspondante
dans la barre d'outils. Vous pourriez aussi bien choisir "Exécuter" qui provoque l'exécution après une construction correcte.
<P>Si la construction s'arrête à cause d'une erreur, vous pouvez être sûr que la faute vient du programmeur et non du tutoriel !
Ca serait dommage de chercher une erreur alors que vous avez décidé de programmer pour KDE et/ou Qt mais vous pouvez
utiliser cette occasion pour vous entraîner à utiliser KDevelop. Pour chercher une erreur, vous avez deux possibilités : soit
en sélectionnant le message d'erreur correspondant dans la fênetre des messages, ce qui vous placera sur la ligne où l'erreur
s'est produite, soit en appuyant sur la touche F4. Vous pourriez aussi utiliser l'entrée "Erreur suivante" du menu "Affichage".
<P>
<H4>Exercices</H4>

<P>Vous pourriez vous dire "Exercices ? C'était si simple que je n'ai pas besoin de m'exercer !" mais rassurez-vous, les choses vont
devenir plus compliquées. Ceci était l'exemple le plus simple qui soit mais plus ce sera compliqué et plus cela demandera de réflexions
de votre part pour assimiler et suivre les étapes du tutoriel.
<P>Les exercices vous permettront aussi d'apprendre comment utiliser KDevelop et ses fonctionnalités.
<P>Pour apprendre par vous-même plus de choses avec le premier tutoriel, vous pouvez essayer d'effectuer les modifications suivantes
dans le code et voir l'influence sur le comportement de l'application :
<P>
<OL>
<LI>changez le bouton (pushbutton) en QLabel</LI>
<LI>utilisez <CODE>setText()</CODE>> au lieu de définir directement le texte dans le constructeur du bouton (pushbutton)</LI>
<LI>utilisez <CODE>QPushButton::resize ( const QSize &amp; s )</CODE>> au lieu de définir directement la taille par sa largeur et sa hauteur. Créez
d'abord une instance de <CODE>QSize</CODE>> qui contiendra la taille</LI>
<LI>jouez avec les tailles pour voir laquelle est la largeur et laquelle est la hauteur</LI>
</OL>
<P>
<H3><A NAME="ss3.2">3.2 Étapes 2 et 3 : Extensions</A>
</H3>

<P>Les étapes 2 et 3 du tutoriel étendent les fonctionnalités du premier tutorial. Vous y découvrirez le mécanisme signal/slot ainsi
que les relations parent-enfant entre les widgets.
<P>À propos, pourquoi est-il important d'apprendre cela ? Eh bien, le mécanisme signal/slot est à la base de la technologie qui fait
la différence entre la bibliothèque Qt et les autres bibliothèques de widgets. Lorsque vous rencontrerez un problème d'implantation
où vous voulez communiquer entre objets, cela réduira considérablement vos efforts et rien de grave n'arrivera si quelque chose se
passe mal, même les mauvaises connexions ne conduisent pas à des fautes de segmentation (NdT : segmentation fault). C'est la force
de la bibliothèque Qt et beaucoup de développeurs KDE/Qt ne peuvent plus se passer de sa flexibilité. Comprendre le mécanisme
signal/slot est donc essentiel pour créer des applications KDE/Qt.
<P>Une autre chose à remarquer est le fait que le bouton termine l'instance de <CODE>QApplication</CODE>> en appelant <CODE>quit()</CODE>>. Vous
rencontrerez <CODE>quit()</CODE>> à nouveau en travaillant avec <CODE>KApplication</CODE>>, l'équivalent de <CODE>QApplication</CODE>> pour KDE.
<P>
<H3><A NAME="ss3.3">3.3 Écrire vos propres widgets</A>
</H3>

<P>Après avoir réussi à modifier et à étendre la fonction <CODE>main()</CODE>>, vous allez créer un nouveau widget - un widget particulier
qui peut seulement être construit avec la classe que vous allez écrire à l'étape 4. En fait, la classe a été créée pour vous par
l'assistant d'application donc il n'y a pas grand chose à ajouter - vous devez juste insérer le code que la leçon 4 place dans les
fichiers d'en-tête et d'implantation de la classe <CODE>MyWidget</CODE>> du fichier <CODE>main.cpp</CODE>>. Par chance, il suffit d'ajouter
l'implantation au code du constructeur.
<P>Pour accéder au constructeur, sélectionnez-le dans le visualiseur de classes. Vous serez automatiquement placé dans l'implantation
où vous pourrez ajouter le code.
<P>Ici, vous devez uniquement faire attention à l'inclusion de <CODE>qfont.h</CODE>> - <CODE>QFont</CODE>> est uniquement utilisé dans le code
du constructeur de <CODE>MyWidget</CODE>>. Ajoutez donc <CODE>#include> &lt;qfont.h&gt;</CODE> en haut du fichier <CODE>mywidget.cpp</CODE>>.
<P>Pour exécuter la nouvelle application, cliquez juste sur "Exécuter". Après un enregistrement automatique, toutes les modifications 
seront compilées.
<P>
<H3><A NAME="ss3.4">3.4 Étendre la classe Widget</A>
</H3>

<P>Dans la leçon 5, le but va maintenant être d'étendre la classe widget. Vous allez donc apprendre les fonctions virtuelles.
Ici, l'événement <CODE>resizeEvent()</CODE>> est réimplanté. Ce qu'il est important d'apprendre ici (au-delà de l'extension de classe),
c'est que Qt utilise des fonctions virtuelles ayant un événement en paramètre pour gérer les événements utilisateurs. Vous 
devriez donc vous familiariser avec les classes suivantes de la bibliothèque Qt :
<P>
<UL>
<LI>QEvent</LI>
<LI>QChildEvent</LI>
<LI>QCloseEvent</LI>
<LI>QFocusEvent</LI>
<LI>QKeyEvent</LI>
<LI>QMouseEvent</LI>
<LI>QMoveEvent</LI>
<LI>QPaintEvent</LI>
<LI>QResizeEvent</LI>
<LI>QTimerEvent</LI>
</UL>
<P>Lorsque vous voulez écrire des widgets personnalisés, spécialement les zones d'affichage des applications, vous devez surcharger
l'implantation par défaut des méthodes-événements du widget par les vôtres pour certains événements à traiter. Par exemple, cela peut être
<P><CODE>virtual> void mousePressEvent ( QMouseEvent * )</CODE> afin de traiter un événement de la souris pour afficher un menu contextuel. Dans
l'implantation, vous devrez insérer un paramètre formel dans l'en-tête de la fonction, la plupart des développeurs utilise
<CODE>event</CODE>> ou juste <CODE>e</CODE>> comme nom du paramètre.
<P>Ensuite, vous pouvez traiter les paramètres de l'événement. Pour un <CODE>QMouseEvent</CODE>>, vous devez demander si c'est le bouton gauche,
droit ou du milieu de la souris qui a provoqué cet événement.
<P>
<H3><A NAME="ss3.5">3.5 Ajouter une nouvelle Classe</A>
</H3>

<P>Avec la leçon 6, vous allez devoir ajouter une classe à l'application du tutoriel. Logiquement, vous devriez penser "Je vais juste
créer un fichier d'en-tête et un fichier d'implantation, et c'est tout" mais KDevelop va vous rendre cela encore plus simple. Pour
ajouter une classe, vous devriez toujours utiliser le Générateur de classes. Il fera tout le boulot pour vous et vous aurez uniquement
à rajouter le code spécifique.
<P>Pour ajouter une classe avec le Générateur de classes, choisissez "Projet" - "Nouvelle Classe" qui ouvrira une boîte de dialogue afin de
saisir toutes les valeurs nécessaires à la classe que vous voulez ajouter. La première chose à insérer est le nom de la classe. Le 
tutoriel la nomme <CODE>LCDRange</CODE>> donc ceci doit être inséré en premier. Ensuite, passons à la classe de base. La classe de base est celle
dont hérite la nouvelle classe. D'après le tutoriel (Qt 1.42), il s'agit de <CODE>QWidget</CODE>>. Maintenant, comme la plupart des
classes du GUI (Interface Graphique Utilisateur) à ajouter dérivent de QWidget, le Générateur de classes rend cela encore plus
simple. Laissez vide la classe de base et cochez plutôt "Classe fille de QWidget" dans la section "Options supplémentaires". Cela
ajoutera automatiquement dans le fichier d'en-tête la macro <CODE>Q_OBJECT</CODE>> qui est nécessaire pour ajouter des signal/slot (requis
pour le chapitre 7).
<P>Comme les noms de fichiers sont automatiquement insérés, vous n'avez pas à vous en préoccuper. La seule chose que nous vous
suggérons d'ajouter est la documentation. Il est toujours plus élégant d'ajouter une documentation descriptive à la classe, 
spécialement lorsque le nom de classe <CODE>LCDRange</CODE>> n'est pas très clair sur le but du widget.
<P>
<H3><A NAME="ss3.6">3.6 Étapes 7-14</A>
</H3>

<P>Pour les dernières étapes du tutoriel, vous êtes prêt et vous savez tout ce que vous avez à savoir - ajouter les classes nécessaires
et effectuer les modifications.
<P>Après chaque modification, vous devriez reconstruire l'application et vérifier que votre code ne contient pas d'erreur. Lancez la
et suivez son exécution ; vous pouvez aussi jouer avec les options de "Construction" de KDevelop, exécuter l'application avec une
ligne de commande contenant des arguments tels que --geometry et la déboguer avec KDbg dans la fenêtre des Outils. Ensuite, vous
devriez être capable de traiter les exemples de Qt qui seront présentés dans le chapitre suivant.
<P>
<P>
<P ALIGN="RIGHT">

<A HREF="index-4.html">Page suivante</A>
 <A HREF="index-2.html">Page précédente</A>
 <A HREF="index.html#toc3">Table des matières</A>
</P>
<CENTER>
<HR WIDTH="100%" SIZE=3 ALIGN=CENTER NOSHADE>
</CENTER>    
</FONT>

 
</BODY>
</HTML>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML
><HEAD
><TITLE
>User Notifications</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.54"/><LINK
REL="HOME"
TITLE="KDE 2.0 Development"
HREF="index.html"/><LINK
REL="UP"
TITLE="KDE Style Reference"
HREF="ch06.html"/><LINK
REL="PREVIOUS"
TITLE="Playing Sounds"
HREF="ch06lev1sec5.html"/><LINK
REL="NEXT"
TITLE="Executing Other Programs"
HREF="ch06lev1sec7.html"/><META
HTTP-EQUIV="Content-Style-Type"
CONTENT="text/css"/><LINK
REL="stylesheet"
HREF="kde-common.css"
TYPE="text/css"/><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=iso-8859-1"/><META
HTTP-EQUIV="Content-Language"
CONTENT="en"/><LINK
REL="stylesheet"
HREF="kde-localised.css"
TYPE="text/css"
TITLE="KDE-English"/><LINK
REL="stylesheet"
HREF="kde-default.css"
TYPE="text/css"
TITLE="KDE-Default"/></HEAD
><BODY
CLASS="section"
LINK="#336699"
VLINK="#336699"
ALINK="#336699"
BGCOLOR="#FFFFFF"
><DIV
ALIGN="RIGHT"
CLASS="NAVBAR"
><P
><A
HREF="ch06lev1sec5.html"
>Prev</A
> <A
HREF="ch06lev1sec7.html"
>Next</A
> <A
HREF="index.html"
>Table of Contents</A
></P
></DIV
><DIV
CLASS="section"
><TABLE
WIDTH="100%"
CELLPADDING="0"
CELLSPACING="0"
BORDER="0"
ALIGN="CENTER"
><TR
><TD
WIDTH="90%"
><H1
CLASS="section"
><A
NAME="ch06lev1sec6"
>6.6. User Notifications</A
></H1
><P
><TT
CLASS="literal"
>KNotifyClient</TT
> is the class for notifying the user when something special happened.</P
><P
>For example, if you are writing a KDE version of wget, the popular GNU utility to grab files off the Web, you would do this:</P
><DIV
CLASS="informalexample"
><HR/><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>   1&nbsp;
   2&nbsp;#include &lt;knotifyclient.h&gt;
   3&nbsp;[&#8230;]
   4&nbsp;KNotifyClient::event("done getting",i18n("The file is downloaded!"));
   5&nbsp;[&#8230;]
   6&nbsp;</PRE
></TD
></TR
></TABLE
><HR/></DIV
><P
>And with your program, you would install a file named eventsrc to $KDEDATADIR/APP/eventsrc ($KDEDIR/share/apps/APPNAME/eventsrc). Continuing with our example, you would use the following eventsrc:</P
><DIV
CLASS="informalexample"
><HR/><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>   1&nbsp;
   2&nbsp;[!Global!]
   3&nbsp;Name=kwget
   4&nbsp;Comment=KDE Web-Get
   5&nbsp;
   6&nbsp;[done getting]
   7&nbsp;Name=Download Completion
   8&nbsp;Name[fr]=Completion de Telechargement
   9&nbsp;Comment=Download of File is Complete
  10&nbsp;Comment=Telechargement de Lime est Complete
  11&nbsp;default_sound=downloaddone.wav
  12&nbsp;default_presentation=1
  13&nbsp;nopresentation=0
  14&nbsp;level=1
  15&nbsp;</PRE
></TD
></TR
></TABLE
><HR/></DIV
><P
>The <TT
CLASS="literal"
>presentation</TT
> and <TT
CLASS="literal"
>nopresentation</TT
> fields are produced by adding:</P
><DIV
CLASS="informalexample"
><HR/><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>   1&nbsp;
   2&nbsp;None=0, Sound=1, Messagebox=2, Logfile=4, Stderr=8
   3&nbsp;</PRE
></TD
></TR
></TABLE
><HR/></DIV
><P
><TT
CLASS="literal"
>nopresentation</TT
> was originally created to prevent an infinite recursion situation with KWin calling <TT
CLASS="literal"
>KNotify</TT
>, which opens a window, for which KWin calls <TT
CLASS="literal"
>KNotify</TT
>. You should have very little need for it.</P
><P
>And the level field is produced by adding:</P
><DIV
CLASS="informalexample"
><HR/><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>   1&nbsp;
   2&nbsp;None=0, Notification=1, Warning=2, Error=4, Catastrophe=8
   3&nbsp;</PRE
></TD
></TR
></TABLE
><HR/></DIV
><P
>Logfile uses the key <TT
CLASS="literal"
>default_file</TT
>, in the same format as <TT
CLASS="literal"
>default_sound</TT
>.</P
><P
>Several systemwide handlers also exist, all defined in your own $KDEDIR/share/config directory: <TT
CLASS="literal"
>cannotopenfile, notification, warning, fatalerror, and catastrophe</TT
>. A more complete list is availible in: KDEDIR/share/config/eventsrc</P
><P
>These can be called with</P
><DIV
CLASS="informalexample"
><HR/><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>   1&nbsp;
   2&nbsp;KNotifyClient::event("fatalerror", i18n("An internal error occurred,
   3&nbsp;opened files have been backed up, and this program will now quit");
   4&nbsp;</PRE
></TD
></TR
></TABLE
><HR/></DIV
></TD
><TD
WIDTH="10%"
VALIGN="BOTTOM"
ALIGN="CENTER"
><ANNMARK
NAME="ch06lev1sec6"/></TD
></TR
><ANNOTATION
NAME="ch06lev1sec6"
TITLE="User Notifications"/></TABLE
></DIV
><DIV
ALIGN="RIGHT"
CLASS="NAVBAR"
><P
><A
HREF="ch06lev1sec5.html"
>Prev</A
> <A
HREF="ch06lev1sec7.html"
>Next</A
> <A
HREF="index.html"
>Table of Contents</A
></P
></DIV
><HR
WIDTH="100%"
SIZE="2"
ALIGN="CENTER"
NOSHADE="NOSHADE"/></BODY
></HTML
>
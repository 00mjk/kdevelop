<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML
><HEAD
><TITLE
>Alternative Application Types</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.54"/><LINK
REL="HOME"
TITLE="KDE 2.0 Development"
HREF="index.html"/><LINK
REL="UP"
TITLE="Advanced KDE Widgets and UI Design Techniques"
HREF="p02.html"/><LINK
REL="PREVIOUS"
TITLE="Exercises"
HREF="ch10lev1sec6.html"/><LINK
REL="NEXT"
TITLE="Single-Instance Applications"
HREF="ch11lev1sec2.html"/><META
HTTP-EQUIV="Content-Style-Type"
CONTENT="text/css"/><LINK
REL="stylesheet"
HREF="kde-common.css"
TYPE="text/css"/><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=iso-8859-1"/><META
HTTP-EQUIV="Content-Language"
CONTENT="en"/><LINK
REL="stylesheet"
HREF="kde-localised.css"
TYPE="text/css"
TITLE="KDE-English"/><LINK
REL="stylesheet"
HREF="kde-default.css"
TYPE="text/css"
TITLE="KDE-Default"/></HEAD
><BODY
CLASS="chapter"
LINK="#336699"
VLINK="#336699"
ALINK="#336699"
BGCOLOR="#FFFFFF"
><DIV
ALIGN="RIGHT"
CLASS="NAVBAR"
><P
><A
HREF="ch10lev1sec6.html"
>Prev</A
> <A
HREF="ch11lev1sec2.html"
>Next</A
> <A
HREF="index.html"
>Table of Contents</A
></P
></DIV
><DIV
CLASS="chapter"
><H1
><A
NAME="ch11"
>Chapter 11. Alternative Application Types</A
></H1
><P
><I
CLASS="emphasis"
>by David Sweet</I
></P
><DIV
CLASS="highlights"
><A
NAME="AEN15770"
></A
><P
><B
>In this chapter</B
></P
><UL
COMPACT="COMPACT"
><LI
STYLE="list-style-type: disc"
><P
><I
CLASS="emphasis"
><A
HREF="ch11.html#ch11lev1sec1"
>Dialog-Based Applications</A
></I
></P
></LI
><LI
STYLE="list-style-type: disc"
><P
><I
CLASS="emphasis"
><A
HREF="ch11lev1sec2.html"
>Single-Instance Applications</A
></I
></P
></LI
><LI
STYLE="list-style-type: disc"
><P
><I
CLASS="emphasis"
><A
HREF="ch11lev1sec3.html"
>Panel Applets</A
></I
></P
></LI
></UL
></DIV
><P
>Not every application fits neatly into the document-centric model described in <A
HREF="ch02.html"
>Chapter 2, <SPAN
CLASS="QUOTE"
>"A Simple KDE Application"</SPAN
></A
>, and <A
HREF="ch05.html"
>Chapter 5, <SPAN
CLASS="QUOTE"
>"KDE User Interface Compliance."</SPAN
></A
> For example, short-lived, single-task applications (such as KPPP or KFind) use a dialog box for their main window. For some applications it only makes sense for one instance of an application to be running (for example, Kicker, KPPP). Still other applications, called applets, run in a small space on the panel and usually serve as status indicators or perform limited functions.</P
><DIV
CLASS="section"
><TABLE
WIDTH="100%"
CELLPADDING="0"
CELLSPACING="0"
BORDER="0"
ALIGN="CENTER"
><TR
><TD
WIDTH="90%"
><H1
CLASS="section"
><A
NAME="ch11lev1sec1"
>11.1. Dialog-Based Applications</A
></H1
><P
>Short-lived, single-task applications can be implemented in dialog boxes. Think of KFind, for example. This application searches for files on your local hard disk and then, typically, the user exits the application. A find operation is commonly included in a dialog box in document- centric applications, and so the appearance of a system-level find operation in a dialog box is not unfamiliar to the user.</P
><P
>Other utilities also use dialog boxes: KFontManager and KPPP. The motivation for writing KFontManager into a dialog is the same as that for KFind: It performs a common application function (usually implemented in a dialog box), but at the system level. KPPP is appropriately placed in a dialog box because the user interaction (in normal use) is limited. The user chooses only which connection to try and, when connected, wants to get back to work.</P
><DIV
CLASS="section"
><TABLE
WIDTH="100%"
CELLPADDING="0"
CELLSPACING="0"
BORDER="0"
ALIGN="CENTER"
><TR
><TD
WIDTH="90%"
><H2
CLASS="section"
><A
NAME="ch11lev2sec1"
>11.1.1. Creating the Dialog-Based Application</A
></H2
><P
>Creating a dialog-based application is different from creating a document-centric application, but not more difficult. No standard <TT
CLASS="literal"
>"KdialogApplication"</TT
> base class exists from which all such applications are derived (as <TT
CLASS="literal"
>KTMainWindow</TT
> analogously provides a common base for all document-centric applications), but there are generally fewer UI elements to worry about, and thus, such a base class is not necessary. In fact, in <A
HREF="ch11.html#ch11list01"
>Listings 11.1</A
> and <A
HREF="ch11.html#ch11list02"
>11.2</A
>, you see how to derive from <TT
CLASS="literal"
>KDialogBase</TT
> a base class dialog box and this serves you well.</P
><P
>Listings 11.1&#8211;11.3 show how to construct a dialog-based application.</P
><DIV
CLASS="example"
><HR/><A
NAME="ch11list01"
></A
><P
><B
>Example 11.1. kdialogapp.h: Class Declaration for <TT
CLASS="literal"
>KDialogApp</TT
>, a Dialog-Based Application</B
></P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>   1&nbsp;
   2&nbsp; 1: #ifndef __KDIALOG_H__
   3&nbsp; 2: #define __KDIALOG_H__
   4&nbsp; 3:
   5&nbsp; 4: #include &lt;kdialogbase.h&gt;
   6&nbsp; 5:
   7&nbsp; 6: class KDialogApp : public KDialogBase
   8&nbsp; 7: {
   9&nbsp; 8:  public:
  10&nbsp; 9:   KDialogApp (QWidget *parent = 0, const char *name = 0);
  11&nbsp;10:
  12&nbsp;11:  protected slots:
  13&nbsp;12:     /**
  14&nbsp;13:      * The Start button was pressed.
  15&nbsp;14:      **/
  16&nbsp;15:   void slotUser2(void);
  17&nbsp;16:     /**
  18&nbsp;17:      * The Quit button was pressed.
  19&nbsp;18:      **/
  20&nbsp;19:   void slotUser1(void);
  21&nbsp;20:
  22&nbsp;21: };
  23&nbsp;22:
  24&nbsp;23: #endif
  25&nbsp;</PRE
></TD
></TR
></TABLE
><HR/></DIV
><P
>It is necessary for the main application widget to be (ultimately) derived from <TT
CLASS="literal"
>QDialog</TT
> because <TT
CLASS="literal"
>QDialog</TT
> provides its own event loop for processing window system events. <TT
CLASS="literal"
>KDialogApp</TT
> is derived from <TT
CLASS="literal"
>KDialogBase</TT
> for simplicity, but <TT
CLASS="literal"
>KDialog</TT
> or <TT
CLASS="literal"
>QDialog</TT
> would work as well. <TT
CLASS="literal"
>KDialogBase</TT
> offers virtual methods that can be overloaded (here, <TT
CLASS="literal"
>slotUser1()</TT
>, line 19 and <TT
CLASS="literal"
>slotUser2()</TT
>, line 15) to provide responses to button clicks.</P
><DIV
CLASS="example"
><HR/><A
NAME="ch11list02"
></A
><P
><B
>Example 11.2. kdialogapp.cpp: Class Definition for <TT
CLASS="literal"
>KDialogApp</TT
></B
></P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>   1&nbsp;
   2&nbsp; 1: #include &lt;qlabel.h&gt;
   3&nbsp; 2:
   4&nbsp; 3: #include &lt;kapp.h&gt;
   5&nbsp; 4: #include &lt;kmessagebox.h&gt;
   6&nbsp; 5:
   7&nbsp; 6: #include "kdialogapp.h"
   8&nbsp; 7:
   9&nbsp; 8: KDialogApp::KDialogApp (QWidget *parent, const char *name) :
  10&nbsp; 9:   KDialogBase (parent, name, true, "kdialogapp", User1 | User2,
  11&nbsp;10:            User2, true, "&amp;Quit", "&amp;Start")
  12&nbsp;11: {
  13&nbsp;12:   QLabel *qlabel = new QLabel ("Content area.", this);
  14&nbsp;13:   setMainWidget (qlabel);
  15&nbsp;14: }
  16&nbsp;15:
  17&nbsp;16: void
  18&nbsp;17: KDialogApp::slotUser2(void)
  19&nbsp;18: {
  20&nbsp;19:   KMessageBox::sorry (this, "No functions implemented!");
  21&nbsp;20: }
  22&nbsp;21:
  23&nbsp;22: void
  24&nbsp;23: KDialogApp::slotUser1(void)
  25&nbsp;24: {
  26&nbsp;25:   close();
  27&nbsp;26: }
  28&nbsp;</PRE
></TD
></TR
></TABLE
><HR/></DIV
><P
><TT
CLASS="literal"
>KDialogBase</TT
>, as it is used here, creates a dialog box that displays a custom widget with two control buttons below it. The arguments&#8212;beyond the first two&#8212;passed to the <TT
CLASS="literal"
>KDialogBase</TT
> constructor (line 9) configure the dialog (see <A
HREF="ch08.html"
>Chapter 8, <SPAN
CLASS="QUOTE"
>"Using Dialog Boxes"</SPAN
></A
>, for more information about <TT
CLASS="literal"
>KDialogBase</TT
>). Arguments three through nine do the following:</P
><UL
COMPACT="COMPACT"
><LI
STYLE="list-style-type: disc"
><P
><TT
CLASS="literal"
>true</TT
>&#8212;Create a modal dialog. Passing <TT
CLASS="literal"
>true</TT
> lets you make use of <TT
CLASS="literal"
>QDialog</TT
>'s (from which <TT
CLASS="literal"
>KDialogBase</TT
> is derived) local event loop.</P
></LI
><LI
STYLE="list-style-type: disc"
><P
><TT
CLASS="literal"
>User1 [verbar] User2</TT
>&#8212;Create two user-defined buttons. The virtual methods <TT
CLASS="literal"
>slotUser1()</TT
> and <TT
CLASS="literal"
>slotUser2()</TT
> will be called when the buttons are clicked. The buttons are displayed right to left (see <A
HREF="ch11.html#ch11fig01"
>Figure 11.1</A
>).</P
></LI
><LI
STYLE="list-style-type: disc"
><P
><TT
CLASS="literal"
>User2</TT
>&#8212;Make the button <TT
CLASS="literal"
>User2</TT
> the default button. If the user presses Enter, the default button is clicked.</P
></LI
><LI
STYLE="list-style-type: disc"
><P
><TT
CLASS="literal"
>true</TT
>&#8212;Draw a horizontal line between the content area and the control buttons.</P
></LI
><LI
STYLE="list-style-type: disc"
><P
><TT
CLASS="literal"
>Quit</TT
>&#8212;The text for button <TT
CLASS="literal"
>User1</TT
>.</P
></LI
><LI
STYLE="list-style-type: disc"
><P
><TT
CLASS="literal"
>Start</TT
>&#8212;The text for button <TT
CLASS="literal"
>User2</TT
>.</P
></LI
></UL
><DIV
CLASS="figure"
><HR/><A
NAME="ch11fig01"
></A
><P
><B
>Figure 11.1. Screenshot of <TT
CLASS="literal"
>KDialogApp</TT
>.</B
></P
><DIV
CLASS="mediaobject"
><P
><IMG
SRC="graphics/11fig01.gif"
></IMG
></P
></DIV
><HR/></DIV
><P
>You place a label in the content area in lines 12 and 13. Note that the <TT
CLASS="literal"
>setMainWidget()</TT
> method is a member of <TT
CLASS="literal"
>KDialogBase</TT
>. You should place your dialog application's main widget in here.</P
><DIV
CLASS="example"
><HR/><A
NAME="ch11list03"
></A
><P
><B
>Example 11.3. main.cpp: The <TT
CLASS="literal"
>main()</TT
> Function Needed to Start <TT
CLASS="literal"
>KDialogApp</TT
></B
></P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>   1&nbsp;
   2&nbsp; 1: #include &lt;kapp.h&gt;
   3&nbsp; 2:
   4&nbsp; 3: #include "kdialogapp.h"
   5&nbsp; 4:
   6&nbsp; 5: void main (int argc, char *argv[])
   7&nbsp; 6: {
   8&nbsp; 7:   KApplication *kapplication = new KApplication (argc, argv, "kdialogapp");
   9&nbsp; 8:
  10&nbsp; 9:   KDialogApp * kdialogapp = new KDialogApp;
  11&nbsp;10:   kdialogapp-&gt;exec();
  12&nbsp;11: }
  13&nbsp;</PRE
></TD
></TR
></TABLE
><HR/></DIV
><P
>You need to create a <TT
CLASS="literal"
>KApplication</TT
> object to provide initialization of the Qt toolkit, but you do not need to make any calls to <TT
CLASS="literal"
>KApplication</TT
> methods. The event loop provided by <TT
CLASS="literal"
>QDialog</TT
> is started with</P
><DIV
CLASS="informalexample"
><HR/><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>   1&nbsp;
   2&nbsp;kdialogapp-&gt;exec();
   3&nbsp;</PRE
></TD
></TR
></TABLE
><HR/></DIV
><P
>The program exits after this call completes. <TT
CLASS="literal"
>kdialogapp-&gt;exec()</TT
> exits when the dialog is finished, which happens when the user closes the window, presses the Quit button, or presses Esc.</P
></TD
><TD
WIDTH="10%"
VALIGN="BOTTOM"
ALIGN="CENTER"
><ANNMARK
NAME="ch11lev2sec1"/></TD
></TR
><ANNOTATION
NAME="ch11lev2sec1"
TITLE="Creating the Dialog-Based Application"/></TABLE
></DIV
></TD
><TD
WIDTH="10%"
VALIGN="BOTTOM"
ALIGN="CENTER"
><ANNMARK
NAME="ch11lev1sec1"/></TD
></TR
><ANNOTATION
NAME="ch11lev1sec1"
TITLE="Dialog-Based Applications"/></TABLE
></DIV
></DIV
><DIV
ALIGN="RIGHT"
CLASS="NAVBAR"
><P
><A
HREF="ch10lev1sec6.html"
>Prev</A
> <A
HREF="ch11lev1sec2.html"
>Next</A
> <A
HREF="index.html"
>Table of Contents</A
></P
></DIV
><HR
WIDTH="100%"
SIZE="2"
ALIGN="CENTER"
NOSHADE="NOSHADE"/></BODY
></HTML
>
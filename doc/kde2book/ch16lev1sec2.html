<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML
><HEAD
><TITLE
>Administrative Files</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.54"/><LINK
REL="HOME"
TITLE="KDE 2.0 Development"
HREF="index.html"/><LINK
REL="UP"
TITLE="Packaging and Distributing Code"
HREF="ch16.html"/><LINK
REL="PREVIOUS"
TITLE="Packaging and Distributing Code"
HREF="ch16.html"/><LINK
REL="NEXT"
TITLE="Distributing Your Application"
HREF="ch16lev1sec3.html"/><META
HTTP-EQUIV="Content-Style-Type"
CONTENT="text/css"/><LINK
REL="stylesheet"
HREF="kde-common.css"
TYPE="text/css"/><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=iso-8859-1"/><META
HTTP-EQUIV="Content-Language"
CONTENT="en"/><LINK
REL="stylesheet"
HREF="kde-localised.css"
TYPE="text/css"
TITLE="KDE-English"/><LINK
REL="stylesheet"
HREF="kde-default.css"
TYPE="text/css"
TITLE="KDE-Default"/></HEAD
><BODY
CLASS="section"
LINK="#336699"
VLINK="#336699"
ALINK="#336699"
BGCOLOR="#FFFFFF"
><DIV
ALIGN="RIGHT"
CLASS="NAVBAR"
><P
><A
HREF="ch16.html"
>Prev</A
> <A
HREF="ch16lev1sec3.html"
>Next</A
> <A
HREF="index.html"
>Table of Contents</A
></P
></DIV
><DIV
CLASS="section"
><TABLE
WIDTH="100%"
CELLPADDING="0"
CELLSPACING="0"
BORDER="0"
ALIGN="CENTER"
><TR
><TD
WIDTH="90%"
><H1
CLASS="section"
><A
NAME="ch16lev1sec2"
>16.2. Administrative Files</A
></H1
><P
>Before you starting building a package for KSimpleApp, you should be familiar with some of the files used by the packaging system. <A
HREF="ch16lev1sec2.html#ch16table01"
>Table 16.1</A
> gives a summary of files and their purposes.</P
><DIV
CLASS="table"
><HR/><A
NAME="ch16table01"
></A
><P
><B
>Table 16.1. Administrative Files in a KDE Package</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><THEAD
><TR
><TH
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
><I
CLASS="emphasis"
>Filename</I
></TH
><TH
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
><I
CLASS="emphasis"
>Description</I
></TH
></TR
></THEAD
><TBODY
><TR
><TD
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
>configure</TD
><TD
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
>Configuration script used to configure the build environment.</TD
></TR
><TR
><TD
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
>configure.in</TD
><TD
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
>Source for the script configure. This is prepared by the maintainer (you!) and processed by Autoconf to create the script configure.</TD
></TR
><TR
><TD
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
>config.h</TD
><TD
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
>Holds the results of the tests run by the script configure. These results are specified by #define directives. You can include config.h in your source code to use these directives (thus, the results of the tests).</TD
></TR
><TR
><TD
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
>config.status</TD
><TD
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
>Script to remake the last successful build environment generated by the script configure.</TD
></TR
><TR
><TD
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
>config.cache</TD
><TD
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
>Stores results of tests run by the script configure so that the package can be reconfigured quickly (without rerunning previously successful tests).</TD
></TR
><TR
><TD
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
>config.log</TD
><TD
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
>Contains debugging output from the script configure. You can consult this file to figure out why a test has failed.</TD
></TR
></TBODY
></TABLE
><HR/></DIV
><DIV
CLASS="section"
><TABLE
WIDTH="100%"
CELLPADDING="0"
CELLSPACING="0"
BORDER="0"
ALIGN="CENTER"
><TR
><TD
WIDTH="90%"
><H2
CLASS="section"
><A
NAME="ch16lev2sec1"
>16.2.1. Configuring the Top-Level Directory</A
></H2
><P
>To convert the kexample package to a package for KSimpleApp, you first need to edit configure.in and Makefile.am.</P
><P
>The file configure.in contains several macros, each of which corresponds to a set of tests run by configure. Autoconf expands these macros when converting configure.in to the script configure. You need to modify two macros called <TT
CLASS="literal"
>AM_INIT_AUTOMAKE</TT
> and <TT
CLASS="literal"
>AC_OUTPUT</TT
>.</P
><P
>The first of these specifies the name and version number of the package. Call the package <TT
CLASS="literal"
>ksimpleapp</TT
> and give it version number 1.0 by changing the line</P
><DIV
CLASS="informalexample"
><HR/><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>   1&nbsp;
   2&nbsp;AM_INIT_AUTOMAKE(kexample, 2.0pre) dnl searches for some needed programs
   3&nbsp;</PRE
></TD
></TR
></TABLE
><HR/></DIV
><P
>to read</P
><DIV
CLASS="informalexample"
><HR/><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>   1&nbsp;
   2&nbsp;AM_INIT_AUTOMAKE(ksimpleapp, 1.0) dnl searches for some needed programs
   3&nbsp;</PRE
></TD
></TR
></TABLE
><HR/></DIV
><P
>Next, tell Autoconf which directories to compile source code in. In this example, only one directory exists, <TT
CLASS="literal"
>ksimpleapp</TT
>, so change the lines</P
><DIV
CLASS="informalexample"
><HR/><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>   1&nbsp;
   2&nbsp;AC_OUTPUT( \
   3&nbsp;       ./Makefile \
   4&nbsp;
   5&nbsp;       kless/Makefile \
   6&nbsp;       )
   7&nbsp;</PRE
></TD
></TR
></TABLE
><HR/></DIV
><P
>to read</P
><DIV
CLASS="informalexample"
><HR/><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>   1&nbsp;
   2&nbsp;AC_OUTPUT( \
   3&nbsp;         ./Makefile \
   4&nbsp;
   5&nbsp;         ksimpleapp/Makefile \
   6&nbsp;         )
   7&nbsp;</PRE
></TD
></TR
></TABLE
><HR/></DIV
><P
>You also need to edit Makefile.am. This file is processed by Automake into Makefile.in, which is processed, in turn, into Makefile by Autoconf. Thankfully, this is a mostly transparent process. You will generally need to modify only one line in Makefile.am and then not worry about the other two files. The line to modify is</P
><DIV
CLASS="informalexample"
><HR/><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>   1&nbsp;
   2&nbsp;SUBDIRS = kless
   3&nbsp;</PRE
></TD
></TR
></TABLE
><HR/></DIV
><P
>It should read</P
><DIV
CLASS="informalexample"
><HR/><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>   1&nbsp;
   2&nbsp;SUBDIRS = ksimpleapp
   3&nbsp;</PRE
></TD
></TR
></TABLE
><HR/></DIV
><P
>The top-level directory is now configured. The changes you have made will be propagated when you type <I
CLASS="emphasis"
><TT
CLASS="literal"
>make Makefile.dist</TT
></I
>, but don't do that yet! You need to make some changes to the subdirectory <TT
CLASS="literal"
>kless</TT
>. First off, change its name:</P
><DIV
CLASS="informalexample"
><HR/><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>   1&nbsp;
   2&nbsp;mv kless ksimpleapp
   3&nbsp;</PRE
></TD
></TR
></TABLE
><HR/></DIV
><P
>The subdirectory <TT
CLASS="literal"
>kless</TT
>, which you have renamed <TT
CLASS="literal"
>ksimpleapp</TT
>, contains the source code, Makefile, and some support files for an application called <TT
CLASS="literal"
>kless</TT
>.</P
></TD
><TD
WIDTH="10%"
VALIGN="BOTTOM"
ALIGN="CENTER"
><ANNMARK
NAME="ch16lev2sec1"/></TD
></TR
><ANNOTATION
NAME="ch16lev2sec1"
TITLE="Configuring the Top-Level Directory"/></TABLE
></DIV
><DIV
CLASS="section"
><TABLE
WIDTH="100%"
CELLPADDING="0"
CELLSPACING="0"
BORDER="0"
ALIGN="CENTER"
><TR
><TD
WIDTH="90%"
><H2
CLASS="section"
><A
NAME="ch16lev2sec2"
>16.2.2. Configuring the Subdirectories</A
></H2
><P
>Now prepare the subdirectory <TT
CLASS="literal"
>ksimpleapp</TT
> for KSimpleApp:</P
><OL
COMPACT="COMPACT"
TYPE="1"
><LI
><P
>Delete the files kless.cpp, kless.h, and configure.in.in&#8212;you won't be needing them.</P
></LI
><LI
><P
>Rename kless.desktop to ksimpleapp.desktop.</P
></LI
><LI
><P
>Copy the source code for KSimpleApp to this directory. The necessary files are ksimpleapp.h, ksimpleapp.cpp, and main.cpp. (These files are part of the source code from <A
HREF="ch02.html"
>Chapter 2</A
>.)</P
></LI
><LI
><P
>Rename the files lom-app-kless.png and los-app-kless.png to lom-app-ksimpleapp.png and los-app-ksimpleapp.png, respectively. You can use the kless icon instead of drawing your own just for this example. When you distribute your application, you should create your own icons according to the KDE style guidelines in <A
HREF="ch06.html"
>Chapter 6, <SPAN
CLASS="QUOTE"
>"KDE Style Reference."</SPAN
></A
></P
></LI
></OL
><P
>Now you need to configure the file Makefile.am. This file is read by automake when you run make Makefile.dist. Automake produces the file Makefile.in from it (from which Autoconf produces Makefile, as discussed previously).</P
><P
>Makefile.am contains a list of variable assignments and standard make rules. The standard make rules are copied directly to Makefile.in and then to Makefile. The assigned variables have special names that tell Automake how to create Makefile.in. For example, value assigned to the variable bin_PROGRAMS is the name of the application being created. <A
HREF="ch16lev1sec2.html#ch16list01"
>Listing 16.1</A
> shows an edited version of the Makefile.am found in the subdirectory kexample/kless. It has been edited to build KSimpleApp. (The original file was well commented; these comments have been removed here for brevity.)</P
><DIV
CLASS="example"
><HR/><A
NAME="ch16list01"
></A
><P
><B
>Example 16.1. Makefile.am: An Automake Source File Used to Build KSimpleApp</B
></P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>   1&nbsp;
   2&nbsp; 1: INCLUDES= $(all_includes)
   3&nbsp; 2:
   4&nbsp; 3: bin_PROGRAMS =     ksimpleapp
   5&nbsp; 4:
   6&nbsp; 5: ksimpleapp_SOURCES = ksimpleapp.cpp main.cpp
   7&nbsp; 6:
   8&nbsp; 7: ksimpleapp_METASOURCES = AUTO
   9&nbsp; 8:
  10&nbsp; 9: ksimpleapp_LDFLAGS = $(all_libraries) $(KDE_RPATH)
  11&nbsp;10: ksimpleapp_LDADD = $(LIB_KDEUI)
  12&nbsp;11:
  13&nbsp;12: noinst_HEADERS = ksimpleapp.h
  14&nbsp;13:
  15&nbsp;14: messages:
  16&nbsp;15:     $(XGETTEXT) --c++ -ki18n -x $(includedir)/kde.pot \
  17&nbsp;16       $(ksimpleapp_SOURCES) &amp;&amp;mv messages.po ../po/ksimpleapp.pot
  18&nbsp;17:
  19&nbsp;18: kdelnkdir = $(kde_appsdir)/Utilities
  20&nbsp;19: kdelnk_DATA = ksimpleapp.desktop
  21&nbsp;10:
  22&nbsp;21: KDE_ICON = ksimpleapp
  23&nbsp;</PRE
></TD
></TR
></TABLE
><HR/></DIV
><P
>The following variables should be assigned in Makefile.am.</P
><P
><TT
CLASS="literal"
>INCLUDES</TT
>&#8212;(Line 1) Include paths passed to the C++ compiler. Set this to <TT
CLASS="literal"
>$(all_includes)</TT
> to get the KDE, Qt, and X11 include paths. Add other paths as needed (for example, to locate include files for a custom or other third-party library).</P
><P
><TT
CLASS="literal"
>bin_PROGRAMS</TT
>&#8212;(Line 3) The name of the binary to create. In this example, it is ksimpleapp.</P
><P
><TT
CLASS="literal"
>ksimpleapp_SOURCES</TT
>&#8212;(Line 5) The names of all the source files separated by spaces. Use the name assigned to <TT
CLASS="literal"
>bin_PROGRAMS</TT
> as the first part of this and other variables (see subsequent items in this table). (Actually, the name assigned to <TT
CLASS="literal"
>bin_PROGRAMS</TT
> needs to be converted a bit; all characters except letters and numbers should be converted to underscores. For example, if <TT
CLASS="literal"
>bin_PROGRAMS</TT
> were set to <TT
CLASS="literal"
>my-program</TT
>, the <TT
CLASS="literal"
>SOURCES</TT
> variable would be <TT
CLASS="literal"
>my_program_SOURCES</TT
>.)</P
><P
><TT
CLASS="literal"
>ksimpleapp_METASOURCE</TT
>&#8212;(Line 7) You should always set this to <TT
CLASS="literal"
>AUTO</TT
>. Dependencies for *.moc files are automatically set up in <TT
CLASS="literal"
>Makefile</TT
>. For this to work, you should include *.moc files in your C++ source code, the same as you've done throughout this book.</P
><P
><TT
CLASS="literal"
>ksimpleapp_LDFLAGS</TT
>&#8212;(Line 9) A list of paths to search for libraries. Set this to <TT
CLASS="literal"
>$(all_libraries)</TT
> to add the search paths for the necessary KDE, Qt, and X libraries.</P
><P
><TT
CLASS="literal"
>ksimpleapp_LADD</TT
>&#8212;(Line 10) A list of libraries to link to. Setting this to <TT
CLASS="literal"
>$(LIB_KDEUI)</TT
> links ksimpleapp to libkdeui, as well as to all the other libraries necessary to compile a basic KDE application. If you need libkfile, libkimgo, libkio, or libkab, you should  add the variables&#8212;<TT
CLASS="literal"
>$(LIB_KFILE)</TT
>, <TT
CLASS="literal"
>$(LIB_KIMGIO)</TT
>, <TT
CLASS="literal"
>$(LIB_KIO)</TT
>, or <TT
CLASS="literal"
>$(LIB_KAB)</TT
>&#8212;to this line. Be sure to separate the variable names with a space and place libraries in reverse order of dependence. For example, if library1 depends on library2, place library1 first in the list.</P
><P
><TT
CLASS="literal"
>noinst_HEADERS</TT
>&#8212;(Line 12) The header files listed here should not be installed along with the application.</P
><P
><TT
CLASS="literal"
>kdelnkdir</TT
>&#8212;(Line 18) The directory in which to install the ksimpleapp.desktop file. (Recall that the *.kdelnk files of KDE 1.x have been replaced with *.desktop files in KDE 2.0; this explains the name of this variable.)</P
><P
><TT
CLASS="literal"
>kdelnk_DATA</TT
>&#8212;(Line 19) The name of the .desktop file to install.</P
><P
><TT
CLASS="literal"
>KDE_ICON</TT
>&#8212;(Line 21) The root of the icon names. The icon names are <TT
CLASS="literal"
>lo32-app- ksimpleapp.png</TT
> and <TT
CLASS="literal"
>lo16-app-ksimpleapp.png</TT
>. The root is <TT
CLASS="literal"
>ksimpleapp</TT
>. The prefixes are <TT
CLASS="literal"
>app</TT
> for application, <TT
CLASS="literal"
>lom</TT
> for <SPAN
CLASS="QUOTE"
>"low color, medium sized,"</SPAN
> and <TT
CLASS="literal"
>los</TT
> for <SPAN
CLASS="QUOTE"
>"low color, small sized."</SPAN
></P
><P
>The last part of Makefile.am, which I haven't mentioned yet, is the target messages. This target (lines 14 and 15) follows the standard makefile conventions and is carried through unchanged by Automake and Autoconf to the final Makefile. When you run <TT
CLASS="literal"
>make messages</TT
>, the string literals that have been passed to the function <TT
CLASS="literal"
>i18n()</TT
> are extracted from all files listed in <TT
CLASS="literal"
>$(ksimpleapp_SOURCES)</TT
> to the file <TT
CLASS="literal"
>../po/ksimpleapp.pot</TT
>. This file serves as a template for creating translations of the string literals. The option <TT
CLASS="literal"
>-x $(includedir)/kde.pot</TT
> says to ignore strings that have been previously translated for global use by KDE applications. See <A
HREF="ch07.html"
>Chapter 7, <SPAN
CLASS="QUOTE"
>"Further KDE Compliance,"</SPAN
></A
> for information on how to create and use translation (<TT
CLASS="literal"
>*.po</TT
>) files.</P
></TD
><TD
WIDTH="10%"
VALIGN="BOTTOM"
ALIGN="CENTER"
><ANNMARK
NAME="ch16lev2sec2"/></TD
></TR
><ANNOTATION
NAME="ch16lev2sec2"
TITLE="Configuring the Subdirectories"/></TABLE
></DIV
><DIV
CLASS="section"
><TABLE
WIDTH="100%"
CELLPADDING="0"
CELLSPACING="0"
BORDER="0"
ALIGN="CENTER"
><TR
><TD
WIDTH="90%"
><H2
CLASS="section"
><A
NAME="ch16lev2sec3"
>16.2.3. Updating Administration Files</A
></H2
><P
>You may now update the administration files. First, make sure that the environment variables <TT
CLASS="literal"
>KDEDIR</TT
> and <TT
CLASS="literal"
>QTDIR</TT
> are set appropriately to the root KDE and Qt directories. Change directories to the top-level directory and type</P
><DIV
CLASS="informalexample"
><HR/><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>   1&nbsp;
   2&nbsp;<I
CLASS="emphasis"
>make -f Makefile.dist</I
>
   3&nbsp;<I
CLASS="emphasis"
>./configure</I
>
   4&nbsp;</PRE
></TD
></TR
></TABLE
><HR/></DIV
><P
>This performs the updates. You can now compile the application with <TT
CLASS="literal"
>make</TT
>.</P
></TD
><TD
WIDTH="10%"
VALIGN="BOTTOM"
ALIGN="CENTER"
><ANNMARK
NAME="ch16lev2sec3"/></TD
></TR
><ANNOTATION
NAME="ch16lev2sec3"
TITLE="Updating Administration Files"/></TABLE
></DIV
><DIV
CLASS="section"
><TABLE
WIDTH="100%"
CELLPADDING="0"
CELLSPACING="0"
BORDER="0"
ALIGN="CENTER"
><TR
><TD
WIDTH="90%"
><H2
CLASS="section"
><A
NAME="ch16lev2sec4"
>16.2.4. Creating Shared Libraries</A
></H2
><P
>The KDE package-management system you have been reading about makes the creation of shared libraries quite simple. To do this, create a subdirectory and copy the library's source code into it. Next, copy the file Makefile.am from the kless directory and modify it the same as you did for <TT
CLASS="literal"
>ksimpleapp</TT
>, except for two things:</P
><OL
COMPACT="COMPACT"
TYPE="1"
><LI
><P
>Instead of assigning a value to the variable <TT
CLASS="literal"
>bin_PROGRAMS</TT
>, set the variable <TT
CLASS="literal"
>lib_ LTLIBRARIES</TT
>. For example:</P
><DIV
CLASS="informalexample"
><HR/><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>   1&nbsp;
   2&nbsp;lib_LTLIBRARIES  = libkplotw.la
   3&nbsp;</PRE
></TD
></TR
></TABLE
><HR/></DIV
><P
>tells automake that you are interested in creating a library called libkplotw.la.</P
></LI
><LI
><P
>Add some linker flags:</P
><DIV
CLASS="informalexample"
><HR/><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>   1&nbsp;
   2&nbsp;libkplotw_la_LDFLAGS = -version-info 0:2:0 $(all_libraries) -no-undefined
   3&nbsp;</PRE
></TD
></TR
></TABLE
><HR/></DIV
><P
>Notice that an underscore has been substituted for the period in <TT
CLASS="literal"
>libkplotw.la</TT
>. The option <TT
CLASS="literal"
>-version-info a:b:c</TT
> says to create a library with the version number (a-c).c.b For example, this library would be created as <TT
CLASS="literal"
>libkplotw.so.0.0.2</TT
>. The option <TT
CLASS="literal"
>-no-undefined</TT
> says that no external symbols are needed by this library (it is needed to create a shared library).</P
></LI
></OL
></TD
><TD
WIDTH="10%"
VALIGN="BOTTOM"
ALIGN="CENTER"
><ANNMARK
NAME="ch16lev2sec4"/></TD
></TR
><ANNOTATION
NAME="ch16lev2sec4"
TITLE="Creating Shared Libraries"/></TABLE
></DIV
><DIV
CLASS="section"
><TABLE
WIDTH="100%"
CELLPADDING="0"
CELLSPACING="0"
BORDER="0"
ALIGN="CENTER"
><TR
><TD
WIDTH="90%"
><H2
CLASS="section"
><A
NAME="ch16lev2sec5"
>16.2.5. Using Test Results</A
></H2
><P
>You can use the results of the tests run by the script configure in a source-code file by including the file config.h with the following statement:</P
><DIV
CLASS="informalexample"
><HR/><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>   1&nbsp;
   2&nbsp;#include &lt;config.h&gt;
   3&nbsp;</PRE
></TD
></TR
></TABLE
><HR/></DIV
><P
>Then do either of the following:</P
><UL
COMPACT="COMPACT"
><LI
STYLE="list-style-type: none"
><P
>Examine the macros defined in this file with preprocessor directives.</P
></LI
><LI
STYLE="list-style-type: none"
><P
>Use the macros directly.</P
></LI
></UL
><P
>The file config.h is created automatically by the script configure after the tests are run.</P
><P
>Let's examine the second method.</P
><P
>Add the statement <TT
CLASS="literal"
>#include &lt;config.h&gt;</TT
> to the file ksimpleapp.cpp and change the following line:</P
><DIV
CLASS="informalexample"
><HR/><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>   1&nbsp;
   2&nbsp;text = new QLabel (i18n("Hello!"), this);
   3&nbsp;</PRE
></TD
></TR
></TABLE
><HR/></DIV
><P
>to the lines</P
><DIV
CLASS="informalexample"
><HR/><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>   1&nbsp;
   2&nbsp;QString qs (i18n("Hello from "));
   3&nbsp;qs = qs + VERSION +"!";
   4&nbsp;text = new QLabel (qs, this);
   5&nbsp;</PRE
></TD
></TR
></TABLE
><HR/></DIV
><P
>The identifier <TT
CLASS="literal"
>VERSION</TT
> is a macro defined in config.h by the statement</P
><DIV
CLASS="informalexample"
><HR/><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>   1&nbsp;
   2&nbsp;#define VERSION "1.0"
   3&nbsp;</PRE
></TD
></TR
></TABLE
><HR/></DIV
><P
>The string <SPAN
CLASS="QUOTE"
>"1.0"</SPAN
> comes, ultimately, from your declaration of the version in the call to <TT
CLASS="literal"
>AM_INIT_AUTOMAKE()</TT
> in the file configure.in.</P
><P
>Other macros are defined that tell about the build environment. The file config.h in well commented and describes the purpose of each macro.</P
></TD
><TD
WIDTH="10%"
VALIGN="BOTTOM"
ALIGN="CENTER"
><ANNMARK
NAME="ch16lev2sec5"/></TD
></TR
><ANNOTATION
NAME="ch16lev2sec5"
TITLE="Using Test Results"/></TABLE
></DIV
><DIV
CLASS="section"
><TABLE
WIDTH="100%"
CELLPADDING="0"
CELLSPACING="0"
BORDER="0"
ALIGN="CENTER"
><TR
><TD
WIDTH="90%"
><H2
CLASS="section"
><A
NAME="ch16lev2sec6"
>16.2.6. Make Targets</A
></H2
><P
>The makefiles that are generated by Automake/Autoconf contain several make targets that help make the development cycle more efficient. Several commonly used targets are listed in <A
HREF="ch16lev1sec2.html#ch16table02"
>Table 16.2</A
>.</P
><DIV
CLASS="table"
><HR/><A
NAME="ch16table02"
></A
><P
><B
>Table 16.2. Commonly Used Targets Included in Autogenerated Makefiles</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><THEAD
><TR
><TH
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
><I
CLASS="emphasis"
>Target</I
></TH
><TH
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
><I
CLASS="emphasis"
>Description</I
></TH
></TR
></THEAD
><TBODY
><TR
><TD
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
><TT
CLASS="literal"
>all</TT
></TD
><TD
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
>Build the entire package. This is the default target (that is, it is assumed if no target is specified).</TD
></TR
><TR
><TD
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
><TT
CLASS="literal"
>install</TT
></TD
><TD
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
>Install the package. The target all is made if it hasn't been already.</TD
></TR
><TR
><TD
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
><TT
CLASS="literal"
>uninstall</TT
></TD
><TD
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
>Remove the package.</TD
></TR
><TR
><TD
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
><TT
CLASS="literal"
>clean</TT
></TD
><TD
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
>Remove the build results (*.o files, executables, and so on) but not configuration results (config.cache, and so on).</TD
></TR
><TR
><TD
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
><TT
CLASS="literal"
>distclean</TT
></TD
><TD
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
>Preparing the package for distribution removes both build results and results of configuration. You can still rebuild the package without having Automake, Perl, and Autoconf installed.</TD
></TR
><TR
><TD
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
><TT
CLASS="literal"
>maintainer-clean</TT
></TD
><TD
WIDTH="50%"
ALIGN="LEFT"
VALIGN="TOP"
>Removes even more than <TT
CLASS="literal"
>distclean</TT
>. You'll need to have Automake, Perl, and Autoconf to rebuild after making this target.</TD
></TR
></TBODY
></TABLE
><HR/></DIV
><P
>The targets <TT
CLASS="literal"
>all</TT
>, <TT
CLASS="literal"
>install</TT
>, and <TT
CLASS="literal"
>uninstall</TT
> will be used by end users and generally, the others will be used only by the maintainer(s) of the package.</P
></TD
><TD
WIDTH="10%"
VALIGN="BOTTOM"
ALIGN="CENTER"
><ANNMARK
NAME="ch16lev2sec6"/></TD
></TR
><ANNOTATION
NAME="ch16lev2sec6"
TITLE="Make Targets"/></TABLE
></DIV
></TD
><TD
WIDTH="10%"
VALIGN="BOTTOM"
ALIGN="CENTER"
><ANNMARK
NAME="ch16lev1sec2"/></TD
></TR
><ANNOTATION
NAME="ch16lev1sec2"
TITLE="Administrative Files"/></TABLE
></DIV
><DIV
ALIGN="RIGHT"
CLASS="NAVBAR"
><P
><A
HREF="ch16.html"
>Prev</A
> <A
HREF="ch16lev1sec3.html"
>Next</A
> <A
HREF="index.html"
>Table of Contents</A
></P
></DIV
><HR
WIDTH="100%"
SIZE="2"
ALIGN="CENTER"
NOSHADE="NOSHADE"/></BODY
></HTML
>
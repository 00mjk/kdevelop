<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML
><HEAD
><TITLE
>Special Features (ImageIO, OpenGL, Mesa)</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.54"/><LINK
REL="HOME"
TITLE="KDE 2.0 Development"
HREF="index.html"/><LINK
REL="UP"
TITLE="The Qt Toolkit"
HREF="ch03.html"/><LINK
REL="PREVIOUS"
TITLE="The Utility Classes"
HREF="ch03lev1sec5.html"/><LINK
REL="NEXT"
TITLE="Summary"
HREF="ch03lev1sec7.html"/><META
HTTP-EQUIV="Content-Style-Type"
CONTENT="text/css"/><LINK
REL="stylesheet"
HREF="kde-common.css"
TYPE="text/css"/><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=iso-8859-1"/><META
HTTP-EQUIV="Content-Language"
CONTENT="en"/><LINK
REL="stylesheet"
HREF="kde-localised.css"
TYPE="text/css"
TITLE="KDE-English"/><LINK
REL="stylesheet"
HREF="kde-default.css"
TYPE="text/css"
TITLE="KDE-Default"/></HEAD
><BODY
CLASS="section"
LINK="#336699"
VLINK="#336699"
ALINK="#336699"
BGCOLOR="#FFFFFF"
><DIV
ALIGN="RIGHT"
CLASS="NAVBAR"
><P
><A
HREF="ch03lev1sec5.html"
>Prev</A
> <A
HREF="ch03lev1sec7.html"
>Next</A
> <A
HREF="index.html"
>Table of Contents</A
></P
></DIV
><DIV
CLASS="section"
><TABLE
WIDTH="100%"
CELLPADDING="0"
CELLSPACING="0"
BORDER="0"
ALIGN="CENTER"
><TR
><TD
WIDTH="90%"
><H1
CLASS="section"
><A
NAME="ch03lev1sec6"
>3.6. Special Features (ImageIO, OpenGL, Mesa)</A
></H1
><P
>There are some special features in Qt that you should know about. They provide you with special features that are not normally included with toolkits.</P
><DIV
CLASS="section"
><TABLE
WIDTH="100%"
CELLPADDING="0"
CELLSPACING="0"
BORDER="0"
ALIGN="CENTER"
><TR
><TD
WIDTH="90%"
><H2
CLASS="section"
><A
NAME="ch03lev2sec15"
>3.6.1. ImageIO</A
></H2
><P
>This special feature adds support for some image file formats. It opens and saves pictures for you.</P
><DIV
CLASS="section"
><TABLE
WIDTH="100%"
CELLPADDING="0"
CELLSPACING="0"
BORDER="0"
ALIGN="CENTER"
><TR
><TD
WIDTH="90%"
><H3
CLASS="section"
><A
NAME="ch03lev3sec10"
>3.6.1.1. Using ImageIO</A
></H3
><P
>The ImageIO feature adds support for many graphics file formats. The <TT
CLASS="literal"
>QImage</TT
> widget uses this feature to open and save graphics files.</P
></TD
><TD
WIDTH="10%"
VALIGN="BOTTOM"
ALIGN="CENTER"
><ANNMARK
NAME="ch03lev3sec10"/></TD
></TR
><ANNOTATION
NAME="ch03lev3sec10"
TITLE="Using ImageIO"/></TABLE
></DIV
><DIV
CLASS="section"
><TABLE
WIDTH="100%"
CELLPADDING="0"
CELLSPACING="0"
BORDER="0"
ALIGN="CENTER"
><TR
><TD
WIDTH="90%"
><H3
CLASS="section"
><A
NAME="ch03lev3sec11"
>3.6.1.2. A Sample ImageIO Program</A
></H3
><P
><A
HREF="ch03lev1sec6.html#ch03list11"
>Listing 3.11</A
> shows you how it works. The program will open and display a JPEG image (shown in <A
HREF="ch03lev1sec6.html#ch03fig05"
>Figure 3.5</A
>):</P
><DIV
CLASS="example"
><HR/><A
NAME="ch03list11"
></A
><P
><B
>Example 3.11. imageio.cpp: An Image Viewer Program</B
></P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>   1&nbsp;
   2&nbsp; 1: #include &lt;kapp.h&gt;
   3&nbsp; 2: #include &lt;qwidget.h&gt;
   4&nbsp; 3: #include &lt;qpainter.h&gt;  // The QPainter class draws graphics on widgets.
   5&nbsp; 4: #include &lt;qimage.h&gt;
   6&nbsp; 5: 
   7&nbsp; 6: class MyWindow : public QWidget
   8&nbsp; 7: {
   9&nbsp; 8:   public:
  10&nbsp; 9:     // Constructor for the window, just call the QWidget constructor
  11&nbsp;10:     MyWindow() : QWidget() { }
  12&nbsp;11:   protected:
  13&nbsp;12:     void paintEvent(QPaintEvent *);
  14&nbsp;13: };
  15&nbsp;14: 
  16&nbsp;15: // This function is called when the window area must be updated.
  17&nbsp;16: // Load and view the image
  18&nbsp;17: void MyWindow::paintEvent(QPaintEvent *ev)
  19&nbsp;18: {
  20&nbsp;19:   // Load the image that we want to show
  21&nbsp;20:   QImage image;
  22&nbsp;21:   if (image.load("test.jpg", 0))  // If the image was loaded,
  23&nbsp;22:   {                               // Show the image.
  24&nbsp;23:     // Draw graphics in this window
  25&nbsp;24:     QPainter paint(this);
  26&nbsp;25:     // Draw the image we loaded on the window
  27&nbsp;26:     paint.drawImage(0, 0, image, 0, 0,
  28&nbsp;27:                     image.width(), image.height());
  29&nbsp;28:   }
  30&nbsp;29: }
  31&nbsp;30: 
  32&nbsp;31: 
  33&nbsp;32: int main(int argc, char **argv)
  34&nbsp;33: {
  35&nbsp;34:   KApplication app(argc, argv)
  36&nbsp;35:   // Create the window
  37&nbsp;36:   MyWindow window;
  38&nbsp;37:   app.setMainWidget(&amp;window);
  39&nbsp;38:   window.setCaption("ImageIO Example");
  40&nbsp;39:   window.setGeometry(100,100,300,300);
  41&nbsp;40:   window.show();
  42&nbsp;41:   return app.exec();
  43&nbsp;42: }
  44&nbsp;</PRE
></TD
></TR
></TABLE
><HR/></DIV
><DIV
CLASS="figure"
><HR/><A
NAME="ch03fig05"
></A
><P
><B
>Figure 3.5. Showing a JPEG Picture with ImageIO.</B
></P
><DIV
CLASS="mediaobject"
><P
><IMG
SRC="graphics/03fig05.gif"
></IMG
></P
></DIV
><HR/></DIV
><P
>To compile the program, use the following commands:</P
><DIV
CLASS="informalexample"
><HR/><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>   1&nbsp;
   2&nbsp;<I
CLASS="emphasis"
>g++ -c -I$QTDIR/include</I
> <I
CLASS="emphasis"
>imageio.cpp</I
>
   3&nbsp;<I
CLASS="emphasis"
>g++ -o</I
> <I
CLASS="emphasis"
>iio imageio.o</I
> <I
CLASS="emphasis"
>-L$QTDIR/lib -lqt -lqimgio -ljpeg</I
>
   4&nbsp;</PRE
></TD
></TR
></TABLE
><HR/></DIV
><P
>This feature is useful in all programs that need to load or store pictures. Image viewers and paint programs are two kinds of programs that may benefit from ImageIO.</P
></TD
><TD
WIDTH="10%"
VALIGN="BOTTOM"
ALIGN="CENTER"
><ANNMARK
NAME="ch03lev3sec11"/></TD
></TR
><ANNOTATION
NAME="ch03lev3sec11"
TITLE="A Sample ImageIO Program"/></TABLE
></DIV
></TD
><TD
WIDTH="10%"
VALIGN="BOTTOM"
ALIGN="CENTER"
><ANNMARK
NAME="ch03lev2sec15"/></TD
></TR
><ANNOTATION
NAME="ch03lev2sec15"
TITLE="ImageIO"/></TABLE
></DIV
><DIV
CLASS="section"
><TABLE
WIDTH="100%"
CELLPADDING="0"
CELLSPACING="0"
BORDER="0"
ALIGN="CENTER"
><TR
><TD
WIDTH="90%"
><H2
CLASS="section"
><A
NAME="ch03lev2sec16"
>3.6.2. OpenGL, Mesa</A
></H2
><P
>OpenGL is an API for 2D and 3D graphics programming. It is quite useful, but you must buy a license before you may develop an OpenGL program.</P
><P
>Mesa is a free library with similar functions. You can compile and run most OpenGL programs with Mesa.</P
><P
>If you want to learn more about the OpenGL language, I recommend either the <I
CLASS="citetitle"
>OpenGL</I
> Web site, <A
HREF="http://www.opengl.org"
TARGET="_top"
>(http://www.opengl.org)</A
>, or the <I
CLASS="citetitle"
>Mesa</I
> Web site, <A
HREF="http://www.mesa3d.org"
TARGET="_top"
>(http://www.mesa3d.org)</A
>.</P
><DIV
CLASS="section"
><TABLE
WIDTH="100%"
CELLPADDING="0"
CELLSPACING="0"
BORDER="0"
ALIGN="CENTER"
><TR
><TD
WIDTH="90%"
><H3
CLASS="section"
><A
NAME="ch03lev3sec12"
>3.6.2.1. The QGL Widget</A
></H3
><P
>If you want to create OpenGL programs, I recommend the <TT
CLASS="literal"
>QGL</TT
> widget. <TT
CLASS="literal"
>QGL</TT
> is a widget that enables OpenGL code in Qt programs. The OpenGL compatibility in QGL comes from Mesa. The <TT
CLASS="literal"
>QGL</TT
> widget has three virtual member functions, into which you put your OpenGL code.</P
><UL
COMPACT="COMPACT"
><LI
STYLE="list-style-type: disc"
><P
><TT
CLASS="literal"
>initializeGL()</TT
> is called first. In this function you write the code that sets up the OpenGL rendering.</P
></LI
><LI
STYLE="list-style-type: disc"
><P
><TT
CLASS="literal"
>paintGL()</TT
> is called when the graphics must be drawn. This is where you put all the code that draws things on the screen.</P
></LI
><LI
STYLE="list-style-type: disc"
><P
><TT
CLASS="literal"
>resizeGL(int width, int height)</TT
> is called when the widget is resized. If you want to respond to resize events, this is where you do it.</P
></LI
></UL
><DIV
CLASS="note"
><TABLE
CLASS="note"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="note.png"
HSPACE="5"
ALT="Note"/></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>You must install the Mesa or OpenGL libraries before you can use the OpenGL special feature in Qt. The Mesa libraries can be downloaded from <A
HREF="http://www.mesa3d.org"
TARGET="_top"
>http://www.mesa3d.org</A
></P
></TD
></TR
></TABLE
></DIV
></TD
><TD
WIDTH="10%"
VALIGN="BOTTOM"
ALIGN="CENTER"
><ANNMARK
NAME="ch03lev3sec12"/></TD
></TR
><ANNOTATION
NAME="ch03lev3sec12"
TITLE="The QGL Widget"/></TABLE
></DIV
><DIV
CLASS="section"
><TABLE
WIDTH="100%"
CELLPADDING="0"
CELLSPACING="0"
BORDER="0"
ALIGN="CENTER"
><TR
><TD
WIDTH="90%"
><H3
CLASS="section"
><A
NAME="ch03lev3sec13"
>3.6.2.2. A Sample OpenGL Program</A
></H3
><P
><A
HREF="ch03lev1sec6.html#ch03list12"
>Listing 3.12</A
> demonstrates the OpenGL special feature.</P
><DIV
CLASS="example"
><HR/><A
NAME="ch03list12"
></A
><P
><B
>Example 3.12. main.cpp: OpenGL Program for Qt</B
></P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>   1&nbsp;
   2&nbsp;#include &lt;kapp.h&gt;
   3&nbsp;#include &lt;qgl.h&gt;
   4&nbsp;
   5&nbsp;// The QGLWidget is a QWidget with support for OpenGL
   6&nbsp;class MyWindow : public QGLWidget
   7&nbsp;{
   8&nbsp;  public:
   9&nbsp;    MyWindow() : QGLWidget() { }
  10&nbsp;  protected:
  11&nbsp;    // The functions where you put your OpenGL code.
  12&nbsp;    void initializeGL();     // The start code for the widget
  13&nbsp;    void resizeGL(int, int); // The widget is resized
  14&nbsp;    void paintGL();          // Redraw the graphics.
  15&nbsp;};
  16&nbsp;
  17&nbsp;
  18&nbsp;void MyWindow::initializeGL()
  19&nbsp;{
  20&nbsp;  glClearColor(1.0, 1.0, 1.0, 1.0);
  21&nbsp;  glMatrixMode(GL_PROJECTION);
  22&nbsp;  glLoadIdentity();
  23&nbsp;  glOrtho(0.0, 10.0, 0.0, 10.0, -1.0, 1.0);
  24&nbsp;}
  25&nbsp; 
  26&nbsp;void MyWindow::paintGL()
  27&nbsp;{
  28&nbsp;  glClear(GL_COLOR_BUFFER_BIT);
  29&nbsp;
  30&nbsp;  glColor3f(0.0, 0.1, 0.4);
  31&nbsp;
  32&nbsp;  glBegin(GL_POLYGON);
  33&nbsp;  glVertex3f(3.0, 5.5, 0.0);
  34&nbsp;  glVertex3f(5.0, 8.0, 0.0);
  35&nbsp;  glVertex3f(7.0, 5.5, 0.0);
  36&nbsp;  glEnd();
  37&nbsp;
  38&nbsp;  glBegin(GL_LINE_LOOP);
  39&nbsp;  glVertex3f(3.0, 4.5, 0.0);
  40&nbsp;  glVertex3f(5.0, 2.0, 0.0);
  41&nbsp;  glVertex3f(7.0, 4.5, 0.0);
  42&nbsp;  glEnd();
  43&nbsp;
  44&nbsp;  glFlush();
  45&nbsp;}
  46&nbsp;
  47&nbsp;void MyWindow::resizeGL(int w, int h)
  48&nbsp;{
  49&nbsp;  glViewport(0, 0, (GLint)w, (GLint)h);
  50&nbsp;}
  51&nbsp;
  52&nbsp;// A standard main() function
  53&nbsp;int main(int argc, char **argv)
  54&nbsp;{
  55&nbsp;  KApplication app(argc, argv, "QGL");
  56&nbsp;  MyWindow window;
  57&nbsp;  window.setGeometry(100,100,300,200);
  58&nbsp;  window.setCaption("OpenGL extension");
  59&nbsp;  app.setMainWidget(&amp;window);
  60&nbsp;  window.show();
  61&nbsp;  return app.exec();
  62&nbsp;}
  63&nbsp;</PRE
></TD
></TR
></TABLE
><HR/></DIV
><P
>This sample program is shown in <A
HREF="ch03lev1sec6.html#ch03fig06"
>Figure 3.6</A
>.</P
><DIV
CLASS="figure"
><HR/><A
NAME="ch03fig06"
></A
><P
><B
>Figure 3.6. The OpenGL sample program.</B
></P
><DIV
CLASS="mediaobject"
><P
><IMG
SRC="graphics/03fig06.gif"
></IMG
></P
></DIV
><HR/></DIV
></TD
><TD
WIDTH="10%"
VALIGN="BOTTOM"
ALIGN="CENTER"
><ANNMARK
NAME="ch03lev3sec13"/></TD
></TR
><ANNOTATION
NAME="ch03lev3sec13"
TITLE="A Sample OpenGL Program"/></TABLE
></DIV
></TD
><TD
WIDTH="10%"
VALIGN="BOTTOM"
ALIGN="CENTER"
><ANNMARK
NAME="ch03lev2sec16"/></TD
></TR
><ANNOTATION
NAME="ch03lev2sec16"
TITLE="OpenGL, Mesa"/></TABLE
></DIV
></TD
><TD
WIDTH="10%"
VALIGN="BOTTOM"
ALIGN="CENTER"
><ANNMARK
NAME="ch03lev1sec6"/></TD
></TR
><ANNOTATION
NAME="ch03lev1sec6"
TITLE="Special Features (ImageIO, OpenGL, Mesa)"/></TABLE
></DIV
><DIV
ALIGN="RIGHT"
CLASS="NAVBAR"
><P
><A
HREF="ch03lev1sec5.html"
>Prev</A
> <A
HREF="ch03lev1sec7.html"
>Next</A
> <A
HREF="index.html"
>Table of Contents</A
></P
></DIV
><HR
WIDTH="100%"
SIZE="2"
ALIGN="CENTER"
NOSHADE="NOSHADE"/></BODY
></HTML
>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<TITLE>KDevelop. Руководство программиста: Создание документации с использованием SGML</TITLE>
<META HTTP-EQUIV="content-type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="keywords" CONTENT="">
<META NAME="description" CONTENT="">
</HEAD>
<BODY BGCOLOR="#ffffff" LINK="#aa0000" TEXT="#000000" > 
<FONT FACE="Helvetica">
<A HREF="http://www.kde.org/"><IMG SRC="logotp3.png" BORDER="0" ALT="The K Desktop Environment"></A>
<HR WIDTH="100%" SIZE=2 ALIGN="CENTER" NOSHADE>

 
<P ALIGN="RIGHT">

<A HREF="index-10.html">Next</A>
 <A HREF="index-8.html">Previous</A>
 <A HREF="index.html#toc9">Table of Contents</A>
</P>
<H3><A NAME="s9">9. Создание документации с использованием SGML</A></H3>

<P>Учитывая тот факт, что зачастую проекты не содержат полного набора пользовательской документации, все проекты KDevelop 
включают в себя шаблон документации, который может быть легко приспособлен к проекту; этим достигается одна из целей KDE: предоставить достаточное количество online-помощи для поддержки пользователей, еще не овладевших приложением.
Эта глава посвящена тому, как расширить предлагаемый шаблон документации и что необходимо сделать, чтобы он стал доступен пользователю.
<P>
<H3><A NAME="ss9.1">9.1 Почему SGML ?</A>
</H3>

<P>SGML (Standard Generalized Markup Language) 
- язык, с помощью которого можно написать спецификацию другого языка разметки (markup language),
но он не является языком разметки сам по себе. Спецификация для языка разметки называется DTD (Document Type Definition, Определение типа документа), и содержит
структуры документа и доступные таги. Кроме того, SGML-система предоставляет набор файлов замены, которые переводят таги DTD
в требуемый формат - вот так это работает. Наиболее часто используемый формат вывода - HTML для создания online-помощи,
просматриваемой через браузер, учитывая, что стандарты Internet доступны даже на отдельно стоящих компьютерах. KDE широко использует HTML
документацию в KDEHelp, в котором приведены все приложения KDE, и предоставляет доступ к их руководствам пользователя.
Эти руководства доступны также через меню Help непосредственно из приложения.
<P>Сейчас KDE и, следовательно, KDevelop, используют пакет SGML-Tools 1.x (см. 
<A HREF="http://www.sgmltools.org">http://www.sgmltools.org</A>), ранее известный как
пакет LinuxDoc. Он содержит DTD, называемый <CODE>LinuxDoc</CODE>, набор map-файлов для генерации выходных файлов в различных форматах
и необходимые инструменты, которые в действительности производят замену тагов <CODE>LinuxDoc</CODE>. LinuxDoc DTD базируется на Qwertz DTD, который, в свою очередь,
был написан для обеспечения хорошего картирования (mapping, то есть замена тагов) в основном для текстовой системы LaTeX, поэтому с ним очень легко генерировать
готовые к печати документы. Пакет получил свое название в связи с его использованием для написания документации LDP (Linux Documentation Project, Проект документирования Linux),
и его имя было изменено только из-за того, что это была sgml-система, которая вовсе не должна быть связана с Linux-проектом, а может использоваться
на любой из Unix-систем; вы можете даже написать свой собственный DTD и map-файлы для него.
<P>Тем временем был разработан для определенных целей другой DTD - "DocBook DTD". DocBook имеет почти те же возможности, что и 
LinuxDoc DTD, но предоставляет лучшие таги и map-файлы для таблиц и включаемой графики, но все это возможно и в LinuxDoc.
SGML-инструмент, таким образом, получил необходимость поддержки DocBook DTD в серии версий 2.x, которые также предоставляли конвертер для получения
DocBook sgml из исходников LinuxDoc.
<P>В своем текущем состоянии KDE все еще использует LinuxDoc DTD по нескольким причинам:
<LI>написание LinuxDoc документации проще,</LI>
<LI>инсталляция SGML-Tools 1.x для использования LinuxDoc еще проще,</LI>
<LI>KDE предоставляет дополнительный инструмент, называемый <CODE>ksgml2html</CODE>, который придает стиль KDE выходным файлам HTML, генерируемым
конвертером SGML-Tools 1.x <CODE>sgml2html</CODE>.</LI>
<P>Я сам обнаружил, пока писал книги о KDevelop, что использовать LinuxDoc DTD очень просто, и он предоставляет все необходимое
для написания документации. Скорость изучения очень высокая, поэтому вы сможете стать гуру в области sgml-tools/LinuxDoc DTD
за несколько дней, и это сохранит вам очень много времени при работе с такими системами форматирования, как TeX для распечатки
документации или языком разметки для создания HTML.
<P>Основная причина продолжать использовать sgml-tools 1.x - большинство дистрибутивов содержат пакет и дополнительные средства, необходимые вам
для производства других выходных форматов. Это делает инсталляцию максимально простой, да и написание sgml-документа само по себе не сложное, как вы увидите. 
Вы можете получить документы в следующих форматах, генерируя их из sgml: 
<P>
<UL>
<LI>HTML, который приобретает вид KDE документа, если дополнительно используется <CODE>ksgml2html</CODE>,</LI>
<LI>текст,</LI>
<LI>GNU info,</LI>
<LI>Lyx формат,</LI>
<LI>TeX, DVI, PostScript и PDF формат,</LI>
<LI>Rich Text Format (RTF).</LI>
</UL>
<P>
<P>
<H3><A NAME="ss9.2">9.2 Что уже содержит шаблон документации</A>
</H3>

<P>При создании проекта KDevelop подкаталог <CODE>docs/en</CODE> уже содержит файл <CODE>index.sgml</CODE> с документацией на английском языке и
уже сгенерированные файлы HTML формата. Они уже включены в проект, и путь для их инсталляции указывает
на KDE HTML каталог. Документация уже адаптирована к вашему наименованию проекта, номеру версии и содержит информацию о программисте.
Далее, файл index.html включает содержание руководства по использованию программы. Этот файл открывается системой помощи KDE, когда пользователь
запрашивает помощь по работе с вашим приложением; в файл включены инструкция по установке, лицензия GPL и информация о copyright.
<P>При разработке документации вы должны только добавить информацию, специфичную для вашего приложения. Помните, что
проект KDE требует запуска "Make Doc-Handbook" из меню "Project" после окончания разработки проекта. Файл index.sgml
при этом вновь обрабатывается <CODE>ksgml2html</CODE> и генерируется выполненная в KDE-стиле HTML документация. Откройте каталог <CODE>docs/en</CODE> в RFV
и добавьте <CODE>logotp3.gif</CODE> в проект через контекстное меню; затем правильно задайте его свойства для инсталляции логотипа
в тот же каталог, где будут расположены HTML файлы - <CODE>$(kde_htmldir)/en/&lt;ваш_проект&gt;/logotp3.gif</CODE>.
<P>
<H3><A NAME="ss9.3">9.3 Написание SGML документации</A>
</H3>

<P>Этот раздел добавлен, потому что SGML (или, более точно, LinuxDoc DTD), все еще кажется сложным для начинающих
писать документацию. Когда я посмотрел на некоторые приложения KDE, то увидел, что некоторые из них содержат файл sgml в виде исходного шаблона -
а автор редактировал HTML файлы вместо sgml. Это приводит к проблемам при переводе - если необходимо
перевести документацию на родной язык, приходится редактировать каждый файл в HTML формате, и это делает
невозможным повторное использование документов в других форматах, причем не только в английской версии, а и во всех локализованных версиях проекта.
Как видно, это не продуманное решение, приводящее к весьма тяжким последствиям; я считаю, что это происходит, поскольку автор знает HTML,
но не знает SGML. Поскольку большинство старается избежать изучения нового языка форматирования, они используют HTML файлы как шаблон для редактирования.
Если вы однажды посмотрите на то, как легко и просто использовать SGML с LinuxDoc, вы решите, что лучше выучить несколько лишних тагов
и создавать SGML формат.
<P>Следующие разделы дают начальную информацию о наиболее важных частях файла sgml в LinuxDoc, и объясняют, как расширить
вашу документацию.
<P>
<H4>Объявления DTD</H4>

<P>Для того, чтобы показать, какой вариант DTD используется, каждый sgml файл начинается с объявления DTD.
Первый таг (взятое в скобки выражение, например &lt;ваш_таг&gt; содержимое &lt;/ваш_таг&gt;) всегда DOCTYPE:
<P>
<PRE>
&lt;!doctype linuxdoc system&gt;
</PRE>
<P>Это сообщает вашему форматировщику sgml, что он должен использовать LinuxDoc DTD.
<P>
<H4>Структура документа</H4>

<P>При использовании LinuxDoc следующий таг - стартовый таг документа, определяющий его стиль. LinuxDoc DTD предлагает целый набор типов документов,
из который вы можете выбрать нужный в зависимости от назначения документа и его длины. Доступны следующие типы:
<P>
<UL>
<LI><CODE>&lt;notes&gt;</CODE> для короткого пояснения,</LI>
<LI><CODE>&lt;article&gt;</CODE> для написания статьи длиной 10-20 страниц (примерно). Этот тип используется в качестве шаблона в KDevelop и большинстве KDE
приложений,</LI>
<LI><CODE>&lt;report&gt;</CODE> для статей длиннее &lt;article&gt;,</LI>
<LI><CODE>&lt;book&gt;</CODE> для написания большой книги - руководство по KDevelop использует этот тип,</LI>
<LI><CODE>&lt;slides&gt;</CODE> для слайд-шоу. Это полезно для презентаций. Предполагается использование LaTeX в качестве конечного формата в большинстве случаев,</LI>
<LI><CODE>&lt;letter&gt;</CODE> для обычных писем,</LI>
<LI><CODE>&lt;telefax&gt;</CODE> для факсов,</LI>
<LI><CODE>&lt;manpage&gt;</CODE> для статьи man.</LI>
</UL>
<P>Имейте в виду, что эти типы описывают только общую организацию структуры документа, а не конкретный вид выходных документов. Как упоминалось,
KDevelop по умолчанию генерирует шаблон, используя структуру &lt;article&gt;. Это используется большинством приложений, исключая сам KDevelop, который использует тип
&lt;book&gt;. В HTML формате это не имеет серьезного значения - но для LaTeX, например, это важно.
Руководство - это настоящая "книга" с отдельными страницами для каждой главы (главное отличие).
<P>Конец sgml файла должен содержать завершающий таг для структуры документа - для &lt;article&gt; это будет 
&lt;/article&gt;.
<P>
<H4>Титульная страница</H4>

<P>После тага структуры документа идет секция, описывающая основные пункты, располагаемые на титульной странице. Шаблон
не использует их все, но заполняет информацию для тагов <CODE>&lt;title&gt;</CODE>, <CODE>&lt;author&gt;</CODE> и <CODE>&lt;date&gt;</CODE>, чего обычно достаточно.
При использовании структуры <CODE>&lt;book&gt;</CODE> вы, вероятно, захотите определить все таги титульной страницы.
Следующий пример показывает использование этих тагов, он взят из sgml исходника этой книги:
<P>
<HR>
<PRE>
&lt;!doctype linuxdoc system&gt;
&lt;book&gt;
&lt;titlepag&gt;
&lt;title&gt;The KDevelop Programming Handbook
&lt;subtitle&gt;The User Guide to C++ Application Design for the K Desktop Environment (KDE) with the KDevelop IDE, Version 1.0
&lt;author&gt;
&lt;name&gt;Ralf Nolden &lt;htmlurl url="mailto:Ralf.Nolden@post.rwth-aachen.de"
                                   name = "&lt;Ralf.Nolden@post.rwth-aachen.de&gt;"&gt;
&lt;inst&gt;The KDevelop Team
&lt;date&gt;Version 2.1 , July 7, 1999
&lt;abstract&gt;
This handbook itself is part of the KDevelop Integrated Development Environment
and is therefore also licensed under the GNU General Public License;
see &lt;ref id="Copyright" name="Copyright"&gt; for more information.
&lt;/abstract&gt;
</PRE>
<HR>
<P>Это включает в себя все, что обычно содержит титульная страница. Таг <CODE>&lt;author&gt;</CODE> включает таг <CODE>&lt;thanks&gt;</CODE>, вставляющий
некоторые благодарности соавторам и т.п. <CODE>&lt;inst&gt;</CODE> представляет институт или компанию, для которой автор писал
документацию; вы также можете использовать имя вашей команды, как сделал я. <CODE>&lt;abstract&gt;</CODE> содержит краткое описание, расположенное
на титульной странице. Это несколько неприятно в печатной версии, поэтому там данная секция будет напечатана на обратной стороне титульной страницы
вместе с copyright; это может быть изменено в LaTeX редактированием файла TeX.
<P>
<H4>Индексы</H4>

<P>LinuxDoc DTD определяет набор тагов для построения различных индексов, как это обычно делается в документах. Это:
<P>
<UL>
<LI>&lt;toc&gt; для содержания</LI>
<LI>&lt;lof&gt; для списка рисунков</LI>
<LI>&lt;lot&gt; для списка таблиц</LI>
</UL>
<P>Завершающий таг не требуется в конце; индексы вставляются непосредственно после титульной страницы перед началом
документа с соответствующими разделами или главами.
<P>Для индексации ключевых слов, список которых располагается в конце документа, вам предоставляются 4 различных тага;
два из них оставляют индексированную фразу видимой на странице, а два других не отображают индексные входы:
<P>
<LI>&lt;idx&gt; для элемента обычного индекса,</LI>
<LI>&lt;cdx&gt; для true-type элемента индекса,</LI>
<LI>&lt;nidx&gt; для индексного входа, не отображаемого на странице,</LI>
<LI>&lt;ncdx&gt; аналогично для tt-индекса</LI>
<P>Эти таги игнорируются всеми конечными форматами, кроме
<CODE>sgml2latex</CODE>, который генерирует индексный файл <CODE>index.idx</CODE>, который преобразуется в TeX-индекс командой <CODE>makeindex index.idx</CODE>.
Сам индекс может быть вставлен в TeX файл с помощью <CODE>\printindex</CODE>.
Я написал скрипт, автоматизирующий вставку
индекса в LaTeX (но до сих пор не знаю, как включить индекс в содержание...).
<P>
<H4>Содержание документа</H4>

<P>Сейчас, после объяснения большинства деталей основной структуры, мы переходим к рассмотрению текста документа. В зависимости от 
типа структуры документа, он начинается либо с тага <CODE>&lt;sect&gt;</CODE>, либо, при использовании <CODE>&lt;book&gt;</CODE>, с тага <CODE>&lt;chapt&gt;</CODE>
для глав.
<P>После стартового тага, вы можете структурировать каждую главу с помощью <CODE>&lt;sect1&gt;</CODE>, <CODE>&lt;sect2&gt;</CODE> и т.п. до максимального
уровня вложенности (4).
<P>После стартового тага главы следует ее заголовок. Здесь вы можете использовать <CODE>&lt;title&gt;</CODE> 
и <CODE>&lt;</CODE>title&gt;/ для заголовков глав (при необходимости). После заголовка главы вы должны добавить таг &lt;p&gt;,
чтобы обозначить начало текста главы. В тексте вы имеете возможность использовать списки, перечисления,
списки определений (description lists) и т.п. Далее, цитаты и фрагменты кода также могут быть вставлены с помощью тагов, см. 
документацию по <CODE>sgmltools</CODE> для получения полного перечня тагов. Также в ней посмотрите раздел о добавлении специальных символов.
В нем перечислены все доступные неалфавитные символ, например, знак торговой марки.
С помощью этих тагов вы сможете структурировать документацию так, как это требуется для вашего приложения.
<P>
<H3><A NAME="ss9.4">9.4 Как вызывать помощь в диалоговых окнах</A>
</H3>

<P>
<!--
help functions
-->

Вызов помощи в диалогах часто реализуется с помощью кнопки Помощь (Help); после этого вы добавляете слот, выполняемый по нажатию этой кнопки.
В коде этого слота вы должны вызвать:
<P>
<BLOCKQUOTE><CODE>
<PRE>
kapp->invokeHTMLHelp( QString aFilename, QString aTopic );
</PRE>
</CODE></BLOCKQUOTE>
<P>где <CODE>aFilename</CODE> - имя файла в каталоге с HTML-документацией вашего приложения; например, index-3.html.
<CODE>aTopic</CODE> - заголовок, который должен быть вызван. Хеш-префикс "#" добавляется автоматически; введите главу,
к которой вы хотите обратиться, хотя это может быть и заголовок более низкого уровня.
<P>
<P ALIGN="RIGHT">

<A HREF="index-10.html">Next</A>
 <A HREF="index-8.html">Previous</A>
 <A HREF="index.html#toc9">Table of Contents</A>
</P>
<CENTER>
<HR WIDTH="100%" SIZE=3 ALIGN=CENTER NOSHADE>
</CENTER>    
</FONT>

 
</BODY>
</HTML>

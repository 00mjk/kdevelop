<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.7">
 <TITLE>Учебники по cозданию приложений для KDE: Сборка примеров Qt</TITLE>
 <LINK HREF="index-4.html" REL=next>
 <LINK HREF="index-2.html" REL=previous>
 <LINK HREF="index.html#toc3" REL=contents>
</HEAD>
<BODY>
<A HREF="index-4.html">Next</A>
<A HREF="index-2.html">Previous</A>
<A HREF="index.html#toc3">Contents</A>
<HR>
<H2><A NAME="s3">3. Сборка примеров Qt</A></H2>

<P>
<H2><A NAME="ss3.1">3.1 Шаг первый: Hello World!</A>
</H2>

<P>В предыдущей главе мы создали проект под названием <CODE>MyWidget</CODE> - теперь,
глядя на первую страницу учебника по библиотеке Qt, вы можете заметить,
что первое приложение использует только функцию <CODE>main()</CODE>. Поэтому мы
изменим только имеющуюся функцию <CODE>main()</CODE> нашего проекта для создания и
запуска первого шага учебника.
<P>Для доступа к функции <CODE>main()</CODE> выберите в просмотрщике классов ветку
"Глобальное", которая содержит подветку "Функции", где перечислены функции,
не являющиеся методами классов. Это приведет к открытию файла <CODE>main.cpp</CODE>
в окне "Файлы C/C++" и курсор будет установлен на первой строчке функции
<CODE>main()</CODE>.
<P>
<H3>Что изменять первым</H3>

<P>Мы можем начать изменять исходный текст, чтобы привести его к виду из 
учебника по Qt, но можно поступить проще. Отметьте содержимое функции
<CODE>main()</CODE> с помощью мышки или нажимая стрелку вниз одновременно удерживая
Shift. Затем выберите пункт "Вырезать" из меню "Редактирование" или
нажмите кнопку DEL для удаления отмеченного куска текста. Таким образом
мы удалим содержимое функции и сможем начать создавать наше учебное
приложение с нуля.
<P>
<H3>Ввод исходного текста примера</H3>

<P>Теперь, для того чтобы ввести исходный текст из учебника, вы сначала
можете внимательно его прочитать и постараться запомнить какая строка
содержит какой текст. Затем, после прочтения в учебники описания каждой
строки, вы можете использовать его в качестве пособия при написании
собственного примера.
<P>Для желающих пойти более простым путем: отметьте содержимое приведенной
функции <CODE>main()</CODE> в просмотрщике документации и нажмите кнопку "Копировать"
на панели инструментов. Также вы можете использовать контекстное меню или
соответствующий пункт в меню "Редактирование". Это приведет к копированию
отмеченного текста в буфер обмена, который, после переключения обратно в окно 
редактирования исходного текста, может быть выставлен с помощью кнопки или
пунктов контекстного или основного меню "Вставить".
<P>Наконец, вставьте следующие файлы заголовков перед функцией <CODE>main()</CODE>:
<P>
<BLOCKQUOTE><CODE>
<PRE>
#include &lt;qapplication.h>
#include &lt;qpushbutton.h>
</PRE>
</CODE></BLOCKQUOTE>
<P>Вот и все ! Мы получили исходный текст вашего первого учебного приложения.
<P>
<H3>Сборка Hello World!</H3>

<P>Для сборки вашего первого учебного приложения выберите пункт "Создать" в
меню "Собрать" или нажмите соответствующую кнопку на панели инструментов.
Также вы можете выбрать пункт "Исполнить", в результате чего произойдет
запуск приложения после его успешной сборки.
<P>Если сборка прервана из-за ошибки, будте уверены - это ошибка программиста,
а не учебника ! Конечно печально начинать программирование под KDE/Qt с
поисков ошибки, но таким образом вы сможете потренироваться в использовании
KDevelop. Для того, чтобы найти ошибку, вы можете выбрать два пути: или,
шелкнув на сообщении об ошибке в окне вывода, оказаться на той строчке, где эта
ошибка произошла, или нажать клавишу F4; также вы можете использовать пункт
"Следующая ошибка" меню "Вид".
<P>
<H3>Упражнения</H3>

<P>Вы можете спросить - "Упражнения ? Да этот пример настолько прост, что
мне не нужны никакие упражнения !", но будте уверены, все еще успеет
усложниться. Это был простейший пример, но чем сложнее они будут становиться,
тем больше придется думать, чтобы понять и следовать шагам учебника.
Упражнения также помогут вам освоиться с KDevelop и его возможностями.
<P>В качестве упражнения с первым учебным примером, попробуйте внести
следующие изменения в приведенный исходный текст и посмотреть, как
это повлияет на поведение приложения:
<P>
<OL>
<LI>замените pushbutton на QLabel.</LI>
<LI>используйте <CODE>setText()</CODE> вместо непосредственного указания текста в конструкторе pushbutton.</LI>
<LI>используйте <CODE>QPushButton::resize ( const QSize &amp; s )</CODE> вместо установки размеров с помощью непосредственного указания ширины и высоты. Сначала создатейте объект класса <CODE>QSize</CODE>, содержащий эти размеры.</LI>
<LI>поизменяйте размеры, чтобы разобраться какой параметр высота, а какой ширина.</LI>
</OL>
<P>
<H2><A NAME="ss3.2">3.2 Шаги 2 и 3: Расширения</A>
</H2>

<P>Шаги учебника 2 и 3 расширяют возможности первого учебного примера. Здесь
вы узнаете о слотах и сигналах, а также о зависимости родитель-потомок
между визуальными элементами.
<P>И почему же так важно знать об этом? Потому, что механизм слотов и сигналов
является отличительной чертой библиотеки Qt от любых других библиотек
визуальных элементов. Когда у вас возникает проблема в реализации механизма
коммуникации между объектами, ничто не сделает вашу работу столь короткой,
как механизм слотов и сигналов. Даже ошибочные связи не приведут к выходу
по ошибке сегментации(segmentation fault). Этот механизм является сильной
стороной библиотеки QT, и поэтому множество разработчиков KDE/QT приложений
не хотят от него отказываться из-за его гибкости. Понимание функционирования
этого механизма необходимо для создания любого KDE/Qt приложения.
<P>Также необходимо обратить внимание на то, что кнопка, которая вызывает уничтожение
объекта <CODE>QApplication</CODE>, вызывает функцию <CODE>quit()</CODE>. Далее мы встретимся
с функцией <CODE>quit()</CODE>, когда будем работать с аналогом <CODE>QApplication</CODE> в
KDE - <CODE>KApplication</CODE>.
<P>
<H2><A NAME="ss3.3">3.3 Создание ваших собственных визуальных элементов</A>
</H2>

<P>Теперь, после успешного изменения и усложнения функции <CODE>main()</CODE>, можно
переходить к созданию нового собственного визуального элемента -
уникального визуального элемента, который может быть создан только
конструктором класса, который мы разработаем на шаге 4. На самом деле
класс уже создан мастером приложений, поэтому осталось добавить совсем
чуть-чуть - добавить исходные тексты из урока 4,находящиеся в файле
<CODE>main.cpp</CODE>, в файлы описания и определения класса <CODE>MyWidget</CODE>.
К счастью, нам надо всего лишь внести изменения в конструктор класса.
<P>Выберите конструктор класса в окне просмотрщика классов и попадете на
строку с его описанием. Сюда и надо будет добавлять исходные тексты.
<P>Здесь вам надо будет проследить за подключением файла заголовков <CODE>qfont.h</CODE>,
<CODE>QFont</CODE> используется только в конструкторе класса <CODE>MyWidget</CODE>. Поэтому
добавьте строку <CODE>#include &lt;qfont.h&gt;</CODE> в начало файла <CODE>mywidget.cpp</CODE>.
<P>Для запуска нового приложения нажмите кнопку "Исполнить". В результате произойдет
компиляция измененных файлов после их автоматической записи.
<P>
<H2><A NAME="ss3.4">3.4 Расширение класса Widget</A>
</H2>

<P>Теперь, в уроке 5 нашей целью будет расширение возможностей класса. Также вы
узнаете о виртуальных функциях. Здесь переписывается метод <CODE>resizeEvent()</CODE>.
Главное, что необходимо запомнить здесь (помимо расширения возможностей класса),
это то, что Qt работает с пользовательскими событиями посредством виртуальных
функций, которые принимают событие в качестве параметра. Поэтому вы должны
ознакомиться со следующими классами библиотеки Qt:
<P>
<UL>
<LI>QEvent</LI>
<LI>QChildEvent</LI>
<LI>QCloseEvent</LI>
<LI>QFocusEvent</LI>
<LI>QKeyEvent</LI>
<LI>QMouseEvent</LI>
<LI>QMoveEvent</LI>
<LI>QPaintEvent</LI>
<LI>QResizeEvent</LI>
<LI>QTimerEvent</LI>
</UL>
<P>Когда вы будете разрабатывать собственные визуальные элементы, особенно
окна вывода приложений, вам придется переписывать методы обработки событий,
наследуемые классами визуальных элементов по-умолчанию, заменяя обработку
тех событий, которые вам нужно перехватить. Это может быть, например,
<P><CODE>virtual void mousePressEvent ( QMouseEvent * )</CODE> для обработки
сигналов от мышки для вывода контекстного меню. При создании собственного
обработчика, вам необходимо будет вставить формальный параметр в описание
функции, большинство разработчиков используют <CODE>event</CODE> или <CODE>e</CODE> в
качестве имени параметра.
<P>Теперь вы сможете обрабатывать параметры события. Для <CODE>QMouseEvent</CODE>
вам надо будет выяснить какая из кнопок, правая, средняя или левая,
породила событие.
<P>
<H2><A NAME="ss3.5">3.5 Добавление нового класса</A>
</H2>

<P>В уроке номер 6 вам предстоит добавить класс в ваше учебное приложение. Теперь
вы наверное думаете - "Вот сейчас создам файлы определения и описания - и все",
но KDevelop предоставляет вам более простой способ. Когда вы создаете класс, вы
всегда должны использовать Создатель Классов. Он возьмет все вышеописанные
обязанности на себя, а вам останется лишь добавить необходимые тексты.
<P>Для того, чтобы добавить класс с помощью Создателя Классов, выберите пункт
"Новый Класс" в меню "Проекты", в результате появится диалоговое окно, поля
которого надо будет заполнить необходимыми значениями. Сначала введем имя класса.
В учебнике фигурирует имя <CODE>LCDRange</CODE>. Затем укажем базовый класс.
Свойства нового класса будут унаследованы от базового класса. В учебнике
(по Qt 1.42) таковым является <CODE>QWidget</CODE>. Т.к. большинство добавляемых
классов наследуются от QWidget, то мы можем не заполнять это поле, а просто
пометить кнопочку "потомок класса QWidget" в секции "Дополнительные
параметры". Это приведет к автоматическому добавлению макроса <CODE>Q_OBJECT</CODE>
в файл определения для добавления слотов и сигналов в дальнейшем (это
понадобиться в главе 7).
<P>Т.к. имена файлов подставляются автоматически, вам не нужно об этом
беспокоиться. Единственное, что мы можем посоветовать добавить - это
документация. Всегда считалось хорошим стилем прилагать подробное
описание к классу, особенно когда, например, имя класса <CODE>LCDRange</CODE>
не наводит на мысли о его предназначении.
<P>
<H2><A NAME="ss3.6">3.6 Шаги 7-14</A>
</H2>

<P>Теперь вы все знаете и готовы к остальным шагам учебника. Вам всего
лишь нужно добавлять необходимые классы и вносить соответствующие изменения.
<P>После каждого изменения вам нужно заново пересобрать проект и посмотреть,
нет ли в нем ошибок. Запустите приложение и проследите за его выполнением;
дополнительно, вы можете поизменять опции KDevelop в меню "Собрать" -
выполнить приложение с аргументом командной строки, таким как '--geometry',
и отладить его с помощью Отладчика в окне Инструментов. После этого вы будете
в состоянии продолжать работу с примерами библиотеки Qt, которые будут
обсуждаться в следующей главе.
<P>
<P>
<HR>
<A HREF="index-4.html">Next</A>
<A HREF="index-2.html">Previous</A>
<A HREF="index.html#toc3">Contents</A>
</BODY>
</HTML>

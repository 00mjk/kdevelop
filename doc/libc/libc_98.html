<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.51
     from libc.texinfo on 28 March 2001 -->

<TITLE>The GNU C Library - Setting the Locale</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_97.html">previous</A>, <A HREF="libc_99.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
<P><HR><P>


<H2><A NAME="SEC102" HREF="libc_toc.html#TOC102">How Programs Set the Locale</A></H2>

<P>
A C program inherits its locale environment variables when it starts up.
This happens automatically.  However, these variables do not
automatically control the locale used by the library functions, because
ISO C says that all programs start by default in the standard <SAMP>`C'</SAMP>
locale.  To use the locales specified by the environment, you must call
<CODE>setlocale</CODE>.  Call it as follows:

</P>

<PRE>
setlocale (LC_ALL, "");
</PRE>

<P>
to select a locale based on the user choice of the appropriate
environment variables.

</P>
<P>
<A NAME="IDX591"></A>
<A NAME="IDX592"></A>
You can also use <CODE>setlocale</CODE> to specify a particular locale, for
general use or for a specific category.

</P>
<P>
<A NAME="IDX593"></A>
The symbols in this section are defined in the header file <TT>`locale.h'</TT>.

</P>
<P>
<DL>
<DT><U>Function:</U> char * <B>setlocale</B> <I>(int <VAR>category</VAR>, const char *<VAR>locale</VAR>)</I>
<DD><A NAME="IDX594"></A>
The function <CODE>setlocale</CODE> sets the current locale for
category <VAR>category</VAR> to <VAR>locale</VAR>.

</P>
<P>
If <VAR>category</VAR> is <CODE>LC_ALL</CODE>, this specifies the locale for all
purposes.  The other possible values of <VAR>category</VAR> specify an
individual purpose (see section <A HREF="libc_97.html#SEC101">Categories of Activities that Locales Affect</A>).

</P>
<P>
You can also use this function to find out the current locale by passing
a null pointer as the <VAR>locale</VAR> argument.  In this case,
<CODE>setlocale</CODE> returns a string that is the name of the locale
currently selected for category <VAR>category</VAR>.

</P>
<P>
The string returned by <CODE>setlocale</CODE> can be overwritten by subsequent
calls, so you should make a copy of the string (see section <A HREF="libc_67.html#SEC67">Copying and Concatenation</A>) if you want to save it past any further calls to
<CODE>setlocale</CODE>.  (The standard library is guaranteed never to call
<CODE>setlocale</CODE> itself.)

</P>
<P>
You should not modify the string returned by <CODE>setlocale</CODE>.
It might be the same string that was passed as an argument in a
previous call to <CODE>setlocale</CODE>.

</P>
<P>
When you read the current locale for category <CODE>LC_ALL</CODE>, the value
encodes the entire combination of selected locales for all categories.
In this case, the value is not just a single locale name.  In fact, we
don't make any promises about what it looks like.  But if you specify
the same "locale name" with <CODE>LC_ALL</CODE> in a subsequent call to
<CODE>setlocale</CODE>, it restores the same combination of locale selections.

</P>
<P>
To ensure to be able to use the string encoding the currently selected
locale at a later time one has to make a copy of the string.  It is not
guaranteed that the return value stays valid all the time.

</P>
<P>
When the <VAR>locale</VAR> argument is not a null pointer, the string returned
by <CODE>setlocale</CODE> reflects the newly modified locale.

</P>
<P>
If you specify an empty string for <VAR>locale</VAR>, this means to read the
appropriate environment variable and use its value to select the locale
for <VAR>category</VAR>.

</P>
<P>
If a nonempty string is given for <VAR>locale</VAR> the locale with this name
is used, if this is possible.

</P>
<P>
If you specify an invalid locale name, <CODE>setlocale</CODE> returns a null
pointer and leaves the current locale unchanged.
</DL>

</P>
<P>
Here is an example showing how you might use <CODE>setlocale</CODE> to
temporarily switch to a new locale.

</P>

<PRE>
#include &#60;stddef.h&#62;
#include &#60;locale.h&#62;
#include &#60;stdlib.h&#62;
#include &#60;string.h&#62;

void
with_other_locale (char *new_locale,
                   void (*subroutine) (int),
                   int argument)
{
  char *old_locale, *saved_locale;

  /* Get the name of the current locale.  */
  old_locale = setlocale (LC_ALL, NULL);

  /* Copy the name so it won't be clobbered by <CODE>setlocale</CODE>. */
  saved_locale = strdup (old_locale);
  if (saved_locale == NULL)
    fatal ("Out of memory");

  /* Now change the locale and do some stuff with it. */
  setlocale (LC_ALL, new_locale);
  (*subroutine) (argument);

  /* Restore the original locale. */
  setlocale (LC_ALL, saved_locale);
  free (saved_locale);
}
</PRE>

<P>
<STRONG>Portability Note:</STRONG> Some ISO C systems may define additional
locale categories and future versions of the library will do so.  For
portability, assume that any symbol beginning with <SAMP>`LC_'</SAMP> might be
defined in <TT>`locale.h'</TT>.

</P>
<P><HR><P>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_97.html">previous</A>, <A HREF="libc_99.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
</BODY>
</HTML>

<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.51
     from libc.texinfo on 28 March 2001 -->

<TITLE>The GNU C Library - Listening</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_308.html">previous</A>, <A HREF="libc_310.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
<P><HR><P>


<H3><A NAME="SEC316" HREF="libc_toc.html#TOC316">Listening for Connections</A></H3>
<P>
<A NAME="IDX1550"></A>
<A NAME="IDX1551"></A>
<A NAME="IDX1552"></A>

</P>
<P>
Now let us consider what the server process must do to accept
connections on a socket.  First it must use the <CODE>listen</CODE> function
to enable connection requests on the socket, and then accept each
incoming connection with a call to <CODE>accept</CODE> (see section <A HREF="libc_310.html#SEC317">Accepting Connections</A>).  Once connection requests are enabled on a server socket,
the <CODE>select</CODE> function reports when the socket has a connection
ready to be accepted (see section <A HREF="libc_225.html#SEC232">Waiting for Input or Output</A>).

</P>
<P>
The <CODE>listen</CODE> function is not allowed for sockets using
connectionless communication styles.

</P>
<P>
You can write a network server that does not even start running until a
connection to it is requested.  See section <A HREF="libc_325.html#SEC332"><CODE>inetd</CODE> Servers</A>.

</P>
<P>
In the Internet namespace, there are no special protection mechanisms
for controlling access to connect to a port; any process on any machine
can make a connection to your server.  If you want to restrict access to
your server, make it examine the addresses associated with connection
requests or implement some other handshaking or identification
protocol.

</P>
<P>
In the local namespace, the ordinary file protection bits control who has
access to connect to the socket.

</P>
<P>
<DL>
<DT><U>Function:</U> int <B>listen</B> <I>(int <VAR>socket</VAR>, unsigned int <VAR>n</VAR>)</I>
<DD><A NAME="IDX1553"></A>
The <CODE>listen</CODE> function enables the socket <VAR>socket</VAR> to accept
connections, thus making it a server socket.

</P>
<P>
The argument <VAR>n</VAR> specifies the length of the queue for pending
connections.  When the queue fills, new clients attempting to connect
fail with <CODE>ECONNREFUSED</CODE> until the server calls <CODE>accept</CODE> to
accept a connection from the queue.

</P>
<P>
The <CODE>listen</CODE> function returns <CODE>0</CODE> on success and <CODE>-1</CODE>
on failure.  The following <CODE>errno</CODE> error conditions are defined
for this function:

</P>
<DL COMPACT>

<DT><CODE>EBADF</CODE>
<DD>
The argument <VAR>socket</VAR> is not a valid file descriptor.

<DT><CODE>ENOTSOCK</CODE>
<DD>
The argument <VAR>socket</VAR> is not a socket.

<DT><CODE>EOPNOTSUPP</CODE>
<DD>
The socket <VAR>socket</VAR> does not support this operation.
</DL>
</DL>

<P><HR><P>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_308.html">previous</A>, <A HREF="libc_310.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
</BODY>
</HTML>

<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.51
     from libc.texinfo on 28 March 2001 -->

<TITLE>The GNU C Library - Freeing after Malloc</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_24.html">previous</A>, <A HREF="libc_26.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
<P><HR><P>


<H3><A NAME="SEC25" HREF="libc_toc.html#TOC25">Freeing Memory Allocated with <CODE>malloc</CODE></A></H3>
<P>
<A NAME="IDX220"></A>
<A NAME="IDX221"></A>

</P>
<P>
When you no longer need a block that you got with <CODE>malloc</CODE>, use the
function <CODE>free</CODE> to make the block available to be allocated again.
The prototype for this function is in <TT>`stdlib.h'</TT>.
<A NAME="IDX222"></A>

</P>
<P>
<DL>
<DT><U>Function:</U> void <B>free</B> <I>(void *<VAR>ptr</VAR>)</I>
<DD><A NAME="IDX223"></A>
The <CODE>free</CODE> function deallocates the block of storage pointed at
by <VAR>ptr</VAR>.
</DL>

</P>
<P>
<DL>
<DT><U>Function:</U> void <B>cfree</B> <I>(void *<VAR>ptr</VAR>)</I>
<DD><A NAME="IDX224"></A>
This function does the same thing as <CODE>free</CODE>.  It's provided for
backward compatibility with SunOS; you should use <CODE>free</CODE> instead.
</DL>

</P>
<P>
Freeing a block alters the contents of the block.  <STRONG>Do not expect to
find any data (such as a pointer to the next block in a chain of blocks) in
the block after freeing it.</STRONG>  Copy whatever you need out of the block before
freeing it!  Here is an example of the proper way to free all the blocks in
a chain, and the strings that they point to:

</P>

<PRE>
struct chain
  {
    struct chain *next;
    char *name;
  }

void
free_chain (struct chain *chain)
{
  while (chain != 0)
    {
      struct chain *next = chain-&#62;next;
      free (chain-&#62;name);
      free (chain);
      chain = next;
    }
}
</PRE>

<P>
Occasionally, <CODE>free</CODE> can actually return memory to the operating
system and make the process smaller.  Usually, all it can do is allow a
later call to <CODE>malloc</CODE> to reuse the space.  In the meantime, the
space remains in your program as part of a free-list used internally by
<CODE>malloc</CODE>.

</P>
<P>
There is no point in freeing blocks at the end of a program, because all
of the program's space is given back to the system when the process
terminates.

</P>
<P><HR><P>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_24.html">previous</A>, <A HREF="libc_26.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
</BODY>
</HTML>

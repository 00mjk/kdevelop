<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.51
     from libc.texinfo on 28 March 2001 -->

<TITLE>The GNU C Library - Working Directory</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_244.html">previous</A>, <A HREF="libc_246.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
<P><HR><P>


<H2><A NAME="SEC252" HREF="libc_toc.html#TOC252">Working Directory</A></H2>

<P>
<A NAME="IDX1166"></A>
<A NAME="IDX1167"></A>
<A NAME="IDX1168"></A>
Each process has associated with it a directory, called its <STRONG>current
working directory</STRONG> or simply <STRONG>working directory</STRONG>, that is used in
the resolution of relative file names (see section <A HREF="libc_152.html#SEC159">File Name Resolution</A>).

</P>
<P>
When you log in and begin a new session, your working directory is
initially set to the home directory associated with your login account
in the system user database.  You can find any user's home directory
using the <CODE>getpwuid</CODE> or <CODE>getpwnam</CODE> functions; see section <A HREF="libc_568.html#SEC576">User Database</A>.

</P>
<P>
Users can change the working directory using shell commands like
<CODE>cd</CODE>.  The functions described in this section are the primitives
used by those commands and by other programs for examining and changing
the working directory.
<A NAME="IDX1169"></A>

</P>
<P>
Prototypes for these functions are declared in the header file
<TT>`unistd.h'</TT>.
<A NAME="IDX1170"></A>

</P>
<P>
<DL>
<DT><U>Function:</U> char * <B>getcwd</B> <I>(char *<VAR>buffer</VAR>, size_t <VAR>size</VAR>)</I>
<DD><A NAME="IDX1171"></A>
The <CODE>getcwd</CODE> function returns an absolute file name representing
the current working directory, storing it in the character array
<VAR>buffer</VAR> that you provide.  The <VAR>size</VAR> argument is how you tell
the system the allocation size of <VAR>buffer</VAR>.

</P>
<P>
The GNU library version of this function also permits you to specify a
null pointer for the <VAR>buffer</VAR> argument.  Then <CODE>getcwd</CODE>
allocates a buffer automatically, as with <CODE>malloc</CODE>
(see section <A HREF="libc_22.html#SEC22">Unconstrained Allocation</A>).  If the <VAR>size</VAR> is greater than
zero, then the buffer is that large; otherwise, the buffer is as large
as necessary to hold the result.

</P>
<P>
The return value is <VAR>buffer</VAR> on success and a null pointer on failure.
The following <CODE>errno</CODE> error conditions are defined for this function:

</P>
<DL COMPACT>

<DT><CODE>EINVAL</CODE>
<DD>
The <VAR>size</VAR> argument is zero and <VAR>buffer</VAR> is not a null pointer.

<DT><CODE>ERANGE</CODE>
<DD>
The <VAR>size</VAR> argument is less than the length of the working directory
name.  You need to allocate a bigger array and try again.

<DT><CODE>EACCES</CODE>
<DD>
Permission to read or search a component of the file name was denied.
</DL>
</DL>

<P>
You could implement the behavior of GNU's <CODE>getcwd (NULL, 0)</CODE>
using only the standard behavior of <CODE>getcwd</CODE>:

</P>

<PRE>
char *
gnu_getcwd ()
{
  int size = 100;
  char *buffer = (char *) xmalloc (size);

  while (1)
    {
      char *value = getcwd (buffer, size);
      if (value != 0)
        return buffer;
      size *= 2;
      free (buffer);
      buffer = (char *) xmalloc (size);
    }
}
</PRE>

<P>
See section <A HREF="libc_24.html#SEC24">Examples of <CODE>malloc</CODE></A>, for information about <CODE>xmalloc</CODE>, which is
not a library function but is a customary name used in most GNU
software.

</P>
<P>
<DL>
<DT><U>Function:</U> char * <B>getwd</B> <I>(char *<VAR>buffer</VAR>)</I>
<DD><A NAME="IDX1172"></A>
This is similar to <CODE>getcwd</CODE>, but has no way to specify the size of
the buffer.  The GNU library provides <CODE>getwd</CODE> only
for backwards compatibility with BSD.

</P>
<P>
The <VAR>buffer</VAR> argument should be a pointer to an array at least
<CODE>PATH_MAX</CODE> bytes long (see section <A HREF="libc_595.html#SEC603">Limits on File System Capacity</A>).  In the GNU
system there is no limit to the size of a file name, so this is not
necessarily enough space to contain the directory name.  That is why
this function is deprecated.
</DL>

</P>
<P>
<DL>
<DT><U>Function:</U> int <B>chdir</B> <I>(const char *<VAR>filename</VAR>)</I>
<DD><A NAME="IDX1173"></A>
This function is used to set the process's working directory to
<VAR>filename</VAR>.

</P>
<P>
The normal, successful return value from <CODE>chdir</CODE> is <CODE>0</CODE>.  A
value of <CODE>-1</CODE> is returned to indicate an error.  The <CODE>errno</CODE>
error conditions defined for this function are the usual file name
syntax errors (see section <A HREF="libc_153.html#SEC160">File Name Errors</A>), plus <CODE>ENOTDIR</CODE> if the
file <VAR>filename</VAR> is not a directory.
</DL>

</P>

<P><HR><P>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_244.html">previous</A>, <A HREF="libc_246.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
</BODY>
</HTML>

<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.51
     from libc.texinfo on 28 March 2001 -->

<TITLE>The GNU C Library - Basic Thread Operations</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_602.html">previous</A>, <A HREF="libc_604.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
<P><HR><P>


<H2><A NAME="SEC611" HREF="libc_toc.html#TOC611">Basic Thread Operations</A></H2>

<P>
These functions are the thread equivalents of <CODE>fork</CODE>, <CODE>exit</CODE>,
and <CODE>wait</CODE>.

</P>
<P>
<DL>
<DT><U>Function:</U> int <B>pthread_create</B> <I>(pthread_t * <VAR>thread</VAR>, pthread_attr_t * <VAR>attr</VAR>, void * (*<VAR>start_routine</VAR>)(void *), void * <VAR>arg</VAR>)</I>
<DD><A NAME="IDX3134"></A>
<CODE>pthread_create</CODE> creates a new thread of control that executes
concurrently with the calling thread. The new thread calls the
function <VAR>start_routine</VAR>, passing it <VAR>arg</VAR> as first argument. The
new thread terminates either explicitly, by calling <CODE>pthread_exit</CODE>,
or implicitly, by returning from the <VAR>start_routine</VAR> function. The
latter case is equivalent to calling <CODE>pthread_exit</CODE> with the result
returned by <VAR>start_routine</VAR> as exit code.

</P>
<P>
The <VAR>attr</VAR> argument specifies thread attributes to be applied to the
new thread. See section <A HREF="libc_604.html#SEC612">Thread Attributes</A>, for details. The <VAR>attr</VAR>
argument can also be <CODE>NULL</CODE>, in which case default attributes are
used: the created thread is joinable (not detached) and has an ordinary
(not realtime) scheduling policy.

</P>
<P>
On success, the identifier of the newly created thread is stored in the
location pointed by the <VAR>thread</VAR> argument, and a 0 is returned. On
error, a non-zero error code is returned.

</P>
<P>
This function may return the following errors:
<DL COMPACT>

<DT><CODE>EAGAIN</CODE>
<DD>
Not enough system resources to create a process for the new thread,
or more than <CODE>PTHREAD_THREADS_MAX</CODE> threads are already active.
</DL>
</DL>

<P>
<DL>
<DT><U>Function:</U> void <B>pthread_exit</B> <I>(void *<VAR>retval</VAR>)</I>
<DD><A NAME="IDX3135"></A>
<CODE>pthread_exit</CODE> terminates the execution of the calling thread.  All
cleanup handlers (see section <A HREF="libc_606.html#SEC614">Cleanup Handlers</A>) that have been set for the
calling thread with <CODE>pthread_cleanup_push</CODE> are executed in reverse
order (the most recently pushed handler is executed first). Finalization
functions for thread-specific data are then called for all keys that
have non-<CODE>NULL</CODE> values associated with them in the calling thread
(see section <A HREF="libc_610.html#SEC618">Thread-Specific Data</A>).  Finally, execution of the calling
thread is stopped.

</P>
<P>
The <VAR>retval</VAR> argument is the return value of the thread. It can be
retrieved from another thread using <CODE>pthread_join</CODE>.

</P>
<P>
The <CODE>pthread_exit</CODE> function never returns.
</DL>

</P>
<P>
<DL>
<DT><U>Function:</U> int <B>pthread_cancel</B> <I>(pthread_t <VAR>thread</VAR>)</I>
<DD><A NAME="IDX3136"></A>

</P>
<P>
<CODE>pthread_cancel</CODE> sends a cancellation request to the thread denoted
by the <VAR>thread</VAR> argument.  If there is no such thread,
<CODE>pthread_cancel</CODE> fails and returns <CODE>ESRCH</CODE>.  Otherwise it
returns 0. See section <A HREF="libc_605.html#SEC613">Cancellation</A>, for details.
</DL>

</P>
<P>
<DL>
<DT><U>Function:</U> int <B>pthread_join</B> <I>(pthread_t <VAR>th</VAR>, void **thread_<VAR>return</VAR>)</I>
<DD><A NAME="IDX3137"></A>
<CODE>pthread_join</CODE> suspends the execution of the calling thread until
the thread identified by <VAR>th</VAR> terminates, either by calling
<CODE>pthread_exit</CODE> or by being cancelled.

</P>
<P>
If <VAR>thread_return</VAR> is not <CODE>NULL</CODE>, the return value of <VAR>th</VAR>
is stored in the location pointed to by <VAR>thread_return</VAR>.  The return
value of <VAR>th</VAR> is either the argument it gave to <CODE>pthread_exit</CODE>,
or <CODE>PTHREAD_CANCELED</CODE> if <VAR>th</VAR> was cancelled.

</P>
<P>
The joined thread <CODE>th</CODE> must be in the joinable state: it must not
have been detached using <CODE>pthread_detach</CODE> or the
<CODE>PTHREAD_CREATE_DETACHED</CODE> attribute to <CODE>pthread_create</CODE>.

</P>
<P>
When a joinable thread terminates, its memory resources (thread
descriptor and stack) are not deallocated until another thread performs
<CODE>pthread_join</CODE> on it. Therefore, <CODE>pthread_join</CODE> must be called
once for each joinable thread created to avoid memory leaks.

</P>
<P>
At most one thread can wait for the termination of a given
thread. Calling <CODE>pthread_join</CODE> on a thread <VAR>th</VAR> on which
another thread is already waiting for termination returns an error.

</P>
<P>
<CODE>pthread_join</CODE> is a cancellation point. If a thread is canceled
while suspended in <CODE>pthread_join</CODE>, the thread execution resumes
immediately and the cancellation is executed without waiting for the
<VAR>th</VAR> thread to terminate. If cancellation occurs during
<CODE>pthread_join</CODE>, the <VAR>th</VAR> thread remains not joined.

</P>
<P>
On success, the return value of <VAR>th</VAR> is stored in the location
pointed to by <VAR>thread_return</VAR>, and 0 is returned. On error, one of
the following values is returned:
<DL COMPACT>

<DT><CODE>ESRCH</CODE>
<DD>
No thread could be found corresponding to that specified by <VAR>th</VAR>.
<DT><CODE>EINVAL</CODE>
<DD>
The <VAR>th</VAR> thread has been detached, or another thread is already
waiting on termination of <VAR>th</VAR>.
<DT><CODE>EDEADLK</CODE>
<DD>
The <VAR>th</VAR> argument refers to the calling thread.
</DL>
</DL>

<P><HR><P>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_602.html">previous</A>, <A HREF="libc_604.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
</BODY>
</HTML>

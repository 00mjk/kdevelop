<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.51
     from libc.texinfo on 28 March 2001 -->

<TITLE>The GNU C Library - Logging In and Out</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_566.html">previous</A>, <A HREF="libc_568.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
<P><HR><P>


<H3><A NAME="SEC575" HREF="libc_toc.html#TOC575">Logging In and Out</A></H3>

<P>
These functions, derived from BSD, are available in the separate
<TT>`libutil'</TT> library, and declared in <TT>`utmp.h'</TT>.
<A NAME="IDX2986"></A>

</P>
<P>
Note that the <CODE>ut_user</CODE> member of <CODE>struct utmp</CODE> is called
<CODE>ut_name</CODE> in BSD.  Therefore, <CODE>ut_name</CODE> is defined as an alias
for <CODE>ut_user</CODE> in <TT>`utmp.h'</TT>.

</P>
<P>
<DL>
<DT><U>Function:</U> int <B>login_tty</B> <I>(int <VAR>filedes</VAR>)</I>
<DD><A NAME="IDX2987"></A>
This function makes <VAR>filedes</VAR> the controlling terminal of the
current process, redirects standard input, standard output and
standard error output to this terminal, and closes <VAR>filedes</VAR>.

</P>
<P>
This function returns <CODE>0</CODE> on successful completion, and <CODE>-1</CODE>
on error.
</DL>

</P>
<P>
<DL>
<DT><U>Function:</U> void <B>login</B> <I>(const struct utmp *<VAR>entry</VAR>)</I>
<DD><A NAME="IDX2988"></A>
The <CODE>login</CODE> functions inserts an entry into the user accounting
database.  The <CODE>ut_line</CODE> member is set to the name of the terminal
on standard input.  If standard input is not a terminal <CODE>login</CODE>
uses standard output or standard error output to determine the name of
the terminal.  If <CODE>struct utmp</CODE> has a <CODE>ut_type</CODE> member,
<CODE>login</CODE> sets it to <CODE>USER_PROCESS</CODE>, and if there is an
<CODE>ut_pid</CODE> member, it will be set to the process ID of the current
process.  The remaining entries are copied from <VAR>entry</VAR>.

</P>
<P>
A copy of the entry is written to the user accounting log file.
</DL>

</P>
<P>
<DL>
<DT><U>Function:</U> int <B>logout</B> <I>(const char *<VAR>ut_line</VAR>)</I>
<DD><A NAME="IDX2989"></A>
This function modifies the user accounting database to indicate that the
user on <VAR>ut_line</VAR> has logged out.

</P>
<P>
The <CODE>logout</CODE> function returns <CODE>1</CODE> if the entry was successfully
written to the database, or <CODE>0</CODE> on error.
</DL>

</P>
<P>
<DL>
<DT><U>Function:</U> void <B>logwtmp</B> <I>(const char *<VAR>ut_line</VAR>, const char *<VAR>ut_name</VAR>, const char *<VAR>ut_host</VAR>)</I>
<DD><A NAME="IDX2990"></A>
The <CODE>logwtmp</CODE> function appends an entry to the user accounting log
file, for the current time and the information provided in the
<VAR>ut_line</VAR>, <VAR>ut_name</VAR> and <VAR>ut_host</VAR> arguments.
</DL>

</P>
<P>
<STRONG>Portability Note:</STRONG> The BSD <CODE>struct utmp</CODE> only has the
<CODE>ut_line</CODE>, <CODE>ut_name</CODE>, <CODE>ut_host</CODE> and <CODE>ut_time</CODE>
members.  Older systems do not even have the <CODE>ut_host</CODE> member.

</P>

<P><HR><P>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_566.html">previous</A>, <A HREF="libc_568.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
</BODY>
</HTML>

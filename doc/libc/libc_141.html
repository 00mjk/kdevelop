<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.51
     from libc.texinfo on 28 March 2001 -->

<TITLE>The GNU C Library - Calling Wordexp</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_140.html">previous</A>, <A HREF="libc_142.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
<P><HR><P>


<H3><A NAME="SEC148" HREF="libc_toc.html#TOC148">Calling <CODE>wordexp</CODE></A></H3>

<P>
All the functions, constants and data types for word expansion are
declared in the header file <TT>`wordexp.h'</TT>.

</P>
<P>
Word expansion produces a vector of words (strings).  To return this
vector, <CODE>wordexp</CODE> uses a special data type, <CODE>wordexp_t</CODE>, which
is a structure.  You pass <CODE>wordexp</CODE> the address of the structure,
and it fills in the structure's fields to tell you about the results.

</P>
<P>
<DL>
<DT><U>Data Type:</U> <B>wordexp_t</B>
<DD><A NAME="IDX746"></A>
This data type holds a pointer to a word vector.  More precisely, it
records both the address of the word vector and its size.

</P>
<DL COMPACT>

<DT><CODE>we_wordc</CODE>
<DD>
The number of elements in the vector.

<DT><CODE>we_wordv</CODE>
<DD>
The address of the vector.  This field has type <CODE>char **</CODE>.

<DT><CODE>we_offs</CODE>
<DD>
The offset of the first real element of the vector, from its nominal
address in the <CODE>we_wordv</CODE> field.  Unlike the other fields, this
is always an input to <CODE>wordexp</CODE>, rather than an output from it.

If you use a nonzero offset, then that many elements at the beginning of
the vector are left empty.  (The <CODE>wordexp</CODE> function fills them with
null pointers.)

The <CODE>we_offs</CODE> field is meaningful only if you use the
<CODE>WRDE_DOOFFS</CODE> flag.  Otherwise, the offset is always zero
regardless of what is in this field, and the first real element comes at
the beginning of the vector.
</DL>
</DL>

<P>
<DL>
<DT><U>Function:</U> int <B>wordexp</B> <I>(const char *<VAR>words</VAR>, wordexp_t *<VAR>word-vector-ptr</VAR>, int <VAR>flags</VAR>)</I>
<DD><A NAME="IDX747"></A>
Perform word expansion on the string <VAR>words</VAR>, putting the result in
a newly allocated vector, and store the size and address of this vector
into <CODE>*<VAR>word-vector-ptr</VAR></CODE>.  The argument <VAR>flags</VAR> is a
combination of bit flags; see section <A HREF="libc_142.html#SEC149">Flags for Word Expansion</A>, for details of
the flags.

</P>
<P>
You shouldn't use any of the characters <SAMP>`|&#38;;&#60;&#62;'</SAMP> in the string
<VAR>words</VAR> unless they are quoted; likewise for newline.  If you use
these characters unquoted, you will get the <CODE>WRDE_BADCHAR</CODE> error
code.  Don't use parentheses or braces unless they are quoted or part of
a word expansion construct.  If you use quotation characters <SAMP>`'"`'</SAMP>,
they should come in pairs that balance.

</P>
<P>
The results of word expansion are a sequence of words.  The function
<CODE>wordexp</CODE> allocates a string for each resulting word, then
allocates a vector of type <CODE>char **</CODE> to store the addresses of
these strings.  The last element of the vector is a null pointer.
This vector is called the <STRONG>word vector</STRONG>.

</P>
<P>
To return this vector, <CODE>wordexp</CODE> stores both its address and its
length (number of elements, not counting the terminating null pointer)
into <CODE>*<VAR>word-vector-ptr</VAR></CODE>.

</P>
<P>
If <CODE>wordexp</CODE> succeeds, it returns 0.  Otherwise, it returns one
of these error codes:

</P>
<DL COMPACT>

<DT><CODE>WRDE_BADCHAR</CODE>
<DD>
The input string <VAR>words</VAR> contains an unquoted invalid character such
as <SAMP>`|'</SAMP>.

<DT><CODE>WRDE_BADVAL</CODE>
<DD>
The input string refers to an undefined shell variable, and you used the flag
<CODE>WRDE_UNDEF</CODE> to forbid such references.

<DT><CODE>WRDE_CMDSUB</CODE>
<DD>
The input string uses command substitution, and you used the flag
<CODE>WRDE_NOCMD</CODE> to forbid command substitution.

<DT><CODE>WRDE_NOSPACE</CODE>
<DD>
It was impossible to allocate memory to hold the result.  In this case,
<CODE>wordexp</CODE> can store part of the results--as much as it could
allocate room for.

<DT><CODE>WRDE_SYNTAX</CODE>
<DD>
There was a syntax error in the input string.  For example, an unmatched
quoting character is a syntax error.
</DL>
</DL>

<P>
<DL>
<DT><U>Function:</U> void <B>wordfree</B> <I>(wordexp_t *<VAR>word-vector-ptr</VAR>)</I>
<DD><A NAME="IDX748"></A>
Free the storage used for the word-strings and vector that
<CODE>*<VAR>word-vector-ptr</VAR></CODE> points to.  This does not free the
structure <CODE>*<VAR>word-vector-ptr</VAR></CODE> itself--only the other
data it points to.
</DL>

</P>
<P><HR><P>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_140.html">previous</A>, <A HREF="libc_142.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
</BODY>
</HTML>

<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.51
     from libc.texinfo on 28 March 2001 -->

<TITLE>The GNU C Library - Receiving Datagrams</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_320.html">previous</A>, <A HREF="libc_322.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
<P><HR><P>


<H3><A NAME="SEC328" HREF="libc_toc.html#TOC328">Receiving Datagrams</A></H3>
<P>
<A NAME="IDX1577"></A>

</P>
<P>
The <CODE>recvfrom</CODE> function reads a packet from a datagram socket and
also tells you where it was sent from.  This function is declared in
<TT>`sys/socket.h'</TT>.

</P>
<P>
<DL>
<DT><U>Function:</U> int <B>recvfrom</B> <I>(int <VAR>socket</VAR>, void *<VAR>buffer</VAR>, size_t <VAR>size</VAR>, int <VAR>flags</VAR>, struct sockaddr *<VAR>addr</VAR>, socklen_t *<VAR>length-ptr</VAR>)</I>
<DD><A NAME="IDX1578"></A>
The <CODE>recvfrom</CODE> function reads one packet from the socket
<VAR>socket</VAR> into the buffer <VAR>buffer</VAR>.  The <VAR>size</VAR> argument
specifies the maximum number of bytes to be read.

</P>
<P>
If the packet is longer than <VAR>size</VAR> bytes, then you get the first
<VAR>size</VAR> bytes of the packet, and the rest of the packet is lost.
There's no way to read the rest of the packet.  Thus, when you use a
packet protocol, you must always know how long a packet to expect.

</P>
<P>
The <VAR>addr</VAR> and <VAR>length-ptr</VAR> arguments are used to return the
address where the packet came from.  See section <A HREF="libc_281.html#SEC288">Socket Addresses</A>.  For a
socket in the local domain, the address information won't be meaningful,
since you can't read the address of such a socket (see section <A HREF="libc_286.html#SEC293">The Local Namespace</A>).  You can specify a null pointer as the <VAR>addr</VAR> argument
if you are not interested in this information.

</P>
<P>
The <VAR>flags</VAR> are interpreted the same way as for <CODE>recv</CODE>
(see section <A HREF="libc_315.html#SEC322">Socket Data Options</A>).  The return value and error conditions
are also the same as for <CODE>recv</CODE>.

</P>
<P>
This function is defined as a cancelation point in multi-threaded
programs.  So one has to be prepared for this and make sure that
possibly allocated resources (like memory, files descriptors,
semaphores or whatever) are freed even if the thread is canceled.
</DL>

</P>
<P>
You can use plain <CODE>recv</CODE> (see section <A HREF="libc_314.html#SEC321">Receiving Data</A>) instead of
<CODE>recvfrom</CODE> if you know don't need to find out who sent the packet
(either because you know where it should come from or because you
treat all possible senders alike).  Even <CODE>read</CODE> can be used if
you don't want to specify <VAR>flags</VAR> (see section <A HREF="libc_216.html#SEC223">Input and Output Primitives</A>).

</P>

<P><HR><P>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_320.html">previous</A>, <A HREF="libc_322.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
</BODY>
</HTML>

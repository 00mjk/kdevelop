<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.51
     from libc.texinfo on 28 March 2001 -->

<TITLE>The GNU C Library - File Positioning</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_196.html">previous</A>, <A HREF="libc_198.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
<P><HR><P>


<H2><A NAME="SEC204" HREF="libc_toc.html#TOC204">File Positioning</A></H2>
<P>
<A NAME="IDX894"></A>
<A NAME="IDX895"></A>
<A NAME="IDX896"></A>

</P>
<P>
The <STRONG>file position</STRONG> of a stream describes where in the file the
stream is currently reading or writing.  I/O on the stream advances the
file position through the file.  In the GNU system, the file position is
represented as an integer, which counts the number of bytes from the
beginning of the file.  See section <A HREF="libc_149.html#SEC156">File Position</A>.

</P>
<P>
During I/O to an ordinary disk file, you can change the file position
whenever you wish, so as to read or write any portion of the file.  Some
other kinds of files may also permit this.  Files which support changing
the file position are sometimes referred to as <STRONG>random-access</STRONG>
files.

</P>
<P>
You can use the functions in this section to examine or modify the file
position indicator associated with a stream.  The symbols listed below
are declared in the header file <TT>`stdio.h'</TT>.
<A NAME="IDX897"></A>

</P>
<P>
<DL>
<DT><U>Function:</U> long int <B>ftell</B> <I>(FILE *<VAR>stream</VAR>)</I>
<DD><A NAME="IDX898"></A>
This function returns the current file position of the stream
<VAR>stream</VAR>.

</P>
<P>
This function can fail if the stream doesn't support file positioning,
or if the file position can't be represented in a <CODE>long int</CODE>, and
possibly for other reasons as well.  If a failure occurs, a value of
<CODE>-1</CODE> is returned.
</DL>

</P>
<P>
<DL>
<DT><U>Function:</U> off_t <B>ftello</B> <I>(FILE *<VAR>stream</VAR>)</I>
<DD><A NAME="IDX899"></A>
The <CODE>ftello</CODE> function is similar to <CODE>ftell</CODE> only it corrects a
problem which the POSIX type system.  In this type system all file
positions are described using values of type <CODE>off_t</CODE> which is not
necessarily of the same size as <CODE>long int</CODE>.  Therefore using
<CODE>ftell</CODE> can lead to problems if the implementation is written on
top of a POSIX compliant lowlevel I/O implementation.

</P>
<P>
Therefore it is a good idea to prefer <CODE>ftello</CODE> whenever it is
available since its functionality is (if different at all) closer the
underlying definition.

</P>
<P>
If this function fails it return <CODE>(off_t) -1</CODE>.  This can happen due
to missing support for file positioning or internal errors.  Otherwise
the return value is the current file position.

</P>
<P>
The function is an extension defined in the Unix Single Specification
version 2.

</P>
<P>
When the sources are compiled with <CODE>_FILE_OFFSET_BITS == 64</CODE> on a
32 bits system this function is in fact <CODE>ftello64</CODE>.  I.e., the
LFS interface transparently replaces the old interface.
</DL>

</P>
<P>
<DL>
<DT><U>Function:</U> off64_t <B>ftello64</B> <I>(FILE *<VAR>stream</VAR>)</I>
<DD><A NAME="IDX900"></A>
This function is similar to <CODE>ftello</CODE> with the only difference that
the return value is of type <CODE>off64_t</CODE>.  This also requires that the
stream <VAR>stream</VAR> was opened using either <CODE>fopen64</CODE>,
<CODE>freopen64</CODE>, or <CODE>tmpfile64</CODE> since otherwise the underlying
file operations to position the file pointer beyond the @math{2^31}
bytes limit might fail.

</P>
<P>
If the sources are compiled with <CODE>_FILE_OFFSET_BITS == 64</CODE> on a 32
bits machine this function is available under the name <CODE>ftello</CODE>
and so transparently replaces the old interface.
</DL>

</P>
<P>
<DL>
<DT><U>Function:</U> int <B>fseek</B> <I>(FILE *<VAR>stream</VAR>, long int <VAR>offset</VAR>, int <VAR>whence</VAR>)</I>
<DD><A NAME="IDX901"></A>
The <CODE>fseek</CODE> function is used to change the file position of the
stream <VAR>stream</VAR>.  The value of <VAR>whence</VAR> must be one of the
constants <CODE>SEEK_SET</CODE>, <CODE>SEEK_CUR</CODE>, or <CODE>SEEK_END</CODE>, to
indicate whether the <VAR>offset</VAR> is relative to the beginning of the
file, the current file position, or the end of the file, respectively.

</P>
<P>
This function returns a value of zero if the operation was successful,
and a nonzero value to indicate failure.  A successful call also clears
the end-of-file indicator of <VAR>stream</VAR> and discards any characters
that were "pushed back" by the use of <CODE>ungetc</CODE>.

</P>
<P>
<CODE>fseek</CODE> either flushes any buffered output before setting the file
position or else remembers it so it will be written later in its proper
place in the file.
</DL>

</P>
<P>
<DL>
<DT><U>Function:</U> int <B>fseeko</B> <I>(FILE *<VAR>stream</VAR>, off_t <VAR>offset</VAR>, int <VAR>whence</VAR>)</I>
<DD><A NAME="IDX902"></A>
This function is similar to <CODE>fseek</CODE> but it corrects a problem with
<CODE>fseek</CODE> in a system with POSIX types.  Using a value of type
<CODE>long int</CODE> for the offset is not compatible with POSIX.
<CODE>fseeko</CODE> uses the correct type <CODE>off_t</CODE> for the <VAR>offset</VAR>
parameter.

</P>
<P>
For this reason it is a good idea to prefer <CODE>ftello</CODE> whenever it is
available since its functionality is (if different at all) closer the
underlying definition.

</P>
<P>
The functionality and return value is the same as for <CODE>fseek</CODE>.

</P>
<P>
The function is an extension defined in the Unix Single Specification
version 2.

</P>
<P>
When the sources are compiled with <CODE>_FILE_OFFSET_BITS == 64</CODE> on a
32 bits system this function is in fact <CODE>fseeko64</CODE>.  I.e., the
LFS interface transparently replaces the old interface.
</DL>

</P>
<P>
<DL>
<DT><U>Function:</U> int <B>fseeko64</B> <I>(FILE *<VAR>stream</VAR>, off64_t <VAR>offset</VAR>, int <VAR>whence</VAR>)</I>
<DD><A NAME="IDX903"></A>
This function is similar to <CODE>fseeko</CODE> with the only difference that
the <VAR>offset</VAR> parameter is of type <CODE>off64_t</CODE>.  This also
requires that the stream <VAR>stream</VAR> was opened using either
<CODE>fopen64</CODE>, <CODE>freopen64</CODE>, or <CODE>tmpfile64</CODE> since otherwise
the underlying file operations to position the file pointer beyond the
@math{2^31} bytes limit might fail.

</P>
<P>
If the sources are compiled with <CODE>_FILE_OFFSET_BITS == 64</CODE> on a 32
bits machine this function is available under the name <CODE>fseeko</CODE>
and so transparently replaces the old interface.
</DL>

</P>
<P>
<STRONG>Portability Note:</STRONG> In non-POSIX systems, <CODE>ftell</CODE>,
<CODE>ftello</CODE>, <CODE>fseek</CODE> and <CODE>fseeko</CODE> might work reliably only
on binary streams.  See section <A HREF="libc_196.html#SEC203">Text and Binary Streams</A>.

</P>
<P>
The following symbolic constants are defined for use as the <VAR>whence</VAR>
argument to <CODE>fseek</CODE>.  They are also used with the <CODE>lseek</CODE>
function (see section <A HREF="libc_216.html#SEC223">Input and Output Primitives</A>) and to specify offsets for file locks
(see section <A HREF="libc_233.html#SEC240">Control Operations on Files</A>).

</P>
<P>
<DL>
<DT><U>Macro:</U> int <B>SEEK_SET</B>
<DD><A NAME="IDX904"></A>
This is an integer constant which, when used as the <VAR>whence</VAR>
argument to the <CODE>fseek</CODE> or <CODE>fseeko</CODE> function, specifies that
the offset provided is relative to the beginning of the file.
</DL>

</P>
<P>
<DL>
<DT><U>Macro:</U> int <B>SEEK_CUR</B>
<DD><A NAME="IDX905"></A>
This is an integer constant which, when used as the <VAR>whence</VAR>
argument to the <CODE>fseek</CODE> or <CODE>fseeko</CODE> function, specifies that
the offset provided is relative to the current file position.
</DL>

</P>
<P>
<DL>
<DT><U>Macro:</U> int <B>SEEK_END</B>
<DD><A NAME="IDX906"></A>
This is an integer constant which, when used as the <VAR>whence</VAR>
argument to the <CODE>fseek</CODE> or <CODE>fseeko</CODE> function, specifies that
the offset provided is relative to the end of the file.
</DL>

</P>
<P>
<DL>
<DT><U>Function:</U> void <B>rewind</B> <I>(FILE *<VAR>stream</VAR>)</I>
<DD><A NAME="IDX907"></A>
The <CODE>rewind</CODE> function positions the stream <VAR>stream</VAR> at the
beginning of the file.  It is equivalent to calling <CODE>fseek</CODE> or
<CODE>fseeko</CODE> on the <VAR>stream</VAR> with an <VAR>offset</VAR> argument of
<CODE>0L</CODE> and a <VAR>whence</VAR> argument of <CODE>SEEK_SET</CODE>, except that
the return value is discarded and the error indicator for the stream is
reset.
</DL>

</P>
<P>
These three aliases for the <SAMP>`SEEK_...'</SAMP> constants exist for the
sake of compatibility with older BSD systems.  They are defined in two
different header files: <TT>`fcntl.h'</TT> and <TT>`sys/file.h'</TT>.

</P>
<DL COMPACT>

<DT><CODE>L_SET</CODE>
<DD>
<A NAME="IDX908"></A>
An alias for <CODE>SEEK_SET</CODE>.

<DT><CODE>L_INCR</CODE>
<DD>
<A NAME="IDX909"></A>
An alias for <CODE>SEEK_CUR</CODE>.

<DT><CODE>L_XTND</CODE>
<DD>
<A NAME="IDX910"></A>
An alias for <CODE>SEEK_END</CODE>.
</DL>

<P><HR><P>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_196.html">previous</A>, <A HREF="libc_198.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
</BODY>
</HTML>

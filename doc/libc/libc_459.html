<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.51
     from libc.texinfo on 28 March 2001 -->

<TITLE>The GNU C Library - Testing for Delivery</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_458.html">previous</A>, <A HREF="libc_460.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
<P><HR><P>


<H3><A NAME="SEC466" HREF="libc_toc.html#TOC466">Blocking to Test for Delivery of a Signal</A></H3>

<P>
Now for a simple example.  Suppose you establish a handler for
<CODE>SIGALRM</CODE> signals that sets a flag whenever a signal arrives, and
your main program checks this flag from time to time and then resets it.
You can prevent additional <CODE>SIGALRM</CODE> signals from arriving in the
meantime by wrapping the critical part of the code with calls to
<CODE>sigprocmask</CODE>, like this:

</P>

<PRE>
/* This variable is set by the SIGALRM signal handler. */
volatile sig_atomic_t flag = 0;

int
main (void)
{
  sigset_t block_alarm;

  ...

  /* Initialize the signal mask. */
  sigemptyset (&#38;block_alarm);
  sigaddset (&#38;block_alarm, SIGALRM);

  while (1)
    {
      /* Check if a signal has arrived; if so, reset the flag. */
      sigprocmask (SIG_BLOCK, &#38;block_alarm, NULL);
      if (flag)
        {
          <VAR>actions-if-not-arrived</VAR>
          flag = 0;
        }
      sigprocmask (SIG_UNBLOCK, &#38;block_alarm, NULL);

      ...
    }
}
</PRE>

<P><HR><P>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_458.html">previous</A>, <A HREF="libc_460.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
</BODY>
</HTML>

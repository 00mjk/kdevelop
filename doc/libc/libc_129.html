<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.51
     from libc.texinfo on 28 March 2001 -->

<TITLE>The GNU C Library - Calling Glob</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_128.html">previous</A>, <A HREF="libc_130.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
<P><HR><P>


<H3><A NAME="SEC136" HREF="libc_toc.html#TOC136">Calling <CODE>glob</CODE></A></H3>

<P>
The result of globbing is a vector of file names (strings).  To return
this vector, <CODE>glob</CODE> uses a special data type, <CODE>glob_t</CODE>, which
is a structure.  You pass <CODE>glob</CODE> the address of the structure, and
it fills in the structure's fields to tell you about the results.

</P>
<P>
<DL>
<DT><U>Data Type:</U> <B>glob_t</B>
<DD><A NAME="IDX725"></A>
This data type holds a pointer to a word vector.  More precisely, it
records both the address of the word vector and its size.  The GNU
implementation contains some more fields which are non-standard
extensions.

</P>
<DL COMPACT>

<DT><CODE>gl_pathc</CODE>
<DD>
The number of elements in the vector.

<DT><CODE>gl_pathv</CODE>
<DD>
The address of the vector.  This field has type <CODE>char **</CODE>.

<DT><CODE>gl_offs</CODE>
<DD>
The offset of the first real element of the vector, from its nominal
address in the <CODE>gl_pathv</CODE> field.  Unlike the other fields, this
is always an input to <CODE>glob</CODE>, rather than an output from it.

If you use a nonzero offset, then that many elements at the beginning of
the vector are left empty.  (The <CODE>glob</CODE> function fills them with
null pointers.)

The <CODE>gl_offs</CODE> field is meaningful only if you use the
<CODE>GLOB_DOOFFS</CODE> flag.  Otherwise, the offset is always zero
regardless of what is in this field, and the first real element comes at
the beginning of the vector.

<DT><CODE>gl_closedir</CODE>
<DD>
The address of an alternative implementation of the <CODE>closedir</CODE>
function.  It is used if the <CODE>GLOB_ALTDIRFUNC</CODE> bit is set in
the flag parameter.  The type of this field is
<CODE>void (*) (void *)</CODE>.

This is a GNU extension.

<DT><CODE>gl_readdir</CODE>
<DD>
The address of an alternative implementation of the <CODE>readdir</CODE>
function used to read the contents of a directory.  It is used if the
<CODE>GLOB_ALTDIRFUNC</CODE> bit is set in the flag parameter.  The type of
this field is <CODE>struct dirent *(*) (void *)</CODE>.

This is a GNU extension.

<DT><CODE>gl_opendir</CODE>
<DD>
The address of an alternative implementation of the <CODE>opendir</CODE>
function.  It is used if the <CODE>GLOB_ALTDIRFUNC</CODE> bit is set in
the flag parameter.  The type of this field is
<CODE>void *(*) (const char *)</CODE>.

This is a GNU extension.

<DT><CODE>gl_stat</CODE>
<DD>
The address of an alternative implementation of the <CODE>stat</CODE> function
to get information about an object in the filesystem.  It is used if the
<CODE>GLOB_ALTDIRFUNC</CODE> bit is set in the flag parameter.  The type of
this field is <CODE>int (*) (const char *, struct stat *)</CODE>.

This is a GNU extension.

<DT><CODE>gl_lstat</CODE>
<DD>
The address of an alternative implementation of the <CODE>lstat</CODE>
function to get information about an object in the filesystems, not
following symbolic links.  It is used if the <CODE>GLOB_ALTDIRFUNC</CODE> bit
is set in the flag parameter.  The type of this field is <CODE>int
(*) (const char *,</CODE> struct stat *).

This is a GNU extension.
</DL>
</DL>

<P>
<DL>
<DT><U>Function:</U> int <B>glob</B> <I>(const char *<VAR>pattern</VAR>, int <VAR>flags</VAR>, int (*<VAR>errfunc</VAR>) (const char *<VAR>filename</VAR>, int <VAR>error-code</VAR>), glob_t *<VAR>vector-ptr</VAR>)</I>
<DD><A NAME="IDX726"></A>
The function <CODE>glob</CODE> does globbing using the pattern <VAR>pattern</VAR>
in the current directory.  It puts the result in a newly allocated
vector, and stores the size and address of this vector into
<CODE>*<VAR>vector-ptr</VAR></CODE>.  The argument <VAR>flags</VAR> is a combination of
bit flags; see section <A HREF="libc_130.html#SEC137">Flags for Globbing</A>, for details of the flags.

</P>
<P>
The result of globbing is a sequence of file names.  The function
<CODE>glob</CODE> allocates a string for each resulting word, then
allocates a vector of type <CODE>char **</CODE> to store the addresses of
these strings.  The last element of the vector is a null pointer.
This vector is called the <STRONG>word vector</STRONG>.

</P>
<P>
To return this vector, <CODE>glob</CODE> stores both its address and its
length (number of elements, not counting the terminating null pointer)
into <CODE>*<VAR>vector-ptr</VAR></CODE>.

</P>
<P>
Normally, <CODE>glob</CODE> sorts the file names alphabetically before
returning them.  You can turn this off with the flag <CODE>GLOB_NOSORT</CODE>
if you want to get the information as fast as possible.  Usually it's
a good idea to let <CODE>glob</CODE> sort them--if you process the files in
alphabetical order, the users will have a feel for the rate of progress
that your application is making.

</P>
<P>
If <CODE>glob</CODE> succeeds, it returns 0.  Otherwise, it returns one
of these error codes:

</P>
<DL COMPACT>

<DT><CODE>GLOB_ABORTED</CODE>
<DD>
There was an error opening a directory, and you used the flag
<CODE>GLOB_ERR</CODE> or your specified <VAR>errfunc</VAR> returned a nonzero
value.
See below
for an explanation of the <CODE>GLOB_ERR</CODE> flag and <VAR>errfunc</VAR>.

<DT><CODE>GLOB_NOMATCH</CODE>
<DD>
The pattern didn't match any existing files.  If you use the
<CODE>GLOB_NOCHECK</CODE> flag, then you never get this error code, because
that flag tells <CODE>glob</CODE> to <EM>pretend</EM> that the pattern matched
at least one file.

<DT><CODE>GLOB_NOSPACE</CODE>
<DD>
It was impossible to allocate memory to hold the result.
</DL>

<P>
In the event of an error, <CODE>glob</CODE> stores information in
<CODE>*<VAR>vector-ptr</VAR></CODE> about all the matches it has found so far.
</DL>

</P>
<P><HR><P>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_128.html">previous</A>, <A HREF="libc_130.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
</BODY>
</HTML>

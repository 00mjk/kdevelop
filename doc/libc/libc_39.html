<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.51
     from libc.texinfo on 28 March 2001 -->

<TITLE>The GNU C Library - Interpreting the traces</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_38.html">previous</A>, <A HREF="libc_40.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
<P><HR><P>


<H3><A NAME="SEC39" HREF="libc_toc.html#TOC39">Interpreting the traces</A></H3>

<P>
If you take a look at the output it will look similar to this:

</P>

<PRE>
= Start
 [0x8048209] - 0x8064cc8
 [0x8048209] - 0x8064ce0
 [0x8048209] - 0x8064cf8
 [0x80481eb] + 0x8064c48 0x14
 [0x80481eb] + 0x8064c60 0x14
 [0x80481eb] + 0x8064c78 0x14
 [0x80481eb] + 0x8064c90 0x14
= End
</PRE>

<P>
What this all means is not really important since the trace file is not
meant to be read by a human.  Therefore no attention is payed to good
readability.  Instead there is a program which comes with the GNU C
library which interprets the traces and outputs a summary in on
user-friendly way.  The program is called <CODE>mtrace</CODE> (it is in fact a
Perl script) and it takes one or two arguments.  In any case the name of
the file with the trace output must be specified.  If an optional argument
precedes the name of the trace file this must be the name of the program
which generated the trace.

</P>

<PRE>
drepper$ mtrace tst-mtrace log
No memory leaks.
</PRE>

<P>
In this case the program <CODE>tst-mtrace</CODE> was run and it produced a
trace file <TT>`log'</TT>.  The message printed by <CODE>mtrace</CODE> shows there
are no problems with the code: all allocated memory was freed
afterwards.

</P>
<P>
If we call <CODE>mtrace</CODE> on the example trace given above we would get
different output:

</P>

<PRE>
drepper$ mtrace errlog
- 0x08064cc8 Free 2 was never alloc'd 0x8048209
- 0x08064ce0 Free 3 was never alloc'd 0x8048209
- 0x08064cf8 Free 4 was never alloc'd 0x8048209

Memory not freed:
-----------------
   Address     Size     Caller
0x08064c48     0x14  at 0x80481eb
0x08064c60     0x14  at 0x80481eb
0x08064c78     0x14  at 0x80481eb
0x08064c90     0x14  at 0x80481eb
</PRE>

<P>
We have called <CODE>mtrace</CODE> with only one argument and so the script
has no chance to find out what is meant with the addresses given in the
trace.  We can do better:

</P>

<PRE>
drepper$ mtrace tst-mtrace errlog
- 0x08064cc8 Free 2 was never alloc'd /home/drepper/tst-mtrace.c:39
- 0x08064ce0 Free 3 was never alloc'd /home/drepper/tst-mtrace.c:39
- 0x08064cf8 Free 4 was never alloc'd /home/drepper/tst-mtrace.c:39

Memory not freed:
-----------------
   Address     Size     Caller
0x08064c48     0x14  at /home/drepper/tst-mtrace.c:33
0x08064c60     0x14  at /home/drepper/tst-mtrace.c:33
0x08064c78     0x14  at /home/drepper/tst-mtrace.c:33
0x08064c90     0x14  at /home/drepper/tst-mtrace.c:33
</PRE>

<P>
Suddenly the output makes much more sense and the user can see
immediately where the function calls causing the trouble can be found.

</P>
<P>
Interpreting this output is not complicated.  There are at most two
different situations being detected.  First, <CODE>free</CODE> was called for
pointers which were never returned by one of the allocation functions.
This is usually a very bad problem and how this looks like is shown in
the first three lines of the output.  Situations like this are quite
rare and if they appear they show up very drastically: the program
normally crashes.

</P>
<P>
The other situation which is much harder to detect are memory leaks.  As
you can see in the output the <CODE>mtrace</CODE> function collects all this
information and so can say that the program calls an allocation function
from line 33 in the source file <TT>`/home/drepper/tst-mtrace.c'</TT> four
times without freeing this memory before the program terminates.
Whether this is a real problem keeps to be investigated.

</P>
<P><HR><P>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_38.html">previous</A>, <A HREF="libc_40.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
</BODY>
</HTML>

<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.51
     from libc.texinfo on 28 March 2001 -->

<TITLE>The GNU C Library - Status bit operations</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_372.html">previous</A>, <A HREF="libc_374.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
<P><HR><P>


<H3><A NAME="SEC380" HREF="libc_toc.html#TOC380">Examining the FPU status word</A></H3>

<P>
ISO C 9x defines functions to query and manipulate the
floating-point status word.  You can use these functions to check for
untrapped exceptions when it's convenient, rather than worrying about
them in the middle of a calculation.

</P>
<P>
These constants represent the various IEEE 754 exceptions.  Not all
FPUs report all the different exceptions.  Each constant is defined if
and only if the FPU you are compiling for supports that exception, so
you can test for FPU support with <SAMP>`#ifdef'</SAMP>.  They are defined in
<TT>`fenv.h'</TT>.

</P>
<DL COMPACT>

<DT><CODE>FE_INEXACT</CODE>
<DD>
<A NAME="IDX2069"></A>
 The inexact exception.
<DT><CODE>FE_DIVBYZERO</CODE>
<DD>
<A NAME="IDX2070"></A>
 The divide by zero exception.
<DT><CODE>FE_UNDERFLOW</CODE>
<DD>
<A NAME="IDX2071"></A>
 The underflow exception.
<DT><CODE>FE_OVERFLOW</CODE>
<DD>
<A NAME="IDX2072"></A>
 The overflow exception.
<DT><CODE>FE_INVALID</CODE>
<DD>
<A NAME="IDX2073"></A>
 The invalid exception.
</DL>

<P>
The macro <CODE>FE_ALL_EXCEPT</CODE> is the bitwise OR of all exception macros
which are supported by the FP implementation.

</P>
<P>
These functions allow you to clear exception flags, test for exceptions,
and save and restore the set of exceptions flagged.

</P>
<P>
<DL>
<DT><U>Function:</U> void <B>feclearexcept</B> <I>(int <VAR>excepts</VAR>)</I>
<DD><A NAME="IDX2074"></A>
This function clears all of the supported exception flags indicated by
<VAR>excepts</VAR>.
</DL>

</P>
<P>
<DL>
<DT><U>Function:</U> int <B>fetestexcept</B> <I>(int <VAR>excepts</VAR>)</I>
<DD><A NAME="IDX2075"></A>
Test whether the exception flags indicated by the parameter <VAR>except</VAR>
are currently set.  If any of them are, a nonzero value is returned
which specifies which exceptions are set.  Otherwise the result is zero.
</DL>

</P>
<P>
To understand these functions, imagine that the status word is an
integer variable named <VAR>status</VAR>.  <CODE>feclearexcept</CODE> is then
equivalent to <SAMP>`status &#38;= ~excepts'</SAMP> and <CODE>fetestexcept</CODE> is
equivalent to <SAMP>`(status &#38; excepts)'</SAMP>.  The actual implementation may
be very different, of course.

</P>
<P>
Exception flags are only cleared when the program explicitly requests it,
by calling <CODE>feclearexcept</CODE>.  If you want to check for exceptions
from a set of calculations, you should clear all the flags first.  Here
is a simple example of the way to use <CODE>fetestexcept</CODE>:

</P>

<PRE>
{
  double f;
  int raised;
  feclearexcept (FE_ALL_EXCEPT);
  f = compute ();
  raised = fetestexcept (FE_OVERFLOW | FE_INVALID);
  if (raised &#38; FE_OVERFLOW) { /* ... */ }
  if (raised &#38; FE_INVALID) { /* ... */ }
  /* ... */
}
</PRE>

<P>
You cannot explicitly set bits in the status word.  You can, however,
save the entire status word and restore it later.  This is done with the
following functions:

</P>
<P>
<DL>
<DT><U>Function:</U> void <B>fegetexceptflag</B> <I>(fexcept_t *<VAR>flagp</VAR>, int <VAR>excepts</VAR>)</I>
<DD><A NAME="IDX2076"></A>
This function stores in the variable pointed to by <VAR>flagp</VAR> an
implementation-defined value representing the current setting of the
exception flags indicated by <VAR>excepts</VAR>.
</DL>

</P>
<P>
<DL>
<DT><U>Function:</U> void <B>fesetexceptflag</B> <I>(const fexcept_t *<VAR>flagp</VAR>, int</I>
<DD><A NAME="IDX2077"></A>
<VAR>excepts</VAR>)
This function restores the flags for the exceptions indicated by
<VAR>excepts</VAR> to the values stored in the variable pointed to by
<VAR>flagp</VAR>.
</DL>

</P>
<P>
Note that the value stored in <CODE>fexcept_t</CODE> bears no resemblance to
the bit mask returned by <CODE>fetestexcept</CODE>.  The type may not even be
an integer.  Do not attempt to modify an <CODE>fexcept_t</CODE> variable.

</P>
<P><HR><P>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_372.html">previous</A>, <A HREF="libc_374.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
</BODY>
</HTML>

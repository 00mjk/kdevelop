<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.51
     from libc.texinfo on 28 March 2001 -->

<TITLE>The GNU C Library - Broken-down Time</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_398.html">previous</A>, <A HREF="libc_400.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
<P><HR><P>


<H3><A NAME="SEC406" HREF="libc_toc.html#TOC406">Broken-down Time</A></H3>
<P>
<A NAME="IDX2316"></A>
<A NAME="IDX2317"></A>

</P>
<P>
Calendar time is represented as a number of seconds.  This is convenient
for calculation, but has no resemblance to the way people normally
represent dates and times.  By contrast, <STRONG>broken-down time</STRONG> is a binary
representation separated into year, month, day, and so on.  Broken down
time values are not useful for calculations, but they are useful for
printing human readable time.

</P>
<P>
A broken-down time value is always relative to a choice of local time
zone, and it also indicates which time zone was used.

</P>
<P>
The symbols in this section are declared in the header file <TT>`time.h'</TT>.

</P>
<P>
<DL>
<DT><U>Data Type:</U> <B>struct tm</B>
<DD><A NAME="IDX2318"></A>
This is the data type used to represent a broken-down time.  The structure
contains at least the following members, which can appear in any order:

</P>
<DL COMPACT>

<DT><CODE>int tm_sec</CODE>
<DD>
This is the number of seconds after the minute, normally in the range
<CODE>0</CODE> through <CODE>59</CODE>.  (The actual upper limit is <CODE>60</CODE>, to allow
for leap seconds if leap second support is available.)
<A NAME="IDX2319"></A>

<DT><CODE>int tm_min</CODE>
<DD>
This is the number of minutes after the hour, in the range <CODE>0</CODE> through
<CODE>59</CODE>.

<DT><CODE>int tm_hour</CODE>
<DD>
This is the number of hours past midnight, in the range <CODE>0</CODE> through
<CODE>23</CODE>.

<DT><CODE>int tm_mday</CODE>
<DD>
This is the day of the month, in the range <CODE>1</CODE> through <CODE>31</CODE>.

<DT><CODE>int tm_mon</CODE>
<DD>
This is the number of months since January, in the range <CODE>0</CODE> through
<CODE>11</CODE>.

<DT><CODE>int tm_year</CODE>
<DD>
This is the number of years since <CODE>1900</CODE>.

<DT><CODE>int tm_wday</CODE>
<DD>
This is the number of days since Sunday, in the range <CODE>0</CODE> through
<CODE>6</CODE>.

<DT><CODE>int tm_yday</CODE>
<DD>
This is the number of days since January 1, in the range <CODE>0</CODE> through
<CODE>365</CODE>.

<DT><CODE>int tm_isdst</CODE>
<DD>
<A NAME="IDX2320"></A>
<A NAME="IDX2321"></A>
This is a flag that indicates whether Daylight Saving Time is (or was, or
will be) in effect at the time described.  The value is positive if
Daylight Saving Time is in effect, zero if it is not, and negative if the
information is not available.

<DT><CODE>long int tm_gmtoff</CODE>
<DD>
This field describes the time zone that was used to compute this
broken-down time value, including any adjustment for daylight saving; it
is the number of seconds that you must add to UTC to get local time.
You can also think of this as the number of seconds east of UTC.  For
example, for U.S. Eastern Standard Time, the value is <CODE>-5*60*60</CODE>.
The <CODE>tm_gmtoff</CODE> field is derived from BSD and is a GNU library
extension; it is not visible in a strict ISO C environment.

<DT><CODE>const char *tm_zone</CODE>
<DD>
This field is the name for the time zone that was used to compute this
broken-down time value.  Like <CODE>tm_gmtoff</CODE>, this field is a BSD and
GNU extension, and is not visible in a strict ISO C environment.
</DL>
</DL>

<P>
<DL>
<DT><U>Function:</U> struct tm * <B>localtime</B> <I>(const time_t *<VAR>time</VAR>)</I>
<DD><A NAME="IDX2322"></A>
The <CODE>localtime</CODE> function converts the calendar time pointed to by
<VAR>time</VAR> to broken-down time representation, expressed relative to the
user's specified time zone.

</P>
<P>
The return value is a pointer to a static broken-down time structure, which
might be overwritten by subsequent calls to <CODE>ctime</CODE>, <CODE>gmtime</CODE>,
or <CODE>localtime</CODE>.  (But no other library function overwrites the contents
of this object.)

</P>
<P>
The return value is the null pointer if <VAR>time</VAR> cannot be represented
as a broken-down time; typically this is because the year cannot fit into
an <CODE>int</CODE>.

</P>
<P>
Calling <CODE>localtime</CODE> has one other effect: it sets the variable
<CODE>tzname</CODE> with information about the current time zone.  See section <A HREF="libc_405.html#SEC412">Functions and Variables for Time Zones</A>.
</DL>

</P>
<P>
Using the <CODE>localtime</CODE> function is a big problem in multi-threaded
programs.  The result is returned in a static buffer and this is used in
all threads.  POSIX.1c introduced a variant of this function.

</P>
<P>
<DL>
<DT><U>Function:</U> struct tm * <B>localtime_r</B> <I>(const time_t *<VAR>time</VAR>, struct tm *<VAR>resultp</VAR>)</I>
<DD><A NAME="IDX2323"></A>
The <CODE>localtime_r</CODE> function works just like the <CODE>localtime</CODE>
function.  It takes a pointer to a variable containing the calendar time
and converts it to the broken-down time format.

</P>
<P>
But the result is not placed in a static buffer.  Instead it is placed
in the object of type <CODE>struct tm</CODE> to which the parameter
<VAR>resultp</VAR> points.

</P>
<P>
If the conversion is successful the function returns a pointer to the
object the result was written into, i.e., it returns <VAR>resultp</VAR>.
</DL>

</P>

<P>
<DL>
<DT><U>Function:</U> struct tm * <B>gmtime</B> <I>(const time_t *<VAR>time</VAR>)</I>
<DD><A NAME="IDX2324"></A>
This function is similar to <CODE>localtime</CODE>, except that the broken-down
time is expressed as Coordinated Universal Time (UTC)---that is, as
Greenwich Mean Time (GMT)---rather than relative to the local time zone.

</P>
<P>
Recall that calendar times are <EM>always</EM> expressed in coordinated
universal time.
</DL>

</P>
<P>
As for the <CODE>localtime</CODE> function we have the problem that the result
is placed in a static variable.  POSIX.1c also provides a replacement for
<CODE>gmtime</CODE>.

</P>
<P>
<DL>
<DT><U>Function:</U> struct tm * <B>gmtime_r</B> <I>(const time_t *<VAR>time</VAR>, struct tm *<VAR>resultp</VAR>)</I>
<DD><A NAME="IDX2325"></A>
This function is similar to <CODE>localtime_r</CODE>, except that it converts
just like <CODE>gmtime</CODE> the given time as Coordinated Universal Time.

</P>
<P>
If the conversion is successful the function returns a pointer to the
object the result was written into, i.e., it returns <VAR>resultp</VAR>.
</DL>

</P>

<P>
<DL>
<DT><U>Function:</U> time_t <B>mktime</B> <I>(struct tm *<VAR>brokentime</VAR>)</I>
<DD><A NAME="IDX2326"></A>
The <CODE>mktime</CODE> function is used to convert a broken-down time structure
to a calendar time representation.  It also "normalizes" the contents of
the broken-down time structure, by filling in the day of week and day of
year based on the other date and time components.

</P>
<P>
The <CODE>mktime</CODE> function ignores the specified contents of the
<CODE>tm_wday</CODE> and <CODE>tm_yday</CODE> members of the broken-down time
structure.  It uses the values of the other components to compute the
calendar time; it's permissible for these components to have
unnormalized values outside of their normal ranges.  The last thing that
<CODE>mktime</CODE> does is adjust the components of the <VAR>brokentime</VAR>
structure (including the <CODE>tm_wday</CODE> and <CODE>tm_yday</CODE>).

</P>
<P>
If the specified broken-down time cannot be represented as a calendar time,
<CODE>mktime</CODE> returns a value of <CODE>(time_t)(-1)</CODE> and does not modify
the contents of <VAR>brokentime</VAR>.

</P>
<P>
Calling <CODE>mktime</CODE> also sets the variable <CODE>tzname</CODE> with
information about the current time zone.  See section <A HREF="libc_405.html#SEC412">Functions and Variables for Time Zones</A>.
</DL>

</P>
<P><HR><P>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_398.html">previous</A>, <A HREF="libc_400.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
</BODY>
</HTML>

<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.51
     from libc.texinfo on 28 March 2001 -->

<TITLE>The GNU C Library - Argp Parser Functions</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_484.html">previous</A>, <A HREF="libc_486.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
<P><HR><P>


<H3><A NAME="SEC493" HREF="libc_toc.html#TOC493">Argp Parser Functions</A></H3>

<P>
The function pointed to by the <CODE>parser</CODE> field in a <CODE>struct
argp</CODE> (see section <A HREF="libc_482.html#SEC490">Specifying Argp Parsers</A>) defines what actions take place in response
to each option or argument that is parsed, and is also used as a hook,
to allow a parser to do something at certain other points during
parsing.

</P>
<P>
Argp parser functions have the following type signature:

</P>
<P>
<A NAME="IDX2657"></A>

<PRE>
error_t <VAR>parser</VAR> (int <VAR>key</VAR>, char *<VAR>arg</VAR>, struct argp_state *<VAR>state</VAR>)
</PRE>

<P>
where the arguments are as follows:

</P>
<DL COMPACT>

<DT><VAR>key</VAR>
<DD>
For each option that is parsed, <VAR>parser</VAR> is called with a value of
<VAR>key</VAR> from that option's <CODE>key</CODE> field in the option vector
(see section <A HREF="libc_483.html#SEC491">Specifying Options in an Argp Parser</A>).  <VAR>parser</VAR> is also called at other
times with special reserved keys, such as <CODE>ARGP_KEY_ARG</CODE> for
non-option arguments.  See section <A HREF="libc_486.html#SEC494">Special Keys for Argp Parser Functions</A>.

<DT><VAR>arg</VAR>
<DD>
If <VAR>key</VAR> is an option, <VAR>arg</VAR> is the value given for it, or zero
if no value was specified.  Only options that have a non-zero <CODE>arg</CODE>
field can ever have a value, and those must <EM>always</EM> have a value,
unless the <CODE>OPTION_ARG_OPTIONAL</CODE> flag was specified (if the input
being parsed specifies a value for an option that doesn't allow one, an
error results before <VAR>parser</VAR> ever gets called).

If <VAR>key</VAR> is <CODE>ARGP_KEY_ARG</CODE>, <VAR>arg</VAR> is a non-option argument;
other special keys always have a zero <VAR>arg</VAR>.

<DT><VAR>state</VAR>
<DD>
<VAR>state</VAR> points to a <CODE>struct argp_state</CODE>, containing useful
information about the current parsing state for use by <VAR>parser</VAR>.
See section <A HREF="libc_488.html#SEC496">Argp Parsing State</A>.
</DL>

<P>
When <VAR>parser</VAR> is called, it should perform whatever action is
appropriate for <VAR>key</VAR>, and return either <CODE>0</CODE> for success,
<CODE>ARGP_ERR_UNKNOWN</CODE>, if the value of <VAR>key</VAR> is not handled by
this parser function, or a unix error code if a real error occurred
(see section <A HREF="libc_17.html#SEC17">Error Codes</A>).

</P>
<P>
<DL>
<DT><U>Macro:</U> int <B>ARGP_ERR_UNKNOWN</B>
<DD><A NAME="IDX2658"></A>
Argp parser functions should return <CODE>ARGP_ERR_UNKNOWN</CODE> for any
<VAR>key</VAR> value they do not recognize, or for non-option arguments
(<CODE><VAR>key</VAR> == ARGP_KEY_ARG</CODE>) that they do not which to handle.
</DL>

</P>
<P>
A typical parser function uses a switch statement on <VAR>key</VAR>:

</P>

<PRE>
error_t
parse_opt (int key, char *arg, struct argp_state *state)
{
  switch (key)
    {
    case <VAR>option_key</VAR>:
      <VAR>action</VAR>
      break;
    ...
    default:
      return ARGP_ERR_UNKNOWN;
    }
  return 0;
}
</PRE>

<P><HR><P>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_484.html">previous</A>, <A HREF="libc_486.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
</BODY>
</HTML>

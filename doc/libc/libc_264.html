<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.51
     from libc.texinfo on 28 March 2001 -->

<TITLE>The GNU C Library - File Owner</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_263.html">previous</A>, <A HREF="libc_265.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
<P><HR><P>


<H3><A NAME="SEC271" HREF="libc_toc.html#TOC271">File Owner</A></H3>
<P>
<A NAME="IDX1290"></A>
<A NAME="IDX1291"></A>
<A NAME="IDX1292"></A>

</P>
<P>
Every file has an <STRONG>owner</STRONG> which is one of the registered user names
defined on the system.  Each file also has a <STRONG>group</STRONG>, which is one
of the defined groups.  The file owner can often be useful for showing
you who edited the file (especially when you edit with GNU Emacs), but
its main purpose is for access control.

</P>
<P>
The file owner and group play a role in determining access because the
file has one set of access permission bits for the user that is the
owner, another set that apply to users who belong to the file's group,
and a third set of bits that apply to everyone else.  See section <A HREF="libc_266.html#SEC273">How Your Access to a File is Decided</A>, for the details of how access is decided based on this
data.

</P>
<P>
When a file is created, its owner is set from the effective user ID of
the process that creates it (see section <A HREF="libc_554.html#SEC562">The Persona of a Process</A>).  The file's group
ID may be set from either effective group ID of the process, or the
group ID of the directory that contains the file, depending on the
system where the file is stored.  When you access a remote file system,
it behaves according to its own rule, not according to the system your
program is running on.  Thus, your program must be prepared to encounter
either kind of behavior, no matter what kind of system you run it on.

</P>
<P>
<A NAME="IDX1293"></A>
<A NAME="IDX1294"></A>
You can change the owner and/or group owner of an existing file using
the <CODE>chown</CODE> function.  This is the primitive for the <CODE>chown</CODE>
and <CODE>chgrp</CODE> shell commands.

</P>
<P>
<A NAME="IDX1295"></A>
The prototype for this function is declared in <TT>`unistd.h'</TT>.

</P>
<P>
<DL>
<DT><U>Function:</U> int <B>chown</B> <I>(const char *<VAR>filename</VAR>, uid_t <VAR>owner</VAR>, gid_t <VAR>group</VAR>)</I>
<DD><A NAME="IDX1296"></A>
The <CODE>chown</CODE> function changes the owner of the file <VAR>filename</VAR> to
<VAR>owner</VAR>, and its group owner to <VAR>group</VAR>.

</P>
<P>
Changing the owner of the file on certain systems clears the set-user-ID
and set-group-ID bits of the file's permissions.  (This is because those
bits may not be appropriate for the new owner.)  The other file
permission bits are not changed.

</P>
<P>
The return value is <CODE>0</CODE> on success and <CODE>-1</CODE> on failure.
In addition to the usual file name errors (see section <A HREF="libc_153.html#SEC160">File Name Errors</A>),
the following <CODE>errno</CODE> error conditions are defined for this function:

</P>
<DL COMPACT>

<DT><CODE>EPERM</CODE>
<DD>
This process lacks permission to make the requested change.

Only privileged users or the file's owner can change the file's group.
On most file systems, only privileged users can change the file owner;
some file systems allow you to change the owner if you are currently the
owner.  When you access a remote file system, the behavior you encounter
is determined by the system that actually holds the file, not by the
system your program is running on.

See section <A HREF="libc_596.html#SEC604">Optional Features in File Support</A>, for information about the
<CODE>_POSIX_CHOWN_RESTRICTED</CODE> macro.

<DT><CODE>EROFS</CODE>
<DD>
The file is on a read-only file system.
</DL>
</DL>

<P>
<DL>
<DT><U>Function:</U> int <B>fchown</B> <I>(int <VAR>filedes</VAR>, int <VAR>owner</VAR>, int <VAR>group</VAR>)</I>
<DD><A NAME="IDX1297"></A>
This is like <CODE>chown</CODE>, except that it changes the owner of the file
with open file descriptor <VAR>filedes</VAR>.

</P>
<P>
The return value from <CODE>fchown</CODE> is <CODE>0</CODE> on success and <CODE>-1</CODE>
on failure.  The following <CODE>errno</CODE> error codes are defined for this
function:

</P>
<DL COMPACT>

<DT><CODE>EBADF</CODE>
<DD>
The <VAR>filedes</VAR> argument is not a valid file descriptor.

<DT><CODE>EINVAL</CODE>
<DD>
The <VAR>filedes</VAR> argument corresponds to a pipe or socket, not an ordinary
file.

<DT><CODE>EPERM</CODE>
<DD>
This process lacks permission to make the requested change.  For
details, see <CODE>chmod</CODE>, above.

<DT><CODE>EROFS</CODE>
<DD>
The file resides on a read-only file system.
</DL>
</DL>

<P><HR><P>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_263.html">previous</A>, <A HREF="libc_265.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
</BODY>
</HTML>

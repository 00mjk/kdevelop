<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.51
     from libc.texinfo on 28 March 2001 -->

<TITLE>The GNU C Library - Connecting</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_307.html">previous</A>, <A HREF="libc_309.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
<P><HR><P>


<H3><A NAME="SEC315" HREF="libc_toc.html#TOC315">Making a Connection</A></H3>
<P>
<A NAME="IDX1545"></A>
<A NAME="IDX1546"></A>
<A NAME="IDX1547"></A>
<A NAME="IDX1548"></A>

</P>
<P>
In making a connection, the client makes a connection while the server
waits for and accepts the connection.  Here we discuss what the client
program must do, using the <CODE>connect</CODE> function, which is declared in
<TT>`sys/socket.h'</TT>.

</P>
<P>
<DL>
<DT><U>Function:</U> int <B>connect</B> <I>(int <VAR>socket</VAR>, struct sockaddr *<VAR>addr</VAR>, socklen_t <VAR>length</VAR>)</I>
<DD><A NAME="IDX1549"></A>
The <CODE>connect</CODE> function initiates a connection from the socket
with file descriptor <VAR>socket</VAR> to the socket whose address is
specified by the <VAR>addr</VAR> and <VAR>length</VAR> arguments.  (This socket
is typically on another machine, and it must be already set up as a
server.)  See section <A HREF="libc_281.html#SEC288">Socket Addresses</A>, for information about how these
arguments are interpreted.

</P>
<P>
Normally, <CODE>connect</CODE> waits until the server responds to the request
before it returns.  You can set nonblocking mode on the socket
<VAR>socket</VAR> to make <CODE>connect</CODE> return immediately without waiting
for the response.  See section <A HREF="libc_236.html#SEC243">File Status Flags</A>, for information about
nonblocking mode.

</P>
<P>
The normal return value from <CODE>connect</CODE> is <CODE>0</CODE>.  If an error
occurs, <CODE>connect</CODE> returns <CODE>-1</CODE>.  The following <CODE>errno</CODE>
error conditions are defined for this function:

</P>
<DL COMPACT>

<DT><CODE>EBADF</CODE>
<DD>
The socket <VAR>socket</VAR> is not a valid file descriptor.

<DT><CODE>ENOTSOCK</CODE>
<DD>
File descriptor <VAR>socket</VAR> is not a socket.

<DT><CODE>EADDRNOTAVAIL</CODE>
<DD>
The specified address is not available on the remote machine.

<DT><CODE>EAFNOSUPPORT</CODE>
<DD>
The namespace of the <VAR>addr</VAR> is not supported by this socket.

<DT><CODE>EISCONN</CODE>
<DD>
The socket <VAR>socket</VAR> is already connected.

<DT><CODE>ETIMEDOUT</CODE>
<DD>
The attempt to establish the connection timed out.

<DT><CODE>ECONNREFUSED</CODE>
<DD>
The server has actively refused to establish the connection.

<DT><CODE>ENETUNREACH</CODE>
<DD>
The network of the given <VAR>addr</VAR> isn't reachable from this host.

<DT><CODE>EADDRINUSE</CODE>
<DD>
The socket address of the given <VAR>addr</VAR> is already in use.

<DT><CODE>EINPROGRESS</CODE>
<DD>
The socket <VAR>socket</VAR> is non-blocking and the connection could not be
established immediately.  You can determine when the connection is
completely established with <CODE>select</CODE>; see section <A HREF="libc_225.html#SEC232">Waiting for Input or Output</A>.
Another <CODE>connect</CODE> call on the same socket, before the connection is
completely established, will fail with <CODE>EALREADY</CODE>.

<DT><CODE>EALREADY</CODE>
<DD>
The socket <VAR>socket</VAR> is non-blocking and already has a pending
connection in progress (see <CODE>EINPROGRESS</CODE> above).
</DL>

<P>
This function is defined as a cancelation point in multi-threaded
programs.  So one has to be prepared for this and make sure that
possibly allocated resources (like memory, files descriptors,
semaphores or whatever) are freed even if the thread is canceled.
</DL>

</P>
<P><HR><P>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_307.html">previous</A>, <A HREF="libc_309.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
</BODY>
</HTML>

<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.51
     from libc.texinfo on 28 March 2001 -->

<TITLE>The GNU C Library - Pause Problems</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_464.html">previous</A>, <A HREF="libc_466.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
<P><HR><P>


<H3><A NAME="SEC472" HREF="libc_toc.html#TOC472">Problems with <CODE>pause</CODE></A></H3>

<P>
The simplicity of <CODE>pause</CODE> can conceal serious timing errors that
can make a program hang mysteriously.

</P>
<P>
It is safe to use <CODE>pause</CODE> if the real work of your program is done
by the signal handlers themselves, and the "main program" does nothing
but call <CODE>pause</CODE>.  Each time a signal is delivered, the handler
will do the next batch of work that is to be done, and then return, so
that the main loop of the program can call <CODE>pause</CODE> again.

</P>
<P>
You can't safely use <CODE>pause</CODE> to wait until one more signal arrives,
and then resume real work.  Even if you arrange for the signal handler
to cooperate by setting a flag, you still can't use <CODE>pause</CODE>
reliably.  Here is an example of this problem:

</P>

<PRE>
/* <CODE>usr_interrupt</CODE> is set by the signal handler.  */
if (!usr_interrupt)
  pause ();

/* Do work once the signal arrives.  */
...
</PRE>

<P>
This has a bug: the signal could arrive after the variable
<CODE>usr_interrupt</CODE> is checked, but before the call to <CODE>pause</CODE>.
If no further signals arrive, the process would never wake up again.

</P>
<P>
You can put an upper limit on the excess waiting by using <CODE>sleep</CODE>
in a loop, instead of using <CODE>pause</CODE>.  (See section <A HREF="libc_409.html#SEC416">Sleeping</A>, for more
about <CODE>sleep</CODE>.)  Here is what this looks like:

</P>

<PRE>
/* <CODE>usr_interrupt</CODE> is set by the signal handler.
while (!usr_interrupt)
  sleep (1);

/* Do work once the signal arrives.  */
...
</PRE>

<P>
For some purposes, that is good enough.  But with a little more
complexity, you can wait reliably until a particular signal handler is
run, using <CODE>sigsuspend</CODE>.

</P>
<P><HR><P>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_464.html">previous</A>, <A HREF="libc_466.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
</BODY>
</HTML>

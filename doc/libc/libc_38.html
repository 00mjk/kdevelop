<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.51
     from libc.texinfo on 28 March 2001 -->

<TITLE>The GNU C Library - Tips for the Memory Debugger</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_37.html">previous</A>, <A HREF="libc_39.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
<P><HR><P>


<H3><A NAME="SEC38" HREF="libc_toc.html#TOC38">Some more or less clever ideas</A></H3>

<P>
You know the situation.  The program is prepared for debugging and in
all debugging sessions it runs well.  But once it is started without
debugging the error shows up.  In our situation here: the memory leaks
becomes visible only when we just turned off the debugging.  If you
foresee such situations you can still win.  Simply use something
equivalent to the following little program:

</P>

<PRE>
#include &#60;mcheck.h&#62;
#include &#60;signal.h&#62;

static void
enable (int sig)
{
  mtrace ();
  signal (SIGUSR1, enable);
}

static void
disable (int sig)
{
  muntrace ();
  signal (SIGUSR2, disable);
}

int
main (int argc, char *argv[])
{
  ...

  signal (SIGUSR1, enable);
  signal (SIGUSR2, disable);

  ...
}
</PRE>

<P>
I.e., the user can start the memory debugger any time s/he wants if the
program was started with <CODE>MALLOC_TRACE</CODE> set in the environment.
The output will of course not show the allocations which happened before
the first signal but if there is a memory leak this will show up
nevertheless.

</P>
<P><HR><P>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_37.html">previous</A>, <A HREF="libc_39.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
</BODY>
</HTML>

<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.51
     from libc.texinfo on 28 March 2001 -->

<TITLE>The GNU C Library - Renaming Files</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_257.html">previous</A>, <A HREF="libc_259.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
<P><HR><P>


<H2><A NAME="SEC265" HREF="libc_toc.html#TOC265">Renaming Files</A></H2>

<P>
The <CODE>rename</CODE> function is used to change a file's name.

</P>
<P>
<A NAME="IDX1246"></A>
<DL>
<DT><U>Function:</U> int <B>rename</B> <I>(const char *<VAR>oldname</VAR>, const char *<VAR>newname</VAR>)</I>
<DD><A NAME="IDX1247"></A>
The <CODE>rename</CODE> function renames the file name <VAR>oldname</VAR> with
<VAR>newname</VAR>.  The file formerly accessible under the name
<VAR>oldname</VAR> is afterward accessible as <VAR>newname</VAR> instead.  (If the
file had any other names aside from <VAR>oldname</VAR>, it continues to have
those names.)

</P>
<P>
The directory containing the name <VAR>newname</VAR> must be on the same
file system as the file (as indicated by the name <VAR>oldname</VAR>).

</P>
<P>
One special case for <CODE>rename</CODE> is when <VAR>oldname</VAR> and
<VAR>newname</VAR> are two names for the same file.  The consistent way to
handle this case is to delete <VAR>oldname</VAR>.  However, POSIX requires
that in this case <CODE>rename</CODE> do nothing and report success--which is
inconsistent.  We don't know what your operating system will do.

</P>
<P>
If the <VAR>oldname</VAR> is not a directory, then any existing file named
<VAR>newname</VAR> is removed during the renaming operation.  However, if
<VAR>newname</VAR> is the name of a directory, <CODE>rename</CODE> fails in this
case.

</P>
<P>
If the <VAR>oldname</VAR> is a directory, then either <VAR>newname</VAR> must not
exist or it must name a directory that is empty.  In the latter case,
the existing directory named <VAR>newname</VAR> is deleted first.  The name
<VAR>newname</VAR> must not specify a subdirectory of the directory
<CODE>oldname</CODE> which is being renamed.

</P>
<P>
One useful feature of <CODE>rename</CODE> is that the meaning of the name
<VAR>newname</VAR> changes "atomically" from any previously existing file
by that name to its new meaning (the file that was called
<VAR>oldname</VAR>).  There is no instant at which <VAR>newname</VAR> is
nonexistent "in between" the old meaning and the new meaning.  If
there is a system crash during the operation, it is possible for both
names to still exist; but <VAR>newname</VAR> will always be intact if it
exists at all.

</P>
<P>
If <CODE>rename</CODE> fails, it returns <CODE>-1</CODE>.  In addition to the usual
file name errors (see section <A HREF="libc_153.html#SEC160">File Name Errors</A>), the following
<CODE>errno</CODE> error conditions are defined for this function:

</P>
<DL COMPACT>

<DT><CODE>EACCES</CODE>
<DD>
One of the directories containing <VAR>newname</VAR> or <VAR>oldname</VAR>
refuses write permission; or <VAR>newname</VAR> and <VAR>oldname</VAR> are
directories and write permission is refused for one of them.

<DT><CODE>EBUSY</CODE>
<DD>
A directory named by <VAR>oldname</VAR> or <VAR>newname</VAR> is being used by
the system in a way that prevents the renaming from working.  This includes
directories that are mount points for filesystems, and directories
that are the current working directories of processes.

<DT><CODE>ENOTEMPTY</CODE>
<DD>
<DT><CODE>EEXIST</CODE>
<DD>
The directory <VAR>newname</VAR> isn't empty.  The GNU system always returns
<CODE>ENOTEMPTY</CODE> for this, but some other systems return <CODE>EEXIST</CODE>.

<DT><CODE>EINVAL</CODE>
<DD>
The <VAR>oldname</VAR> is a directory that contains <VAR>newname</VAR>.

<DT><CODE>EISDIR</CODE>
<DD>
The <VAR>newname</VAR> names a directory, but the <VAR>oldname</VAR> doesn't.

<DT><CODE>EMLINK</CODE>
<DD>
The parent directory of <VAR>newname</VAR> would have too many links.

<DT><CODE>ENOENT</CODE>
<DD>
The file named by <VAR>oldname</VAR> doesn't exist.

<DT><CODE>ENOSPC</CODE>
<DD>
The directory that would contain <VAR>newname</VAR> has no room for another
entry, and there is no space left in the file system to expand it.

<DT><CODE>EROFS</CODE>
<DD>
The operation would involve writing to a directory on a read-only file
system.

<DT><CODE>EXDEV</CODE>
<DD>
The two file names <VAR>newname</VAR> and <VAR>oldnames</VAR> are on different
file systems.
</DL>
</DL>

<P><HR><P>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_257.html">previous</A>, <A HREF="libc_259.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
</BODY>
</HTML>

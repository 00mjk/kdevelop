<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.51
     from libc.texinfo on 28 March 2001 -->

<TITLE>The GNU C Library - String Parameters</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_600.html">previous</A>, <A HREF="libc_602.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
<P><HR><P>


<H2><A NAME="SEC609" HREF="libc_toc.html#TOC609">String-Valued Parameters</A></H2>

<P>
POSIX.2 defines a way to get string-valued parameters from the operating
system with the function <CODE>confstr</CODE>:

</P>
<P>
<DL>
<DT><U>Function:</U> size_t <B>confstr</B> <I>(int <VAR>parameter</VAR>, char *<VAR>buf</VAR>, size_t <VAR>len</VAR>)</I>
<DD><A NAME="IDX3133"></A>
This function reads the value of a string-valued system parameter,
storing the string into <VAR>len</VAR> bytes of memory space starting at
<VAR>buf</VAR>.  The <VAR>parameter</VAR> argument should be one of the
<SAMP>`_CS_'</SAMP> symbols listed below.

</P>
<P>
The normal return value from <CODE>confstr</CODE> is the length of the string
value that you asked for.  If you supply a null pointer for <VAR>buf</VAR>,
then <CODE>confstr</CODE> does not try to store the string; it just returns
its length.  A value of <CODE>0</CODE> indicates an error.

</P>
<P>
If the string you asked for is too long for the buffer (that is, longer
than <CODE><VAR>len</VAR> - 1</CODE>), then <CODE>confstr</CODE> stores just that much
(leaving room for the terminating null character).  You can tell that
this has happened because <CODE>confstr</CODE> returns a value greater than or
equal to <VAR>len</VAR>.

</P>
<P>
The following <CODE>errno</CODE> error conditions are defined for this function:

</P>
<DL COMPACT>

<DT><CODE>EINVAL</CODE>
<DD>
The value of the <VAR>parameter</VAR> is invalid.
</DL>
</DL>

<P>
Currently there is just one parameter you can read with <CODE>confstr</CODE>:

</P>
<DL COMPACT>

<DT><CODE>_CS_PATH</CODE>
<DD>
This parameter's value is the recommended default path for searching for
executable files.  This is the path that a user has by default just
after logging in.

<DT><CODE>_CS_LFS_CFLAGS</CODE>
<DD>
The returned string specifies which additional flags must be given to
the C compiler if a source is compiled using the
<CODE>_LARGEFILE_SOURCE</CODE> feature select macro; see section <A HREF="libc_13.html#SEC13">Feature Test Macros</A>.

<DT><CODE>_CS_LFS_LDFLAGS</CODE>
<DD>
The returned string specifies which additional flags must be given to
the linker if a source is compiled using the
<CODE>_LARGEFILE_SOURCE</CODE> feature select macro; see section <A HREF="libc_13.html#SEC13">Feature Test Macros</A>.

<DT><CODE>_CS_LFS_LIBS</CODE>
<DD>
The returned string specifies which additional libraries must be linked
to the application if a source is compiled using the
<CODE>_LARGEFILE_SOURCE</CODE> feature select macro; see section <A HREF="libc_13.html#SEC13">Feature Test Macros</A>.

<DT><CODE>_CS_LFS_LINTFLAGS</CODE>
<DD>
The returned string specifies which additional flags must be given to
the lint tool if a source is compiled using the
<CODE>_LARGEFILE_SOURCE</CODE> feature select macro; see section <A HREF="libc_13.html#SEC13">Feature Test Macros</A>.

<DT><CODE>_CS_LFS64_CFLAGS</CODE>
<DD>
The returned string specifies which additional flags must be given to
the C compiler if a source is compiled using the
<CODE>_LARGEFILE64_SOURCE</CODE> feature select macro; see section <A HREF="libc_13.html#SEC13">Feature Test Macros</A>.

<DT><CODE>_CS_LFS64_LDFLAGS</CODE>
<DD>
The returned string specifies which additional flags must be given to
the linker if a source is compiled using the
<CODE>_LARGEFILE64_SOURCE</CODE> feature select macro; see section <A HREF="libc_13.html#SEC13">Feature Test Macros</A>.

<DT><CODE>_CS_LFS64_LIBS</CODE>
<DD>
The returned string specifies which additional libraries must be linked
to the application if a source is compiled using the
<CODE>_LARGEFILE64_SOURCE</CODE> feature select macro; see section <A HREF="libc_13.html#SEC13">Feature Test Macros</A>.

<DT><CODE>_CS_LFS64_LINTFLAGS</CODE>
<DD>
The returned string specifies which additional flags must be given to
the lint tool if a source is compiled using the
<CODE>_LARGEFILE64_SOURCE</CODE> feature select macro; see section <A HREF="libc_13.html#SEC13">Feature Test Macros</A>.
</DL>

<P>
The way to use <CODE>confstr</CODE> without any arbitrary limit on string size
is to call it twice: first call it to get the length, allocate the
buffer accordingly, and then call <CODE>confstr</CODE> again to fill the
buffer, like this:

</P>

<PRE>
char *
get_default_path (void)
{
  size_t len = confstr (_CS_PATH, NULL, 0);
  char *buffer = (char *) xmalloc (len);

  if (confstr (_CS_PATH, buf, len + 1) == 0)
    {
      free (buffer);
      return NULL;
    }

  return buffer;
}
</PRE>

<P><HR><P>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_600.html">previous</A>, <A HREF="libc_602.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
</BODY>
</HTML>

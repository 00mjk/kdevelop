<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.51
     from libc.texinfo on 28 March 2001 -->

<TITLE>The GNU C Library - Using the Memory Debugger</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_36.html">previous</A>, <A HREF="libc_38.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
<P><HR><P>


<H3><A NAME="SEC37" HREF="libc_toc.html#TOC37">Example programs excerpts</A></H3>

<P>
Even though the tracing functionality does not influence the runtime
behaviour of the program it is no wise idea to call <CODE>mtrace</CODE> in all
programs.  Just imagine you debug a program using <CODE>mtrace</CODE> and all
other programs used in the debug sessions also trace their <CODE>malloc</CODE>
calls.  The output file would be the same for all programs and so is
unusable.  Therefore one should call <CODE>mtrace</CODE> only if compiled for
debugging.  A program could therefore start like this:

</P>

<PRE>
#include &#60;mcheck.h&#62;

int
main (int argc, char *argv[])
{
#ifdef DEBUGGING
  mtrace ();
#endif
  ...
}
</PRE>

<P>
This is all what is needed if you want to trace the calls during the
whole runtime of the program.  Alternatively you can stop the tracing at
any time with a call to <CODE>muntrace</CODE>.  It is even possible to restart
the tracing again with a new call to <CODE>mtrace</CODE>.  But this can course
unreliable results since there are possibly calls of the functions which
are not called.  Please note that not only the application uses the
traced functions, also libraries (including the C library itself) use
this function.

</P>
<P>
This last point is also why it is no good idea to call <CODE>muntrace</CODE>
before the program terminated.  The libraries are informed about the
termination of the program only after the program returns from
<CODE>main</CODE> or calls <CODE>exit</CODE> and so cannot free the memory they use
before this time.

</P>
<P>
So the best thing one can do is to call <CODE>mtrace</CODE> as the very first
function in the program and never call <CODE>muntrace</CODE>.  So the program
traces almost all uses of the <CODE>malloc</CODE> functions (except those
calls which are executed by constructors of the program or used
libraries).

</P>
<P><HR><P>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_36.html">previous</A>, <A HREF="libc_38.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
</BODY>
</HTML>

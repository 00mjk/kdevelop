<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.51
     from libc.texinfo on 28 March 2001 -->

<TITLE>The GNU C Library - Descriptors and Streams</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_217.html">previous</A>, <A HREF="libc_219.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
<P><HR><P>


<H2><A NAME="SEC225" HREF="libc_toc.html#TOC225">Descriptors and Streams</A></H2>
<P>
<A NAME="IDX1011"></A>
<A NAME="IDX1012"></A>
<A NAME="IDX1013"></A>

</P>
<P>
Given an open file descriptor, you can create a stream for it with the
<CODE>fdopen</CODE> function.  You can get the underlying file descriptor for
an existing stream with the <CODE>fileno</CODE> function.  These functions are
declared in the header file <TT>`stdio.h'</TT>.
<A NAME="IDX1014"></A>

</P>
<P>
<DL>
<DT><U>Function:</U> FILE * <B>fdopen</B> <I>(int <VAR>filedes</VAR>, const char *<VAR>opentype</VAR>)</I>
<DD><A NAME="IDX1015"></A>
The <CODE>fdopen</CODE> function returns a new stream for the file descriptor
<VAR>filedes</VAR>.

</P>
<P>
The <VAR>opentype</VAR> argument is interpreted in the same way as for the
<CODE>fopen</CODE> function (see section <A HREF="libc_158.html#SEC165">Opening Streams</A>), except that
the <SAMP>`b'</SAMP> option is not permitted; this is because GNU makes no
distinction between text and binary files.  Also, <CODE>"w"</CODE> and
<CODE>"w+"</CODE> do not cause truncation of the file; these have affect only
when opening a file, and in this case the file has already been opened.
You must make sure that the <VAR>opentype</VAR> argument matches the actual
mode of the open file descriptor.

</P>
<P>
The return value is the new stream.  If the stream cannot be created
(for example, if the modes for the file indicated by the file descriptor
do not permit the access specified by the <VAR>opentype</VAR> argument), a
null pointer is returned instead.

</P>
<P>
In some other systems, <CODE>fdopen</CODE> may fail to detect that the modes
for file descriptor do not permit the access specified by
<CODE>opentype</CODE>.  The GNU C library always checks for this.
</DL>

</P>
<P>
For an example showing the use of the <CODE>fdopen</CODE> function,
see section <A HREF="libc_274.html#SEC281">Creating a Pipe</A>.

</P>
<P>
<DL>
<DT><U>Function:</U> int <B>fileno</B> <I>(FILE *<VAR>stream</VAR>)</I>
<DD><A NAME="IDX1016"></A>
This function returns the file descriptor associated with the stream
<VAR>stream</VAR>.  If an error is detected (for example, if the <VAR>stream</VAR>
is not valid) or if <VAR>stream</VAR> does not do I/O to a file,
<CODE>fileno</CODE> returns @math{-1}.
</DL>

</P>
<P>
<A NAME="IDX1017"></A>
<A NAME="IDX1018"></A>
There are also symbolic constants defined in <TT>`unistd.h'</TT> for the
file descriptors belonging to the standard streams <CODE>stdin</CODE>,
<CODE>stdout</CODE>, and <CODE>stderr</CODE>; see section <A HREF="libc_157.html#SEC164">Standard Streams</A>.
<A NAME="IDX1019"></A>

</P>
<DL COMPACT>

<DT><CODE>STDIN_FILENO</CODE>
<DD>
<A NAME="IDX1020"></A>
This macro has value <CODE>0</CODE>, which is the file descriptor for
standard input.
<A NAME="IDX1021"></A>

<DT><CODE>STDOUT_FILENO</CODE>
<DD>
<A NAME="IDX1022"></A>
This macro has value <CODE>1</CODE>, which is the file descriptor for
standard output.
<A NAME="IDX1023"></A>

<DT><CODE>STDERR_FILENO</CODE>
<DD>
<A NAME="IDX1024"></A>
This macro has value <CODE>2</CODE>, which is the file descriptor for
standard error output.
</DL>
<P>
<A NAME="IDX1025"></A>

</P>
<P><HR><P>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_217.html">previous</A>, <A HREF="libc_219.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
</BODY>
</HTML>

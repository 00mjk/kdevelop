<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.51
     from libc.texinfo on 28 March 2001 -->

<TITLE>The GNU C Library - File Times</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_268.html">previous</A>, <A HREF="libc_270.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
<P><HR><P>


<H3><A NAME="SEC276" HREF="libc_toc.html#TOC276">File Times</A></H3>

<P>
<A NAME="IDX1341"></A>
<A NAME="IDX1342"></A>
<A NAME="IDX1343"></A>
Each file has three time stamps associated with it:  its access time,
its modification time, and its attribute modification time.  These
correspond to the <CODE>st_atime</CODE>, <CODE>st_mtime</CODE>, and <CODE>st_ctime</CODE>
members of the <CODE>stat</CODE> structure; see section <A HREF="libc_260.html#SEC267">File Attributes</A>.

</P>
<P>
All of these times are represented in calendar time format, as
<CODE>time_t</CODE> objects.  This data type is defined in <TT>`time.h'</TT>.
For more information about representation and manipulation of time
values, see section <A HREF="libc_396.html#SEC403">Calendar Time</A>.
<A NAME="IDX1344"></A>

</P>
<P>
Reading from a file updates its access time attribute, and writing
updates its modification time.  When a file is created, all three
time stamps for that file are set to the current time.  In addition, the
attribute change time and modification time fields of the directory that
contains the new entry are updated.

</P>
<P>
Adding a new name for a file with the <CODE>link</CODE> function updates the
attribute change time field of the file being linked, and both the
attribute change time and modification time fields of the directory
containing the new name.  These same fields are affected if a file name
is deleted with <CODE>unlink</CODE>, <CODE>remove</CODE>, or <CODE>rmdir</CODE>.  Renaming
a file with <CODE>rename</CODE> affects only the attribute change time and
modification time fields of the two parent directories involved, and not
the times for the file being renamed.

</P>
<P>
Changing attributes of a file (for example, with <CODE>chmod</CODE>) updates
its attribute change time field.

</P>
<P>
You can also change some of the time stamps of a file explicitly using
the <CODE>utime</CODE> function--all except the attribute change time.  You
need to include the header file <TT>`utime.h'</TT> to use this facility.
<A NAME="IDX1345"></A>

</P>
<P>
<DL>
<DT><U>Data Type:</U> <B>struct utimbuf</B>
<DD><A NAME="IDX1346"></A>
The <CODE>utimbuf</CODE> structure is used with the <CODE>utime</CODE> function to
specify new access and modification times for a file.  It contains the
following members:

</P>
<DL COMPACT>

<DT><CODE>time_t actime</CODE>
<DD>
This is the access time for the file.

<DT><CODE>time_t modtime</CODE>
<DD>
This is the modification time for the file.
</DL>
</DL>

<P>
<DL>
<DT><U>Function:</U> int <B>utime</B> <I>(const char *<VAR>filename</VAR>, const struct utimbuf *<VAR>times</VAR>)</I>
<DD><A NAME="IDX1347"></A>
This function is used to modify the file times associated with the file
named <VAR>filename</VAR>.

</P>
<P>
If <VAR>times</VAR> is a null pointer, then the access and modification times
of the file are set to the current time.  Otherwise, they are set to the
values from the <CODE>actime</CODE> and <CODE>modtime</CODE> members (respectively)
of the <CODE>utimbuf</CODE> structure pointed at by <VAR>times</VAR>.

</P>
<P>
The attribute modification time for the file is set to the current time
in either case (since changing the time stamps is itself a modification
of the file attributes).

</P>
<P>
The <CODE>utime</CODE> function returns <CODE>0</CODE> if successful and <CODE>-1</CODE>
on failure.  In addition to the usual file name errors
(see section <A HREF="libc_153.html#SEC160">File Name Errors</A>), the following <CODE>errno</CODE> error conditions
are defined for this function:

</P>
<DL COMPACT>

<DT><CODE>EACCES</CODE>
<DD>
There is a permission problem in the case where a null pointer was
passed as the <VAR>times</VAR> argument.  In order to update the time stamp on
the file, you must either be the owner of the file, have write
permission on the file, or be a privileged user.

<DT><CODE>ENOENT</CODE>
<DD>
The file doesn't exist.

<DT><CODE>EPERM</CODE>
<DD>
If the <VAR>times</VAR> argument is not a null pointer, you must either be
the owner of the file or be a privileged user.  This error is used to
report the problem.

<DT><CODE>EROFS</CODE>
<DD>
The file lives on a read-only file system.
</DL>
</DL>

<P>
Each of the three time stamps has a corresponding microsecond part,
which extends its resolution.  These fields are called
<CODE>st_atime_usec</CODE>, <CODE>st_mtime_usec</CODE>, and <CODE>st_ctime_usec</CODE>;
each has a value between 0 and 999,999, which indicates the time in
microseconds.  They correspond to the <CODE>tv_usec</CODE> field of a
<CODE>timeval</CODE> structure; see section <A HREF="libc_398.html#SEC405">High-Resolution Calendar</A>.

</P>
<P>
The <CODE>utimes</CODE> function is like <CODE>utime</CODE>, but also lets you specify
the fractional part of the file times.  The prototype for this function is
in the header file <TT>`sys/time.h'</TT>.
<A NAME="IDX1348"></A>

</P>
<P>
<DL>
<DT><U>Function:</U> int <B>utimes</B> <I>(const char *<VAR>filename</VAR>, struct timeval <VAR>tvp</VAR><TT>[2]</TT>)</I>
<DD><A NAME="IDX1349"></A>
This function sets the file access and modification times for the file
named by <VAR>filename</VAR>.  The new file access time is specified by
<CODE><VAR>tvp</VAR>[0]</CODE>, and the new modification time by
<CODE><VAR>tvp</VAR>[1]</CODE>.  This function comes from BSD.

</P>
<P>
The return values and error conditions are the same as for the <CODE>utime</CODE>
function.
</DL>

</P>
<P><HR><P>
Go to the <A HREF="libc_1.html">first</A>, <A HREF="libc_268.html">previous</A>, <A HREF="libc_270.html">next</A>, <A HREF="libc_654.html">last</A> section, <A HREF="libc_toc.html">table of contents</A>.
</BODY>
</HTML>
